[0m09:33:03.002268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8097fd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809ab33cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809ab33eb0>]}


============================== 09:33:03.010201 | 81f98e4d-f95e-49d6-bcf6-db296034a41f ==============================
[0m09:33:03.010201 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:33:03.011667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:33:03.012585 [info ] [MainThread]: dbt version: 1.6.1
[0m09:33:03.015182 [info ] [MainThread]: python version: 3.9.12
[0m09:33:03.015774 [info ] [MainThread]: python path: /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/bin/python3
[0m09:33:03.016339 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m09:33:03.361429 [info ] [MainThread]: Using profiles dir at /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/profile
[0m09:33:03.362082 [info ] [MainThread]: Using profiles.yml file at /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/profile/profiles.yml
[0m09:33:03.362559 [info ] [MainThread]: Using dbt_project.yml file at /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/dbt_project.yml
[0m09:33:03.363588 [info ] [MainThread]: adapter type: glue
[0m09:33:03.364108 [info ] [MainThread]: adapter version: 1.6.2
[0m09:33:03.407302 [info ] [MainThread]: Configuration:
[0m09:33:03.407926 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:33:03.408347 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:33:03.408744 [info ] [MainThread]: Required dependencies:
[0m09:33:03.411284 [debug] [MainThread]: Executing "git --help"
[0m09:33:03.435399 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:33:03.436568 [debug] [MainThread]: STDERR: "b''"
[0m09:33:03.437103 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:33:03.437589 [info ] [MainThread]: Connection:
[0m09:33:03.438649 [info ] [MainThread]:   role_arn: arn:aws:iam::253491126433:role/GlueInteractiveSessionRole
[0m09:33:03.440365 [info ] [MainThread]:   region: us-east-1
[0m09:33:03.442493 [info ] [MainThread]:   workers: 5
[0m09:33:03.442937 [info ] [MainThread]:   worker_type: G.1X
[0m09:33:03.443325 [info ] [MainThread]:   session_provisioning_timeout_in_seconds: 120
[0m09:33:03.443704 [info ] [MainThread]:   schema: dbt_nyc_metrics
[0m09:33:03.444080 [info ] [MainThread]:   location: s3://aws-dbt-glue-datalake-253491126433-us-east-1/
[0m09:33:03.444470 [info ] [MainThread]:   extra_jars: None
[0m09:33:03.444851 [info ] [MainThread]:   idle_timeout: 10
[0m09:33:03.445225 [info ] [MainThread]:   query_timeout_in_minutes: 300
[0m09:33:03.445628 [info ] [MainThread]:   glue_version: 4.0
[0m09:33:03.446227 [info ] [MainThread]:   security_configuration: None
[0m09:33:03.447049 [info ] [MainThread]:   connections: None
[0m09:33:03.448167 [info ] [MainThread]:   conf: None
[0m09:33:03.449211 [info ] [MainThread]:   extra_py_files: None
[0m09:33:03.449909 [info ] [MainThread]:   delta_athena_prefix: None
[0m09:33:03.450362 [info ] [MainThread]:   tags: None
[0m09:33:03.450768 [info ] [MainThread]:   seed_format: parquet
[0m09:33:03.451158 [info ] [MainThread]:   seed_mode: overwrite
[0m09:33:03.451760 [info ] [MainThread]:   default_arguments: None
[0m09:33:03.453206 [info ] [MainThread]:   iceberg_glue_commit_lock_table: myGlueLockTable
[0m09:33:03.453627 [info ] [MainThread]:   glue_session_id: None
[0m09:33:03.454326 [info ] [MainThread]:   glue_session_reuse: False
[0m09:33:03.454948 [info ] [MainThread]:   datalake_formats: None
[0m09:33:03.455726 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m09:33:03.467317 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m09:33:03.468926 [debug] [MainThread]: Using glue connection "debug"
[0m09:33:03.469618 [debug] [MainThread]: On debug: select 1 as id
[0m09:33:03.470197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:03.470937 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (13296, 140704473129792)
[0m09:33:03.471439 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m09:33:03.471829 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m09:33:03.472206 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m09:33:04.555278 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:05.706381 [debug] [MainThread]: Glue adapter: [elapsed 1.1458868980407715s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:06.838675 [debug] [MainThread]: Glue adapter: [elapsed 2.281191825866699s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:07.964804 [debug] [MainThread]: Glue adapter: [elapsed 3.413071870803833s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:09.094752 [debug] [MainThread]: Glue adapter: [elapsed 4.541377782821655s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:10.373196 [debug] [MainThread]: Glue adapter: [elapsed 5.816109895706177s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:11.506578 [debug] [MainThread]: Glue adapter: [elapsed 6.953542947769165s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:12.641081 [debug] [MainThread]: Glue adapter: [elapsed 8.08431887626648s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:13.765790 [debug] [MainThread]: Glue adapter: [elapsed 9.215904712677002s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:14.923902 [debug] [MainThread]: Glue adapter: [elapsed 10.344894886016846s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:16.058166 [debug] [MainThread]: Glue adapter: [elapsed 11.504738807678223s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:17.195039 [debug] [MainThread]: Glue adapter: [elapsed 12.64000391960144s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:18.331329 [debug] [MainThread]: Glue adapter: [elapsed 13.77207088470459s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:19.466351 [debug] [MainThread]: Glue adapter: [elapsed 14.912140846252441s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:20.601609 [debug] [MainThread]: Glue adapter: [elapsed 16.04698872566223s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:21.736735 [debug] [MainThread]: Glue adapter: [elapsed 17.182409048080444s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:22.868914 [debug] [MainThread]: Glue adapter: [elapsed 18.31491470336914s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:24.000015 [debug] [MainThread]: Glue adapter: [elapsed 19.448007822036743s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:25.134130 [debug] [MainThread]: Glue adapter: [elapsed 20.576149702072144s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:26.255264 [debug] [MainThread]: Glue adapter: [elapsed 21.706856966018677s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:27.367462 [debug] [MainThread]: Glue adapter: [elapsed 22.827359914779663s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:28.512004 [debug] [MainThread]: Glue adapter: [elapsed 23.955801725387573s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:29.643536 [debug] [MainThread]: Glue adapter: [elapsed 25.088425874710083s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:30.776974 [debug] [MainThread]: Glue adapter: [elapsed 26.224992036819458s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:31.907563 [debug] [MainThread]: Glue adapter: [elapsed 27.34811782836914s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:33.040776 [debug] [MainThread]: Glue adapter: [elapsed 28.487780809402466s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:34.185659 [debug] [MainThread]: Glue adapter: [elapsed 29.621933698654175s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:35.333248 [debug] [MainThread]: Glue adapter: [elapsed 30.781104803085327s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:36.461881 [debug] [MainThread]: Glue adapter: [elapsed 31.908931732177734s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in PROVISIONING state
[0m09:33:37.598982 [debug] [MainThread]: Glue adapter: [elapsed 33.040621757507324s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in READY state
[0m09:33:37.661060 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m09:33:37.661913 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896
[0m09:33:47.323301 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m09:33:47.324368 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m09:33:47.325302 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m09:33:47.326180 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m09:34:02.856925 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693316027492, 'CompletedOn': 1693316042197}, 'ResponseMetadata': {'RequestId': 'bfc22923-3f1c-4cc5-98d4-adbf0f94273d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 13:34:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '400', 'connection': 'keep-alive', 'x-amzn-requestid': 'bfc22923-3f1c-4cc5-98d4-adbf0f94273d'}, 'RetryAttempts': 0}}
[0m09:34:02.863546 [debug] [MainThread]: Glue adapter: status = ok
[0m09:34:02.864657 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m09:34:02.865397 [debug] [MainThread]: SQL status: OK in 59.0 seconds
[0m09:34:02.867660 [debug] [MainThread]: On debug: Close
[0m09:34:02.868252 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m09:34:02.868852 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:34:02.869476 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:34:02.871090 [debug] [MainThread]: Command `dbt debug` succeeded at 09:34:02.870389 after 59.91 seconds
[0m09:34:02.872145 [debug] [MainThread]: Glue adapter: cleanup called
[0m09:34:02.872793 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m09:34:02.999600 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in READY state
[0m09:34:04.292943 [debug] [MainThread]: Glue adapter: [elapsed 1.2958431243896484s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:05.491288 [debug] [MainThread]: Glue adapter: [elapsed 2.486802339553833s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:06.695399 [debug] [MainThread]: Glue adapter: [elapsed 3.6866250038146973s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:07.932687 [debug] [MainThread]: Glue adapter: [elapsed 4.892287254333496s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:09.111076 [debug] [MainThread]: Glue adapter: [elapsed 6.122330188751221s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:10.290122 [debug] [MainThread]: Glue adapter: [elapsed 7.3053131103515625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:11.480120 [debug] [MainThread]: Glue adapter: [elapsed 8.479599237442017s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:12.657244 [debug] [MainThread]: Glue adapter: [elapsed 9.670807123184204s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:13.848561 [debug] [MainThread]: Glue adapter: [elapsed 10.843750238418579s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:15.059340 [debug] [MainThread]: Glue adapter: [elapsed 12.048238039016724s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:16.236335 [debug] [MainThread]: Glue adapter: [elapsed 13.24094009399414s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:17.436588 [debug] [MainThread]: Glue adapter: [elapsed 14.435306310653687s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:18.615495 [debug] [MainThread]: Glue adapter: [elapsed 15.627630233764648s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:19.784826 [debug] [MainThread]: Glue adapter: [elapsed 16.80186915397644s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:20.979293 [debug] [MainThread]: Glue adapter: [elapsed 17.977753162384033s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:22.178181 [debug] [MainThread]: Glue adapter: [elapsed 19.17706322669983s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:23.362360 [debug] [MainThread]: Glue adapter: [elapsed 20.369604110717773s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:24.547583 [debug] [MainThread]: Glue adapter: [elapsed 21.562759160995483s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:25.738871 [debug] [MainThread]: Glue adapter: [elapsed 22.737935066223145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:26.931491 [debug] [MainThread]: Glue adapter: [elapsed 23.932913303375244s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:28.118389 [debug] [MainThread]: Glue adapter: [elapsed 25.127663135528564s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:29.338654 [debug] [MainThread]: Glue adapter: [elapsed 26.310994148254395s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:30.517864 [debug] [MainThread]: Glue adapter: [elapsed 27.533250093460083s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:31.691049 [debug] [MainThread]: Glue adapter: [elapsed 28.699079275131226s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:32.886255 [debug] [MainThread]: Glue adapter: [elapsed 29.886239290237427s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:34.078439 [debug] [MainThread]: Glue adapter: [elapsed 31.079443216323853s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:35.238593 [debug] [MainThread]: Glue adapter: [elapsed 32.252066135406494s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:36.412794 [debug] [MainThread]: Glue adapter: [elapsed 33.414180278778076s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-6b8eaca9-01fe-4580-be9a-fa004e106896 in STOPPING state
[0m09:34:37.547734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8097fd07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809b1db8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809b1ff640>]}
[0m09:34:37.549013 [debug] [MainThread]: Flushing usage events
[0m09:43:46.640371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69e7903a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a13749a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a1374b80>]}


============================== 09:43:46.647784 | 6f7ac7e1-d7fa-4d43-8350-08da4d43529a ==============================
[0m09:43:46.647784 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:43:46.649056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select silver_nyctaxi_avg_metrics', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:43:46.654131 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtgluenyctaxidemo'
[0m09:43:46.657004 [debug] [MainThread]: Command `dbt run` failed at 09:43:46.656796 after 0.04 seconds
[0m09:43:46.657540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69e7903a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a1399490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a1399070>]}
[0m09:43:46.658094 [debug] [MainThread]: Flushing usage events
[0m09:44:20.504032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c26a1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c5372a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c5372be0>]}


============================== 09:44:20.508519 | 258b0fa7-f6ba-44d8-9124-82fc39c2f529 ==============================
[0m09:44:20.508519 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:44:20.509202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select silver_metrics', 'send_anonymous_usage_stats': 'True'}
[0m09:44:20.512790 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtgluenyctaxidemo'
[0m09:44:20.515138 [debug] [MainThread]: Command `dbt run` failed at 09:44:20.514953 after 0.03 seconds
[0m09:44:20.515628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c26a1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c5399520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85c5399460>]}
[0m09:44:20.516121 [debug] [MainThread]: Flushing usage events
[0m09:57:57.942122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79587d0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7956cb1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795b372e20>]}


============================== 09:57:57.950285 | c7f6449c-10d6-4c24-892c-0fe460b7f65b ==============================
[0m09:57:57.950285 [info ] [MainThread]: Running with dbt=1.6.1
[0m09:57:57.951507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/logs', 'fail_fast': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:58.374042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7956cb1ac0>]}
[0m09:57:58.396730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bb680d0>]}
[0m09:57:58.398457 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m09:57:58.427251 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m09:57:58.428472 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:57:58.429766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bb80610>]}
[0m09:58:00.042860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bd1e0d0>]}
[0m09:58:00.066199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bbe2f40>]}
[0m09:58:00.067081 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m09:58:00.067617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bd8c4c0>]}
[0m09:58:00.069431 [info ] [MainThread]: 
[0m09:58:00.070510 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m09:58:00.072196 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m09:58:00.072887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:00.073452 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (13812, 123145420075008)
[0m09:58:00.075042 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m09:58:00.075776 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m09:58:00.076335 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m09:58:01.065553 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m09:58:01.066412 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m09:58:01.068208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m09:58:01.069296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:02.144425 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m09:58:02.145171 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m09:58:02.147995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m09:58:02.148729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:02.380603 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m09:58:02.381572 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m09:58:02.382943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795d5de250>]}
[0m09:58:02.383763 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m09:58:02.384345 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m09:58:02.385403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:02.386129 [info ] [MainThread]: 
[0m09:58:02.396272 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m09:58:02.397385 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m09:58:02.398922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m09:58:02.399890 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m09:58:02.416594 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m09:58:02.417897 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 09:58:02.401155 => 09:58:02.417587
[0m09:58:02.418637 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m09:58:02.440263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:58:02.616980 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m09:58:02.827244 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m09:58:02.829446 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m09:58:02.830198 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m09:58:02.973720 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:04.109759 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1376330852508545s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:05.256051 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.278982162475586s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:06.413523 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.428863286972046s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:07.554334 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.583471059799194s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:08.708903 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.735505104064941s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:09.870780 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.897601127624512s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:11.016974 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.050580978393555s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:12.155984 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.190872192382812s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:13.287386 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.321750164031982s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:14.436525 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.45079231262207s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:15.566747 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.59379506111145s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:16.693039 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.724735260009766s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:17.821558 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.855597019195557s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:18.959759 [debug] [Thread-1  ]: Glue adapter: [elapsed 15.984666109085083s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:20.093656 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.127426147460938s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:21.267795 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.255722284317017s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:22.400814 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.43620014190674s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:23.533797 [debug] [Thread-1  ]: Glue adapter: [elapsed 20.566829204559326s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:24.671735 [debug] [Thread-1  ]: Glue adapter: [elapsed 21.701257944107056s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:25.802451 [debug] [Thread-1  ]: Glue adapter: [elapsed 22.83471918106079s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:26.934163 [debug] [Thread-1  ]: Glue adapter: [elapsed 23.965328216552734s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:28.072542 [debug] [Thread-1  ]: Glue adapter: [elapsed 25.102349996566772s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:29.210545 [debug] [Thread-1  ]: Glue adapter: [elapsed 26.237069129943848s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:30.343929 [debug] [Thread-1  ]: Glue adapter: [elapsed 27.37835121154785s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:31.480601 [debug] [Thread-1  ]: Glue adapter: [elapsed 28.509024143218994s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:32.615917 [debug] [Thread-1  ]: Glue adapter: [elapsed 29.64546513557434s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:33.751843 [debug] [Thread-1  ]: Glue adapter: [elapsed 30.785320281982422s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:34.877909 [debug] [Thread-1  ]: Glue adapter: [elapsed 31.9119873046875s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:36.003070 [debug] [Thread-1  ]: Glue adapter: [elapsed 33.03675627708435s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:37.162839 [debug] [Thread-1  ]: Glue adapter: [elapsed 34.194905042648315s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:38.301152 [debug] [Thread-1  ]: Glue adapter: [elapsed 35.33213520050049s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:39.437095 [debug] [Thread-1  ]: Glue adapter: [elapsed 36.466482162475586s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:40.572309 [debug] [Thread-1  ]: Glue adapter: [elapsed 37.603923320770264s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:41.706223 [debug] [Thread-1  ]: Glue adapter: [elapsed 38.73872518539429s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:42.847348 [debug] [Thread-1  ]: Glue adapter: [elapsed 39.869243144989014s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:43.979467 [debug] [Thread-1  ]: Glue adapter: [elapsed 41.01062607765198s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:45.112624 [debug] [Thread-1  ]: Glue adapter: [elapsed 42.141332149505615s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:46.260820 [debug] [Thread-1  ]: Glue adapter: [elapsed 43.277799129486084s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:47.399758 [debug] [Thread-1  ]: Glue adapter: [elapsed 44.42863726615906s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:48.531139 [debug] [Thread-1  ]: Glue adapter: [elapsed 45.56165909767151s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:49.657332 [debug] [Thread-1  ]: Glue adapter: [elapsed 46.70551609992981s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in PROVISIONING state
[0m09:58:50.770608 [debug] [Thread-1  ]: Glue adapter: [elapsed 47.80568718910217s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in READY state
[0m09:58:50.846715 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m09:58:50.847365 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8
[0m09:59:00.756305 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m09:59:00.757225 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m09:59:00.757949 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m09:59:00.758725 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m09:59:32.256750 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693317540991, 'CompletedOn': 1693317572182}, 'ResponseMetadata': {'RequestId': '1c598d02-8f80-4f51-a6db-de87abd613ac', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 13:59:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '1c598d02-8f80-4f51-a6db-de87abd613ac'}, 'RetryAttempts': 0}}
[0m09:59:32.262749 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m09:59:32.263293 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m09:59:32.263853 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693317540991, 'CompletedOn': 1693317572182}, 'ResponseMetadata': {'RequestId': '1c598d02-8f80-4f51-a6db-de87abd613ac', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 13:59:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '1c598d02-8f80-4f51-a6db-de87abd613ac'}, 'RetryAttempts': 0}}
[0m09:59:32.264364 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m09:59:32.264838 [debug] [Thread-1  ]: SQL status: OK in 89.0 seconds
[0m09:59:32.332541 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m09:59:32.333759 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m09:59:32.334248 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m09:59:32.334732 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m09:59:32.404170 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m09:59:32.404797 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8
[0m09:59:34.011139 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m09:59:34.012157 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m09:59:34.012982 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m09:59:34.013882 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  ''')
[0m09:59:35.528238 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year\n    , month \n    , type\n    FROM nyctaxi.records \n    WHERE year = "2016"\n    AND dropoff_datetime is not null \n    GROUP BY 5, 6, 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Table or view not found: nyctaxi.records; line 20 pos 9;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]\n         +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))\n            +- 'UnresolvedRelation [nyctaxi, records], [], false\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Table or view not found: nyctaxi.records; line 20 pos 9;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]\n         +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))\n            +- 'UnresolvedRelation [nyctaxi, records], [], false\n\n"]}, 'Progress': 1.0, 'StartedOn': 1693317574241, 'CompletedOn': 1693317574891}, 'ResponseMetadata': {'RequestId': 'bae19ac6-c49a-4f72-a5dd-cacad82333e7', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 13:59:35 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3054', 'connection': 'keep-alive', 'x-amzn-requestid': 'bae19ac6-c49a-4f72-a5dd-cacad82333e7'}, 'RetryAttempts': 0}}
[0m09:59:35.529480 [debug] [Thread-1  ]: Glue adapter: status = error
[0m09:59:35.530437 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Table or view not found: nyctaxi.records; line 20 pos 9;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]
         +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))
            +- 'UnresolvedRelation [nyctaxi, records], [], false

[0m09:59:35.531693 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Table or view not found: nyctaxi.records; line 20 pos 9;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]
         +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))
            +- 'UnresolvedRelation [nyctaxi, records], [], false

[0m09:59:35.532657 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m09:59:35.533491 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m09:59:35.534309 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m09:59:35.535022 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m09:59:35.535701 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m09:59:35.536593 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 09:58:02.419851 => 09:59:35.536235
[0m09:59:35.552927 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      , year
      , month 
      , type
      FROM nyctaxi.records 
      WHERE year = "2016"
      AND dropoff_datetime is not null 
      GROUP BY 5, 6, 7
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: Table or view not found: nyctaxi.records; line 20 pos 9;
  'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias source_avg
        +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]
           +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))
              +- 'UnresolvedRelation [nyctaxi, records], [], false
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m09:59:35.553969 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7f6449c-10d6-4c24-892c-0fe460b7f65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bbe2940>]}
[0m09:59:35.556943 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 93.16s]
[0m09:59:35.559139 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m09:59:35.560714 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m09:59:35.561444 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m09:59:35.562121 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m09:59:35.562737 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m09:59:35.563569 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m09:59:35.565217 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m09:59:35.566939 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m09:59:35.568236 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m09:59:35.569638 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m09:59:35.571836 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:35.572411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:35.572884 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (13812, 140704473129792)
[0m09:59:35.573302 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m09:59:35.573714 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m09:59:35.574130 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m09:59:36.150049 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m09:59:36.150827 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m09:59:36.151394 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m09:59:36.151949 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:36.152505 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m09:59:36.153031 [debug] [MainThread]: On master: Close
[0m09:59:36.153580 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m09:59:36.154641 [debug] [MainThread]: Glue adapter: cleanup called
[0m09:59:36.155205 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m09:59:36.309753 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in READY state
[0m09:59:37.686277 [debug] [MainThread]: Glue adapter: [elapsed 1.4012329578399658s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:38.914245 [debug] [MainThread]: Glue adapter: [elapsed 2.6431241035461426s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:40.090597 [debug] [MainThread]: Glue adapter: [elapsed 3.82250714302063s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:41.292801 [debug] [MainThread]: Glue adapter: [elapsed 4.983703851699829s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:42.471856 [debug] [MainThread]: Glue adapter: [elapsed 6.201519966125488s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:43.695417 [debug] [MainThread]: Glue adapter: [elapsed 7.380784034729004s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:44.950417 [debug] [MainThread]: Glue adapter: [elapsed 8.66520881652832s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:46.168546 [debug] [MainThread]: Glue adapter: [elapsed 9.869502067565918s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:47.354709 [debug] [MainThread]: Glue adapter: [elapsed 11.064920902252197s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:48.571547 [debug] [MainThread]: Glue adapter: [elapsed 12.266857147216797s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:49.739840 [debug] [MainThread]: Glue adapter: [elapsed 13.48661994934082s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:50.941184 [debug] [MainThread]: Glue adapter: [elapsed 14.654789924621582s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:52.146489 [debug] [MainThread]: Glue adapter: [elapsed 15.853734970092773s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:53.338647 [debug] [MainThread]: Glue adapter: [elapsed 17.062566995620728s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:54.519852 [debug] [MainThread]: Glue adapter: [elapsed 18.247754096984863s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-57c8b1cb-a15d-4df2-9f79-7956a9c46bc8 in STOPPING state
[0m09:59:55.623098 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m09:59:55.778632 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m09:59:55.860898 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m09:59:57.007142 [debug] [MainThread]: Glue adapter: [elapsed 1.2392489910125732s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m09:59:57.078377 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m09:59:58.214226 [debug] [MainThread]: Glue adapter: [elapsed 2.456387996673584s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m09:59:58.294422 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m09:59:59.459141 [debug] [MainThread]: Glue adapter: [elapsed 3.6718149185180664s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m09:59:59.533160 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:00.670515 [debug] [MainThread]: Glue adapter: [elapsed 4.910871982574463s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:00.734907 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:01.879322 [debug] [MainThread]: Glue adapter: [elapsed 6.112825155258179s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:01.956184 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:03.062607 [debug] [MainThread]: Glue adapter: [elapsed 7.33548378944397s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:03.142460 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:04.286897 [debug] [MainThread]: Glue adapter: [elapsed 8.52000093460083s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:04.357768 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:05.495213 [debug] [MainThread]: Glue adapter: [elapsed 9.735917091369629s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:05.579369 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:06.714341 [debug] [MainThread]: Glue adapter: [elapsed 10.957797765731812s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:06.801372 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:07.934671 [debug] [MainThread]: Glue adapter: [elapsed 12.182010889053345s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:08.002608 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:09.149995 [debug] [MainThread]: Glue adapter: [elapsed 13.38493800163269s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:09.217895 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:10.541801 [debug] [MainThread]: Glue adapter: [elapsed 14.595361948013306s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:10.624270 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:11.738495 [debug] [MainThread]: Glue adapter: [elapsed 16.002436876296997s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:11.816629 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:12.952723 [debug] [MainThread]: Glue adapter: [elapsed 17.19713592529297s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:13.023779 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:14.168952 [debug] [MainThread]: Glue adapter: [elapsed 18.403513193130493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:14.244210 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:15.391284 [debug] [MainThread]: Glue adapter: [elapsed 19.624501943588257s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:15.466232 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:16.618605 [debug] [MainThread]: Glue adapter: [elapsed 20.845650911331177s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:16.686469 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:17.835854 [debug] [MainThread]: Glue adapter: [elapsed 22.0676748752594s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:17.911919 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:19.095127 [debug] [MainThread]: Glue adapter: [elapsed 23.294768810272217s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:19.167989 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:20.362502 [debug] [MainThread]: Glue adapter: [elapsed 24.54767394065857s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:20.440285 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:21.592619 [debug] [MainThread]: Glue adapter: [elapsed 25.822621822357178s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:21.675558 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:22.832759 [debug] [MainThread]: Glue adapter: [elapsed 27.05429983139038s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:22.906531 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:24.050244 [debug] [MainThread]: Glue adapter: [elapsed 28.286396980285645s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:24.124407 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:25.265996 [debug] [MainThread]: Glue adapter: [elapsed 29.501298904418945s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in PROVISIONING state
[0m10:00:25.337562 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:00:26.479398 [debug] [MainThread]: Glue adapter: [elapsed 30.715446949005127s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in READY state
[0m10:00:27.890175 [debug] [MainThread]: Glue adapter: [elapsed 32.11066389083862s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:29.111654 [debug] [MainThread]: Glue adapter: [elapsed 33.34417510032654s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:30.381885 [debug] [MainThread]: Glue adapter: [elapsed 34.615909814834595s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:31.627018 [debug] [MainThread]: Glue adapter: [elapsed 35.83225083351135s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:32.837479 [debug] [MainThread]: Glue adapter: [elapsed 37.07269883155823s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:34.040644 [debug] [MainThread]: Glue adapter: [elapsed 38.28683805465698s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:35.253831 [debug] [MainThread]: Glue adapter: [elapsed 39.49197793006897s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:36.468136 [debug] [MainThread]: Glue adapter: [elapsed 40.706923961639404s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:37.679357 [debug] [MainThread]: Glue adapter: [elapsed 41.9121630191803s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:38.882583 [debug] [MainThread]: Glue adapter: [elapsed 43.128538846969604s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:40.250419 [debug] [MainThread]: Glue adapter: [elapsed 44.326650857925415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:41.471334 [debug] [MainThread]: Glue adapter: [elapsed 45.696356773376465s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:42.698468 [debug] [MainThread]: Glue adapter: [elapsed 46.91991186141968s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:43.905613 [debug] [MainThread]: Glue adapter: [elapsed 48.1428108215332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:45.093191 [debug] [MainThread]: Glue adapter: [elapsed 49.349716901779175s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:46.287848 [debug] [MainThread]: Glue adapter: [elapsed 50.53748083114624s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:47.512495 [debug] [MainThread]: Glue adapter: [elapsed 51.74260497093201s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:48.723753 [debug] [MainThread]: Glue adapter: [elapsed 52.964415073394775s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:49.919316 [debug] [MainThread]: Glue adapter: [elapsed 54.1672260761261s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:51.125267 [debug] [MainThread]: Glue adapter: [elapsed 55.36471700668335s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:52.350895 [debug] [MainThread]: Glue adapter: [elapsed 56.58704400062561s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:53.574818 [debug] [MainThread]: Glue adapter: [elapsed 57.80847477912903s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:54.806303 [debug] [MainThread]: Glue adapter: [elapsed 59.03300404548645s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:56.021045 [debug] [MainThread]: Glue adapter: [elapsed 60.25852584838867s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:57.263533 [debug] [MainThread]: Glue adapter: [elapsed 61.475175857543945s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:58.478851 [debug] [MainThread]: Glue adapter: [elapsed 62.714070081710815s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:00:59.690055 [debug] [MainThread]: Glue adapter: [elapsed 63.928297996520996s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:00.883319 [debug] [MainThread]: Glue adapter: [elapsed 65.13836693763733s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:02.116582 [debug] [MainThread]: Glue adapter: [elapsed 66.33510708808899s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:03.296889 [debug] [MainThread]: Glue adapter: [elapsed 67.54702377319336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:04.501025 [debug] [MainThread]: Glue adapter: [elapsed 68.7489640712738s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:05.709308 [debug] [MainThread]: Glue adapter: [elapsed 69.95221781730652s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:06.928203 [debug] [MainThread]: Glue adapter: [elapsed 71.16953492164612s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:08.228607 [debug] [MainThread]: Glue adapter: [elapsed 72.4627320766449s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:09.451942 [debug] [MainThread]: Glue adapter: [elapsed 73.685781955719s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:10.640990 [debug] [MainThread]: Glue adapter: [elapsed 74.88524794578552s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:11.852347 [debug] [MainThread]: Glue adapter: [elapsed 76.08272314071655s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:13.047534 [debug] [MainThread]: Glue adapter: [elapsed 77.29591202735901s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:14.453566 [debug] [MainThread]: Glue adapter: [elapsed 78.48002696037292s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:15.650098 [debug] [MainThread]: Glue adapter: [elapsed 79.89888405799866s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:16.844079 [debug] [MainThread]: Glue adapter: [elapsed 81.10114002227783s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:18.054466 [debug] [MainThread]: Glue adapter: [elapsed 82.29858899116516s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:19.238674 [debug] [MainThread]: Glue adapter: [elapsed 83.50075602531433s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:20.408781 [debug] [MainThread]: Glue adapter: [elapsed 84.68464803695679s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:21.597908 [debug] [MainThread]: Glue adapter: [elapsed 85.85012412071228s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:22.799064 [debug] [MainThread]: Glue adapter: [elapsed 87.04207682609558s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:23.960287 [debug] [MainThread]: Glue adapter: [elapsed 88.2394711971283s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:25.137337 [debug] [MainThread]: Glue adapter: [elapsed 89.39035177230835s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-34e754c2-3888-4ea5-a62d-51fdf2ac9c79 in STOPPING state
[0m10:01:26.275567 [info ] [MainThread]: 
[0m10:01:26.276225 [info ] [MainThread]: Finished running 4 table models in 0 hours 3 minutes and 26.21 seconds (206.21s).
[0m10:01:26.277235 [debug] [MainThread]: Command end result
[0m10:01:26.293341 [info ] [MainThread]: 
[0m10:01:26.293985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:01:26.294844 [info ] [MainThread]: 
[0m10:01:26.295872 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m10:01:26.296546 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m10:01:26.297211 [error] [MainThread]:   
[0m10:01:26.297801 [error] [MainThread]:     
[0m10:01:26.298359 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m10:01:26.299104 [error] [MainThread]:     using PARQUET
[0m10:01:26.300972 [error] [MainThread]:   	
[0m10:01:26.304218 [error] [MainThread]:   	
[0m10:01:26.306312 [error] [MainThread]:   	
[0m10:01:26.307180 [error] [MainThread]:   	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m10:01:26.307682 [error] [MainThread]:   	
[0m10:01:26.308092 [error] [MainThread]:   	as
[0m10:01:26.308488 [error] [MainThread]:   	WITH source_avg as ( 
[0m10:01:26.308883 [error] [MainThread]:       SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
[0m10:01:26.309276 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m10:01:26.309665 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m10:01:26.310058 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m10:01:26.310446 [error] [MainThread]:       , year
[0m10:01:26.310837 [error] [MainThread]:       , month 
[0m10:01:26.311224 [error] [MainThread]:       , type
[0m10:01:26.311612 [error] [MainThread]:       FROM nyctaxi.records 
[0m10:01:26.311999 [error] [MainThread]:       WHERE year = "2016"
[0m10:01:26.312389 [error] [MainThread]:       AND dropoff_datetime is not null 
[0m10:01:26.313668 [error] [MainThread]:       GROUP BY 5, 6, 7
[0m10:01:26.314444 [error] [MainThread]:   ) 
[0m10:01:26.316410 [error] [MainThread]:   SELECT *
[0m10:01:26.317305 [error] [MainThread]:   FROM source_avg
[0m10:01:26.318035 [error] [MainThread]:     '''), AnalysisException: Table or view not found: nyctaxi.records; line 20 pos 9;
[0m10:01:26.318861 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
[0m10:01:26.319576 [error] [MainThread]:   +- 'Project [*]
[0m10:01:26.320439 [error] [MainThread]:      +- 'SubqueryAlias source_avg
[0m10:01:26.320932 [error] [MainThread]:         +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('dropoff_datetime as bigint) - cast('pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'type]
[0m10:01:26.321417 [error] [MainThread]:            +- 'Filter (('year = 2016) AND isnotnull('dropoff_datetime))
[0m10:01:26.321848 [error] [MainThread]:               +- 'UnresolvedRelation [nyctaxi, records], [], false
[0m10:01:26.322361 [error] [MainThread]:   
[0m10:01:26.322871 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m10:01:26.324928 [info ] [MainThread]: 
[0m10:01:26.328582 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m10:01:26.329882 [debug] [MainThread]: Command `dbt run` failed at 10:01:26.329622 after 208.42 seconds
[0m10:01:26.330817 [debug] [MainThread]: Glue adapter: cleanup called
[0m10:01:26.332107 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:01:26.458737 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:01:26.528833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79587d0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bd1e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795bd1e4f0>]}
[0m10:01:26.529828 [debug] [MainThread]: Flushing usage events
[0m10:16:39.558617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb142acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fadd290d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb2b74d30>]}


============================== 10:16:39.577807 | e2e12861-1ee9-47f1-b08f-d606ddebae85 ==============================
[0m10:16:39.577807 [info ] [MainThread]: Running with dbt=1.6.1
[0m10:16:39.579240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbtgluenyctaxidemo/logs', 'debug': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:16:39.926499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fadd290d0>]}
[0m10:16:39.948608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3260fa0>]}
[0m10:16:39.951923 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m10:16:39.979649 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m10:16:40.089628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:40.090151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:40.097351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb32c70d0>]}
[0m10:16:40.113798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3346c70>]}
[0m10:16:40.114640 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m10:16:40.115303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3346a90>]}
[0m10:16:40.117835 [info ] [MainThread]: 
[0m10:16:40.119045 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m10:16:40.120732 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m10:16:40.121362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:40.121898 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (14224, 123145586282496)
[0m10:16:40.122570 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m10:16:40.123079 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m10:16:40.123537 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m10:16:41.074404 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m10:16:41.075161 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m10:16:41.077030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m10:16:41.077531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:41.247575 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m10:16:41.248349 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m10:16:41.249699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3282400>]}
[0m10:16:41.250512 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m10:16:41.251089 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m10:16:41.252238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:41.252876 [info ] [MainThread]: 
[0m10:16:41.261274 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m10:16:41.262078 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m10:16:41.263150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m10:16:41.263713 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m10:16:41.273680 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m10:16:41.274804 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 10:16:41.264099 => 10:16:41.274467
[0m10:16:41.275411 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m10:16:41.297530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:16:41.486030 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:16:41.777337 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:16:41.779632 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m10:16:41.780401 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m10:16:41.919534 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:43.089836 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1697568893432617s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:44.235896 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.3108081817626953s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:45.399445 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4645261764526367s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:46.538614 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.617223024368286s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:47.685061 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.759023189544678s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:49.604795 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.6789960861206055s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:50.745983 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.822585821151733s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:51.893731 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.97355604171753s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:53.040261 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.115463972091675s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:54.179461 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.255069971084595s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:55.326414 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.404326915740967s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:56.473750 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.554624080657959s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:57.617641 [debug] [Thread-1  ]: Glue adapter: [elapsed 15.699111938476562s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:58.759490 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.841743230819702s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:16:59.904586 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.98123288154602s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:01.052841 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.127273082733154s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:02.210452 [debug] [Thread-1  ]: Glue adapter: [elapsed 20.284001111984253s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:03.363587 [debug] [Thread-1  ]: Glue adapter: [elapsed 21.43508505821228s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:04.516426 [debug] [Thread-1  ]: Glue adapter: [elapsed 22.587646007537842s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:05.653430 [debug] [Thread-1  ]: Glue adapter: [elapsed 23.73266315460205s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:06.795303 [debug] [Thread-1  ]: Glue adapter: [elapsed 24.873893976211548s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:07.938283 [debug] [Thread-1  ]: Glue adapter: [elapsed 26.015465021133423s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:09.081279 [debug] [Thread-1  ]: Glue adapter: [elapsed 27.160412073135376s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:10.226268 [debug] [Thread-1  ]: Glue adapter: [elapsed 28.30768322944641s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:11.373110 [debug] [Thread-1  ]: Glue adapter: [elapsed 29.447716236114502s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:12.523686 [debug] [Thread-1  ]: Glue adapter: [elapsed 30.602632999420166s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:13.673686 [debug] [Thread-1  ]: Glue adapter: [elapsed 31.74963092803955s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:14.816012 [debug] [Thread-1  ]: Glue adapter: [elapsed 32.89556002616882s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:15.957207 [debug] [Thread-1  ]: Glue adapter: [elapsed 34.03566598892212s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:17.109104 [debug] [Thread-1  ]: Glue adapter: [elapsed 35.178858041763306s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:18.274281 [debug] [Thread-1  ]: Glue adapter: [elapsed 36.35184907913208s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:19.409506 [debug] [Thread-1  ]: Glue adapter: [elapsed 37.49337291717529s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:20.554747 [debug] [Thread-1  ]: Glue adapter: [elapsed 38.634987115859985s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:21.704055 [debug] [Thread-1  ]: Glue adapter: [elapsed 39.77700114250183s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:22.844035 [debug] [Thread-1  ]: Glue adapter: [elapsed 40.92401599884033s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in PROVISIONING state
[0m10:17:24.000192 [debug] [Thread-1  ]: Glue adapter: [elapsed 42.069594860076904s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in READY state
[0m10:17:24.068174 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:17:24.069139 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:17:34.199912 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:17:34.206932 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:17:34.208047 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:17:34.208960 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m10:17:47.405236 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318654411, 'CompletedOn': 1693318667300}, 'ResponseMetadata': {'RequestId': 'c334436a-a3bb-4187-b6b1-6348af8b8f17', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:17:47 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'c334436a-a3bb-4187-b6b1-6348af8b8f17'}, 'RetryAttempts': 0}}
[0m10:17:47.406300 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:17:47.407200 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:17:47.408131 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318654411, 'CompletedOn': 1693318667300}, 'ResponseMetadata': {'RequestId': 'c334436a-a3bb-4187-b6b1-6348af8b8f17', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:17:47 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'c334436a-a3bb-4187-b6b1-6348af8b8f17'}, 'RetryAttempts': 0}}
[0m10:17:47.408844 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:17:47.409747 [debug] [Thread-1  ]: SQL status: OK in 66.0 seconds
[0m10:17:47.484779 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m10:17:47.486053 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m10:17:47.486617 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m10:17:47.487173 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m10:17:47.558789 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:17:47.559782 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:17:49.444663 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:17:49.445498 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:17:49.446496 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:17:49.447574 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration 
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , type
    FROM nyctaxi.records 
    WHERE year = "2016"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  ''')
[0m10:18:29.986168 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year\n    , month \n    , type\n    FROM nyctaxi.records \n    WHERE year = "2016"\n    AND dropoff_datetime is not null \n    GROUP BY 5, 6, 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year\\n    , month \\n    , type\\n    FROM nyctaxi.records \\n    WHERE year = \\"2016\\"\\n    AND dropoff_datetime is not null \\n    GROUP BY 5, 6, 7\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318669597, 'CompletedOn': 1693318709277}, 'ResponseMetadata': {'RequestId': 'bb761297-d55d-42b7-bc95-1b4171772a2a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2178', 'connection': 'keep-alive', 'x-amzn-requestid': 'bb761297-d55d-42b7-bc95-1b4171772a2a'}, 'RetryAttempts': 0}}
[0m10:18:29.987348 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:29.988287 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year\\n    , month \\n    , type\\n    FROM nyctaxi.records \\n    WHERE year = \\"2016\\"\\n    AND dropoff_datetime is not null \\n    GROUP BY 5, 6, 7\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:29.989261 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year\n    , month \n    , type\n    FROM nyctaxi.records \n    WHERE year = "2016"\n    AND dropoff_datetime is not null \n    GROUP BY 5, 6, 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(dropoff_datetime as LONG) - CAST(pickup_datetime as LONG))/60) as avg_duration \\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year\\n    , month \\n    , type\\n    FROM nyctaxi.records \\n    WHERE year = \\"2016\\"\\n    AND dropoff_datetime is not null \\n    GROUP BY 5, 6, 7\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318669597, 'CompletedOn': 1693318709277}, 'ResponseMetadata': {'RequestId': 'bb761297-d55d-42b7-bc95-1b4171772a2a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2178', 'connection': 'keep-alive', 'x-amzn-requestid': 'bb761297-d55d-42b7-bc95-1b4171772a2a'}, 'RetryAttempts': 0}}
[0m10:18:29.990041 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:29.990680 [debug] [Thread-1  ]: SQL status: OK in 43.0 seconds
[0m10:18:30.014873 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 10:16:41.275804 => 10:18:30.014597
[0m10:18:30.015479 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m10:18:30.015981 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m10:18:30.016427 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m10:18:30.016878 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m10:18:30.017884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4c95b80>]}
[0m10:18:30.018601 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 108.76s]
[0m10:18:30.019368 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m10:18:30.020547 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m10:18:30.021137 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m10:18:30.022143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m10:18:30.022654 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m10:18:30.026650 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m10:18:30.027766 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 10:18:30.022994 => 10:18:30.027501
[0m10:18:30.028248 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m10:18:30.031781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:30.233584 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:30.422813 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:30.425009 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m10:18:30.425737 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m10:18:30.495552 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:30.496529 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:31.161320 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:31.162296 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:31.163104 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:31.163992 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m10:18:32.873587 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318711350, 'CompletedOn': 1693318711723}, 'ResponseMetadata': {'RequestId': '33e533d7-c544-489c-992f-bcc681895c3f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '918', 'connection': 'keep-alive', 'x-amzn-requestid': '33e533d7-c544-489c-992f-bcc681895c3f'}, 'RetryAttempts': 0}}
[0m10:18:32.874666 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:32.875549 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:32.876456 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318711350, 'CompletedOn': 1693318711723}, 'ResponseMetadata': {'RequestId': '33e533d7-c544-489c-992f-bcc681895c3f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '918', 'connection': 'keep-alive', 'x-amzn-requestid': '33e533d7-c544-489c-992f-bcc681895c3f'}, 'RetryAttempts': 0}}
[0m10:18:32.877174 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:32.877816 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m10:18:32.888629 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m10:18:32.889750 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m10:18:32.890297 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m10:18:32.890969 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m10:18:32.961025 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:32.961999 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:34.651679 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:34.652647 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:34.653540 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:34.654451 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m10:18:38.503532 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318714915, 'CompletedOn': 1693318717781}, 'ResponseMetadata': {'RequestId': 'c699e280-ac3f-40b4-becd-59dfa8462870', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1661', 'connection': 'keep-alive', 'x-amzn-requestid': 'c699e280-ac3f-40b4-becd-59dfa8462870'}, 'RetryAttempts': 0}}
[0m10:18:38.504642 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:38.505553 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:38.506461 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318714915, 'CompletedOn': 1693318717781}, 'ResponseMetadata': {'RequestId': 'c699e280-ac3f-40b4-becd-59dfa8462870', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1661', 'connection': 'keep-alive', 'x-amzn-requestid': 'c699e280-ac3f-40b4-becd-59dfa8462870'}, 'RetryAttempts': 0}}
[0m10:18:38.507220 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:38.507857 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m10:18:38.512168 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 10:18:30.028587 => 10:18:38.511749
[0m10:18:38.512788 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m10:18:38.513356 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m10:18:38.513879 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m10:18:38.514469 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m10:18:38.515468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4c97c40>]}
[0m10:18:38.516262 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics .... [[32mOK[0m in 8.49s]
[0m10:18:38.517104 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m10:18:38.517748 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m10:18:38.518468 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m10:18:38.519520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m10:18:38.520085 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m10:18:38.523978 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m10:18:38.525085 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 10:18:38.520492 => 10:18:38.524805
[0m10:18:38.525567 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m10:18:38.531371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:38.706306 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:39.023047 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:39.025473 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m10:18:39.026352 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m10:18:39.093637 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:39.094608 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:39.649599 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:39.650561 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:39.651367 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:39.652253 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m10:18:41.011949 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318719810, 'CompletedOn': 1693318720238}, 'ResponseMetadata': {'RequestId': '00a315f5-e00a-47fe-be11-8ac95a8ed9fb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:41 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': '00a315f5-e00a-47fe-be11-8ac95a8ed9fb'}, 'RetryAttempts': 0}}
[0m10:18:41.013011 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:41.013908 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:41.014764 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318719810, 'CompletedOn': 1693318720238}, 'ResponseMetadata': {'RequestId': '00a315f5-e00a-47fe-be11-8ac95a8ed9fb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:41 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': '00a315f5-e00a-47fe-be11-8ac95a8ed9fb'}, 'RetryAttempts': 0}}
[0m10:18:41.015481 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:41.016116 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m10:18:41.029158 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m10:18:41.030149 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m10:18:41.030648 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m10:18:41.031125 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m10:18:41.097606 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:41.098412 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:42.750608 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:42.751570 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:42.752377 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:42.753279 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m10:18:46.402520 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318722926, 'CompletedOn': 1693318726186}, 'ResponseMetadata': {'RequestId': 'fbca2720-63ab-40fc-89c3-3454727b8dc3', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:46 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1568', 'connection': 'keep-alive', 'x-amzn-requestid': 'fbca2720-63ab-40fc-89c3-3454727b8dc3'}, 'RetryAttempts': 0}}
[0m10:18:46.409336 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:46.410559 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:46.411637 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318722926, 'CompletedOn': 1693318726186}, 'ResponseMetadata': {'RequestId': 'fbca2720-63ab-40fc-89c3-3454727b8dc3', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:46 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1568', 'connection': 'keep-alive', 'x-amzn-requestid': 'fbca2720-63ab-40fc-89c3-3454727b8dc3'}, 'RetryAttempts': 0}}
[0m10:18:46.412577 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:46.413282 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m10:18:46.417400 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 10:18:38.525898 => 10:18:46.417082
[0m10:18:46.418092 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m10:18:46.418755 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m10:18:46.419430 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m10:18:46.419950 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m10:18:46.420901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3213910>]}
[0m10:18:46.421689 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[32mOK[0m in 7.90s]
[0m10:18:46.422532 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m10:18:46.423176 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m10:18:46.423880 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m10:18:46.424880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m10:18:46.425439 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m10:18:46.429452 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m10:18:46.430560 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 10:18:46.425821 => 10:18:46.430273
[0m10:18:46.431090 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m10:18:46.434968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:46.626054 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:46.907738 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m10:18:46.909936 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m10:18:46.910675 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m10:18:46.981987 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:46.982955 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:48.694696 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:48.695670 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:48.696480 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:48.697359 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m10:18:50.045945 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318728845, 'CompletedOn': 1693318729239}, 'ResponseMetadata': {'RequestId': 'd3de42f4-9c1a-4bf3-837d-9717c1cd8e1f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:50 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'd3de42f4-9c1a-4bf3-837d-9717c1cd8e1f'}, 'RetryAttempts': 0}}
[0m10:18:50.047030 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:50.047930 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:50.048770 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318728845, 'CompletedOn': 1693318729239}, 'ResponseMetadata': {'RequestId': 'd3de42f4-9c1a-4bf3-837d-9717c1cd8e1f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:50 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'd3de42f4-9c1a-4bf3-837d-9717c1cd8e1f'}, 'RetryAttempts': 0}}
[0m10:18:50.049493 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:50.050128 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m10:18:50.061467 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m10:18:50.062608 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m10:18:50.063147 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m10:18:50.063625 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m10:18:50.131270 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m10:18:50.132258 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9
[0m10:18:51.725775 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m10:18:51.726755 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m10:18:51.727714 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m10:18:51.728846 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m10:18:55.382562 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318731894, 'CompletedOn': 1693318734906}, 'ResponseMetadata': {'RequestId': '34cf64df-74f8-4975-9eb8-8f06ccec9d14', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1880', 'connection': 'keep-alive', 'x-amzn-requestid': '34cf64df-74f8-4975-9eb8-8f06ccec9d14'}, 'RetryAttempts': 0}}
[0m10:18:55.383700 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m10:18:55.384621 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m10:18:55.385576 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://aws-dbt-glue-datalake-253491126433-us-east-1//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1693318731894, 'CompletedOn': 1693318734906}, 'ResponseMetadata': {'RequestId': '34cf64df-74f8-4975-9eb8-8f06ccec9d14', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Tue, 29 Aug 2023 14:18:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1880', 'connection': 'keep-alive', 'x-amzn-requestid': '34cf64df-74f8-4975-9eb8-8f06ccec9d14'}, 'RetryAttempts': 0}}
[0m10:18:55.386346 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m10:18:55.386985 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m10:18:55.391326 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 10:18:46.431436 => 10:18:55.391001
[0m10:18:55.392003 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m10:18:55.392539 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m10:18:55.393047 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m10:18:55.393562 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m10:18:55.394557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2e12861-1ee9-47f1-b08f-d606ddebae85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4cafd90>]}
[0m10:18:55.395353 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[32mOK[0m in 8.97s]
[0m10:18:55.396190 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m10:18:55.398236 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:55.398751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:55.399229 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (14224, 140704473129792)
[0m10:18:55.399729 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m10:18:55.400225 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m10:18:55.400658 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m10:18:56.119623 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m10:18:56.120533 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m10:18:56.121240 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m10:18:56.121830 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:56.122381 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m10:18:56.122907 [debug] [MainThread]: On master: Close
[0m10:18:56.123452 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m10:18:56.124618 [debug] [MainThread]: Glue adapter: cleanup called
[0m10:18:56.125205 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:18:56.270200 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in READY state
[0m10:18:57.667644 [debug] [MainThread]: Glue adapter: [elapsed 1.4080040454864502s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:18:58.883793 [debug] [MainThread]: Glue adapter: [elapsed 2.6134750843048096s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:00.103171 [debug] [MainThread]: Glue adapter: [elapsed 3.8319549560546875s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:01.371612 [debug] [MainThread]: Glue adapter: [elapsed 5.049608945846558s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:02.579576 [debug] [MainThread]: Glue adapter: [elapsed 6.304401874542236s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:03.822393 [debug] [MainThread]: Glue adapter: [elapsed 7.530994892120361s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:05.035373 [debug] [MainThread]: Glue adapter: [elapsed 8.772058963775635s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:06.279468 [debug] [MainThread]: Glue adapter: [elapsed 9.983391046524048s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:07.475648 [debug] [MainThread]: Glue adapter: [elapsed 11.223871946334839s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:08.681921 [debug] [MainThread]: Glue adapter: [elapsed 12.422477006912231s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:09.864514 [debug] [MainThread]: Glue adapter: [elapsed 13.610517978668213s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:11.055170 [debug] [MainThread]: Glue adapter: [elapsed 14.801432132720947s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:12.601939 [debug] [MainThread]: Glue adapter: [elapsed 16.343640089035034s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:13.817354 [debug] [MainThread]: Glue adapter: [elapsed 17.551469087600708s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:15.617539 [debug] [MainThread]: Glue adapter: [elapsed 19.374161958694458s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:16.813703 [debug] [MainThread]: Glue adapter: [elapsed 20.55717706680298s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:18.017339 [debug] [MainThread]: Glue adapter: [elapsed 21.752385139465332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:19.211973 [debug] [MainThread]: Glue adapter: [elapsed 22.94357705116272s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:20.401515 [debug] [MainThread]: Glue adapter: [elapsed 24.15604305267334s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:21.594268 [debug] [MainThread]: Glue adapter: [elapsed 25.332047939300537s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:22.794342 [debug] [MainThread]: Glue adapter: [elapsed 26.5380961894989s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-86162777-17bf-4402-9625-40f3e3580ca9 in STOPPING state
[0m10:19:23.939579 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:19:24.067132 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in PROVISIONING state
[0m10:19:24.388905 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:19:25.528989 [debug] [MainThread]: Glue adapter: [elapsed 1.452704906463623s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in PROVISIONING state
[0m10:19:25.595422 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:19:27.073676 [debug] [MainThread]: Glue adapter: [elapsed 2.6566309928894043s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in PROVISIONING state
[0m10:19:27.151135 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:19:28.277644 [debug] [MainThread]: Glue adapter: [elapsed 4.2125279903411865s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in PROVISIONING state
[0m10:19:28.343594 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m10:19:29.463524 [debug] [MainThread]: Glue adapter: [elapsed 5.406146049499512s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in READY state
[0m10:19:30.842950 [debug] [MainThread]: Glue adapter: [elapsed 6.767411947250366s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:32.020273 [debug] [MainThread]: Glue adapter: [elapsed 7.967281818389893s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:33.223339 [debug] [MainThread]: Glue adapter: [elapsed 9.148470878601074s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:34.423971 [debug] [MainThread]: Glue adapter: [elapsed 10.344464778900146s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:35.645169 [debug] [MainThread]: Glue adapter: [elapsed 11.559646844863892s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:36.869510 [debug] [MainThread]: Glue adapter: [elapsed 12.78335690498352s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:38.087660 [debug] [MainThread]: Glue adapter: [elapsed 14.00402307510376s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:39.538760 [debug] [MainThread]: Glue adapter: [elapsed 15.221281051635742s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:40.756042 [debug] [MainThread]: Glue adapter: [elapsed 16.669631004333496s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:41.969991 [debug] [MainThread]: Glue adapter: [elapsed 17.886122941970825s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:43.184547 [debug] [MainThread]: Glue adapter: [elapsed 19.105382919311523s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:44.401375 [debug] [MainThread]: Glue adapter: [elapsed 20.31272602081299s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:45.619388 [debug] [MainThread]: Glue adapter: [elapsed 21.541420936584473s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:46.842737 [debug] [MainThread]: Glue adapter: [elapsed 22.755943775177002s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:48.054916 [debug] [MainThread]: Glue adapter: [elapsed 23.97811198234558s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:49.267831 [debug] [MainThread]: Glue adapter: [elapsed 25.191531896591187s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:50.503623 [debug] [MainThread]: Glue adapter: [elapsed 26.41282606124878s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:51.736440 [debug] [MainThread]: Glue adapter: [elapsed 27.65233302116394s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:52.951803 [debug] [MainThread]: Glue adapter: [elapsed 28.86927580833435s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:54.174138 [debug] [MainThread]: Glue adapter: [elapsed 30.08473014831543s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:55.381350 [debug] [MainThread]: Glue adapter: [elapsed 31.303125858306885s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:56.602052 [debug] [MainThread]: Glue adapter: [elapsed 32.50987482070923s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:57.800193 [debug] [MainThread]: Glue adapter: [elapsed 33.730015993118286s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:19:59.012510 [debug] [MainThread]: Glue adapter: [elapsed 34.93323993682861s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:00.390841 [debug] [MainThread]: Glue adapter: [elapsed 36.15722107887268s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:01.622561 [debug] [MainThread]: Glue adapter: [elapsed 37.53126811981201s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:02.842029 [debug] [MainThread]: Glue adapter: [elapsed 38.75764083862305s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:04.064743 [debug] [MainThread]: Glue adapter: [elapsed 39.96363115310669s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:05.264011 [debug] [MainThread]: Glue adapter: [elapsed 41.19713306427002s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:06.979550 [debug] [MainThread]: Glue adapter: [elapsed 42.91688895225525s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:08.780836 [debug] [MainThread]: Glue adapter: [elapsed 44.09493708610535s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:09.973990 [debug] [MainThread]: Glue adapter: [elapsed 45.904772996902466s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:11.161681 [debug] [MainThread]: Glue adapter: [elapsed 47.08634281158447s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:12.392156 [debug] [MainThread]: Glue adapter: [elapsed 48.295722007751465s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:13.599080 [debug] [MainThread]: Glue adapter: [elapsed 49.519794940948486s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:14.800027 [debug] [MainThread]: Glue adapter: [elapsed 50.724721908569336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:15.999572 [debug] [MainThread]: Glue adapter: [elapsed 51.92988109588623s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:17.586428 [debug] [MainThread]: Glue adapter: [elapsed 53.12989592552185s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:18.774554 [debug] [MainThread]: Glue adapter: [elapsed 54.70966696739197s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:19.997066 [debug] [MainThread]: Glue adapter: [elapsed 55.91692304611206s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:21.205230 [debug] [MainThread]: Glue adapter: [elapsed 57.12591004371643s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:22.415374 [debug] [MainThread]: Glue adapter: [elapsed 58.35327410697937s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:23.619364 [debug] [MainThread]: Glue adapter: [elapsed 59.541900873184204s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:24.823404 [debug] [MainThread]: Glue adapter: [elapsed 60.74739980697632s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:26.013105 [debug] [MainThread]: Glue adapter: [elapsed 61.94524383544922s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:27.197009 [debug] [MainThread]: Glue adapter: [elapsed 63.131574869155884s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:28.400060 [debug] [MainThread]: Glue adapter: [elapsed 64.32330203056335s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-4c6fd173-0195-47e5-9484-2bc7cd8e9cdd in STOPPING state
[0m10:20:29.528486 [info ] [MainThread]: 
[0m10:20:29.532995 [info ] [MainThread]: Finished running 4 table models in 0 hours 3 minutes and 49.41 seconds (229.41s).
[0m10:20:29.536418 [debug] [MainThread]: Command end result
[0m10:20:29.562027 [info ] [MainThread]: 
[0m10:20:29.566152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:29.568285 [info ] [MainThread]: 
[0m10:20:29.569768 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:20:29.572572 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:29.572182 after 230.04 seconds
[0m10:20:29.574489 [debug] [MainThread]: Glue adapter: cleanup called
[0m10:20:29.575075 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:20:29.701460 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m10:20:29.767548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb142acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb3476df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fb4c54d00>]}
[0m10:20:29.769231 [debug] [MainThread]: Flushing usage events
[0m12:50:53.173298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1df54e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1c5a7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20b74d00>]}


============================== 12:50:53.179973 | f5f98024-ac07-42f1-8f42-46d0f516759e ==============================
[0m12:50:53.179973 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:50:53.181141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:53.772287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1c5a7a60>]}
[0m12:50:53.838518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21259f70>]}
[0m12:50:53.840704 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:50:53.935526 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:50:53.950496 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:50:53.951444 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m12:50:53.952850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21279b80>]}
[0m12:50:55.737670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d215210d0>]}
[0m12:50:55.759540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2134cbe0>]}
[0m12:50:55.760274 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:50:55.760932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5f98024-ac07-42f1-8f42-46d0f516759e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d2136f3d0>]}
[0m12:50:55.763862 [info ] [MainThread]: 
[0m12:50:55.765039 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:50:55.766598 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:50:55.767084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:55.767578 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (23502, 123145461325824)
[0m12:50:55.767994 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:50:55.768370 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:50:55.768744 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:50:56.790037 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:50:56.790915 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:50:56.792770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:50:56.793975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:57.428598 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/stg//dbt_nyc_metrics/
[0m12:50:57.429763 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m12:50:57.433688 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:50:57.434355 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:50:57.436831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:50:57.437358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:57.606225 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m12:50:57.608333 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:50:57.608998 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:50:57.610999 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:50:57.611610 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:50:57.751110 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:50:57.838751 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:50:58.991133 [debug] [MainThread]: Glue adapter: [elapsed 1.2287652492523193s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:50:59.072397 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:00.235315 [debug] [MainThread]: Glue adapter: [elapsed 2.4632620811462402s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:00.321874 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:01.465952 [debug] [MainThread]: Glue adapter: [elapsed 3.7132441997528076s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:01.537613 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:02.684162 [debug] [MainThread]: Glue adapter: [elapsed 4.930629014968872s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:02.764892 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:03.918274 [debug] [MainThread]: Glue adapter: [elapsed 6.1547791957855225s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:03.992443 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:05.142240 [debug] [MainThread]: Glue adapter: [elapsed 7.381936073303223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:05.223684 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:06.364954 [debug] [MainThread]: Glue adapter: [elapsed 8.618067264556885s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:06.445818 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:07.650284 [debug] [MainThread]: Glue adapter: [elapsed 9.836093187332153s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:07.730843 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:08.873332 [debug] [MainThread]: Glue adapter: [elapsed 11.120117902755737s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:08.943373 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:10.084557 [debug] [MainThread]: Glue adapter: [elapsed 12.332678079605103s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:10.153651 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:11.314664 [debug] [MainThread]: Glue adapter: [elapsed 13.54683518409729s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:11.392319 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:12.540993 [debug] [MainThread]: Glue adapter: [elapsed 14.785160064697266s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:13.203094 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:14.358152 [debug] [MainThread]: Glue adapter: [elapsed 16.596888065338135s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:14.430347 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:15.591390 [debug] [MainThread]: Glue adapter: [elapsed 17.820826053619385s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:15.669517 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:16.815287 [debug] [MainThread]: Glue adapter: [elapsed 19.058919191360474s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in PROVISIONING state
[0m12:51:18.253808 [debug] [MainThread]: Glue adapter: [elapsed 20.485419988632202s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:19.469928 [debug] [MainThread]: Glue adapter: [elapsed 21.719171047210693s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:20.698317 [debug] [MainThread]: Glue adapter: [elapsed 22.933950185775757s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:21.914055 [debug] [MainThread]: Glue adapter: [elapsed 24.159577131271362s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:23.172354 [debug] [MainThread]: Glue adapter: [elapsed 25.387198209762573s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:24.388494 [debug] [MainThread]: Glue adapter: [elapsed 26.63618493080139s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:25.600554 [debug] [MainThread]: Glue adapter: [elapsed 27.84613800048828s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:26.821627 [debug] [MainThread]: Glue adapter: [elapsed 29.06854009628296s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:28.053756 [debug] [MainThread]: Glue adapter: [elapsed 30.28569793701172s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:29.587754 [debug] [MainThread]: Glue adapter: [elapsed 31.5155291557312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:30.111517 [error] [MainThread]: Encountered an error:

[0m12:51:30.121468 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m12:51:30.130245 [debug] [MainThread]: Command `dbt run` failed at 12:51:30.128306 after 37.00 seconds
[0m12:51:30.134589 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:51:30.136469 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:51:30.285672 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:31.498534 [debug] [MainThread]: Glue adapter: [elapsed 1.2166218757629395s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5c5622d-63fa-4f3e-8788-5d3eea7a9ca3 in STOPPING state
[0m12:51:31.594042 [debug] [MainThread]: Flushing usage events
[0m12:51:47.112735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc029f837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc027da7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02c8f3cd0>]}


============================== 12:51:47.117790 | 7da728ad-1e0b-485d-a359-73277970753c ==============================
[0m12:51:47.117790 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:51:47.118607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:51:47.457642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc027da7af0>]}
[0m12:51:47.480340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d230f40>]}
[0m12:51:47.481717 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:51:47.525238 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:51:47.538083 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:51:47.538751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d253b50>]}
[0m12:51:48.996609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d62f0d0>]}
[0m12:51:49.011465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d33aa30>]}
[0m12:51:49.012074 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:51:49.012520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da728ad-1e0b-485d-a359-73277970753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc02d33aeb0>]}
[0m12:51:49.014099 [info ] [MainThread]: 
[0m12:51:49.015028 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:51:49.016517 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:51:49.017031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:49.017525 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (23531, 123145477009408)
[0m12:51:49.017946 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:51:49.018321 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:51:49.018695 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:51:49.945512 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:51:49.946393 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:51:49.948635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:51:49.950083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:50.494390 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data//dbt_nyc_metrics/
[0m12:51:50.495276 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m12:51:50.498631 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:51:50.499250 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:51:50.502583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:51:50.503222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:50.688171 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m12:51:50.691145 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:51:50.691763 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:51:50.693252 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:51:50.693811 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:51:50.839117 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:50.923872 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:52.075915 [debug] [MainThread]: Glue adapter: [elapsed 1.234057903289795s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:52.155151 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:53.314787 [debug] [MainThread]: Glue adapter: [elapsed 2.464411735534668s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:53.394392 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:54.535701 [debug] [MainThread]: Glue adapter: [elapsed 3.7034199237823486s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:54.612901 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:55.760216 [debug] [MainThread]: Glue adapter: [elapsed 4.921629905700684s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:55.839799 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:56.987659 [debug] [MainThread]: Glue adapter: [elapsed 6.147490978240967s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:57.063304 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:58.224369 [debug] [MainThread]: Glue adapter: [elapsed 7.369531869888306s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:58.299678 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:51:59.436701 [debug] [MainThread]: Glue adapter: [elapsed 8.610873699188232s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:51:59.510797 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:00.668455 [debug] [MainThread]: Glue adapter: [elapsed 9.820774793624878s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:52:00.743161 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:01.892166 [debug] [MainThread]: Glue adapter: [elapsed 11.049936771392822s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:52:01.970140 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:03.129849 [debug] [MainThread]: Glue adapter: [elapsed 12.281231880187988s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:52:03.208457 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:04.338004 [debug] [MainThread]: Glue adapter: [elapsed 13.514488935470581s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in PROVISIONING state
[0m12:52:04.637130 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:05.773213 [debug] [MainThread]: Glue adapter: [elapsed 14.947683095932007s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in READY state
[0m12:52:07.184558 [debug] [MainThread]: Glue adapter: [elapsed 16.347731828689575s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:08.384725 [debug] [MainThread]: Glue adapter: [elapsed 17.564689874649048s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:09.581056 [debug] [MainThread]: Glue adapter: [elapsed 18.759612798690796s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:10.810329 [debug] [MainThread]: Glue adapter: [elapsed 19.986573934555054s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:12.009801 [debug] [MainThread]: Glue adapter: [elapsed 21.180689811706543s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:13.212687 [debug] [MainThread]: Glue adapter: [elapsed 22.379515886306763s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:14.407405 [debug] [MainThread]: Glue adapter: [elapsed 23.582664966583252s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:15.598602 [debug] [MainThread]: Glue adapter: [elapsed 24.772137880325317s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:16.795947 [debug] [MainThread]: Glue adapter: [elapsed 25.974143028259277s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:18.011844 [debug] [MainThread]: Glue adapter: [elapsed 27.16879892349243s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:19.212548 [debug] [MainThread]: Glue adapter: [elapsed 28.37055492401123s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:20.408769 [debug] [MainThread]: Glue adapter: [elapsed 29.581825017929077s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:21.639736 [debug] [MainThread]: Glue adapter: [elapsed 30.80759286880493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:22.864745 [debug] [MainThread]: Glue adapter: [elapsed 32.01590299606323s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:24.435356 [debug] [MainThread]: Glue adapter: [elapsed 33.23832392692566s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:25.647371 [debug] [MainThread]: Glue adapter: [elapsed 34.80636692047119s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:27.099314 [debug] [MainThread]: Glue adapter: [elapsed 36.0311279296875s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:28.285150 [debug] [MainThread]: Glue adapter: [elapsed 37.470616817474365s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:29.452508 [debug] [MainThread]: Glue adapter: [elapsed 38.648321866989136s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:30.664019 [debug] [MainThread]: Glue adapter: [elapsed 39.827779054641724s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:31.867546 [debug] [MainThread]: Glue adapter: [elapsed 41.03851294517517s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:33.076877 [debug] [MainThread]: Glue adapter: [elapsed 42.23948001861572s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:34.291369 [debug] [MainThread]: Glue adapter: [elapsed 43.46416187286377s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:35.488569 [debug] [MainThread]: Glue adapter: [elapsed 44.66423296928406s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:36.680259 [debug] [MainThread]: Glue adapter: [elapsed 45.85118794441223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:37.881926 [debug] [MainThread]: Glue adapter: [elapsed 47.048550844192505s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:39.113661 [debug] [MainThread]: Glue adapter: [elapsed 48.25850701332092s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:40.293880 [debug] [MainThread]: Glue adapter: [elapsed 49.4911048412323s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:41.487553 [debug] [MainThread]: Glue adapter: [elapsed 50.654045820236206s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:42.707492 [debug] [MainThread]: Glue adapter: [elapsed 51.86815094947815s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:43.899863 [debug] [MainThread]: Glue adapter: [elapsed 53.08416795730591s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-20d377cd-0607-48dd-9f18-039bd8717a03 in STOPPING state
[0m12:52:44.733007 [error] [MainThread]: Encountered an error:

[0m12:52:44.801032 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 222, in close_session
    self.client.stop_session(Id=self.session_id)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/client.py", line 535, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/client.py", line 963, in _make_api_call
    http, parsed_response = self._make_request(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/client.py", line 986, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/endpoint.py", line 199, in _send_request
    success_response, exception = self._get_response(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/endpoint.py", line 241, in _get_response
    success_response, exception = self._do_get_response(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/httpsession.py", line 465, in send
    urllib_response = conn.urlopen(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/urllib3/connectionpool.py", line 714, in urlopen
    httplib_response = self._make_request(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/urllib3/connectionpool.py", line 466, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/urllib3/connectionpool.py", line 461, in _make_request
    httplib_response = conn.getresponse()
  File "/opt/anaconda3/lib/python3.9/http/client.py", line 1377, in getresponse
    response.begin()
  File "/opt/anaconda3/lib/python3.9/http/client.py", line 320, in begin
    version, status, reason = self._read_status()
  File "/opt/anaconda3/lib/python3.9/http/client.py", line 281, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/opt/anaconda3/lib/python3.9/socket.py", line 704, in readinto
    return self._sock.recv_into(b)
  File "/opt/anaconda3/lib/python3.9/ssl.py", line 1241, in recv_into
    return self.read(nbytes, buffer)
  File "/opt/anaconda3/lib/python3.9/ssl.py", line 1099, in read
    return self._sslobj.read(len, buffer)
KeyboardInterrupt

[0m12:52:44.809231 [debug] [MainThread]: Command `dbt run` failed at 12:52:44.808905 after 57.72 seconds
[0m12:52:44.810106 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:52:44.810587 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:52:45.043207 [debug] [MainThread]: Flushing usage events
[0m12:52:53.573814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f789ef900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f789cda7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a1c74d60>]}


============================== 12:52:53.578933 | 4061fc02-2935-43ab-a0f1-c8bb88ab9ec8 ==============================
[0m12:52:53.578933 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:52:53.579752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:52:54.053296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f789cda7a30>]}
[0m12:52:54.078028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a2357fd0>]}
[0m12:52:54.079451 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:52:54.118834 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:52:54.131941 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:52:54.132674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a2379be0>]}
[0m12:52:55.578787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a26210d0>]}
[0m12:52:55.594852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a2447d90>]}
[0m12:52:55.595474 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:52:55.596004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4061fc02-2935-43ab-a0f1-c8bb88ab9ec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a247f100>]}
[0m12:52:55.597665 [info ] [MainThread]: 
[0m12:52:55.598784 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:52:55.600220 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:52:55.600788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:55.601257 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (23563, 123145459478528)
[0m12:52:55.601865 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:52:55.602319 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:52:55.602713 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:52:56.685214 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:52:56.685966 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:52:56.687726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:52:56.688787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:57.303986 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m12:52:57.304803 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m12:52:57.308098 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:52:57.308698 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:52:57.311074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:52:57.311695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:57.481895 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m12:52:57.484169 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:52:57.484850 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:52:57.486606 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:52:57.487199 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:52:57.648780 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:52:57.735438 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:52:58.881083 [debug] [MainThread]: Glue adapter: [elapsed 1.2534561157226562s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:52:58.953498 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:00.102530 [debug] [MainThread]: Glue adapter: [elapsed 2.467531204223633s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:00.177025 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:01.327414 [debug] [MainThread]: Glue adapter: [elapsed 3.6946780681610107s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:01.405044 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:02.540994 [debug] [MainThread]: Glue adapter: [elapsed 4.922903060913086s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:02.641153 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:03.782855 [debug] [MainThread]: Glue adapter: [elapsed 6.15641188621521s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:03.862448 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:04.995135 [debug] [MainThread]: Glue adapter: [elapsed 7.375638008117676s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:05.067801 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:06.207891 [debug] [MainThread]: Glue adapter: [elapsed 8.58340311050415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:06.280660 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:07.420601 [debug] [MainThread]: Glue adapter: [elapsed 9.79344630241394s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:07.502432 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:08.650326 [debug] [MainThread]: Glue adapter: [elapsed 11.017222881317139s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:08.722191 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:09.882579 [debug] [MainThread]: Glue adapter: [elapsed 12.24126124382019s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:09.995098 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:11.132240 [debug] [MainThread]: Glue adapter: [elapsed 13.50835108757019s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in PROVISIONING state
[0m12:53:11.204548 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:53:12.360233 [debug] [MainThread]: Glue adapter: [elapsed 14.728180170059204s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in READY state
[0m12:53:13.680001 [debug] [MainThread]: Glue adapter: [elapsed 16.04669427871704s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:15.433770 [debug] [MainThread]: Glue adapter: [elapsed 17.261713981628418s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:16.658175 [debug] [MainThread]: Glue adapter: [elapsed 19.024501085281372s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:17.894787 [debug] [MainThread]: Glue adapter: [elapsed 20.24890923500061s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:19.106732 [debug] [MainThread]: Glue adapter: [elapsed 21.48436403274536s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:20.328601 [debug] [MainThread]: Glue adapter: [elapsed 22.699475049972534s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:21.535580 [debug] [MainThread]: Glue adapter: [elapsed 23.915647983551025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:22.757710 [debug] [MainThread]: Glue adapter: [elapsed 25.109941005706787s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:23.978683 [debug] [MainThread]: Glue adapter: [elapsed 26.34798312187195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:25.192253 [debug] [MainThread]: Glue adapter: [elapsed 27.563902139663696s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:26.412455 [debug] [MainThread]: Glue adapter: [elapsed 28.77765989303589s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:27.645930 [debug] [MainThread]: Glue adapter: [elapsed 29.994986057281494s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:28.861996 [debug] [MainThread]: Glue adapter: [elapsed 31.233052968978882s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:30.080751 [debug] [MainThread]: Glue adapter: [elapsed 32.44691205024719s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:31.294192 [debug] [MainThread]: Glue adapter: [elapsed 33.67232894897461s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:32.493142 [debug] [MainThread]: Glue adapter: [elapsed 34.879247188568115s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:33.733946 [debug] [MainThread]: Glue adapter: [elapsed 36.08546209335327s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:34.950772 [debug] [MainThread]: Glue adapter: [elapsed 37.31781005859375s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:36.773462 [debug] [MainThread]: Glue adapter: [elapsed 39.139034271240234s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:37.987113 [debug] [MainThread]: Glue adapter: [elapsed 40.3554413318634s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:39.208484 [debug] [MainThread]: Glue adapter: [elapsed 41.574620962142944s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:40.412420 [debug] [MainThread]: Glue adapter: [elapsed 42.78884816169739s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:41.634666 [debug] [MainThread]: Glue adapter: [elapsed 43.994243144989014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:42.845229 [debug] [MainThread]: Glue adapter: [elapsed 45.217313051223755s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:44.055735 [debug] [MainThread]: Glue adapter: [elapsed 46.43223214149475s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:45.496042 [debug] [MainThread]: Glue adapter: [elapsed 47.862213134765625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:46.712650 [debug] [MainThread]: Glue adapter: [elapsed 49.084187269210815s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:47.914299 [debug] [MainThread]: Glue adapter: [elapsed 50.298134088516235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:49.131554 [debug] [MainThread]: Glue adapter: [elapsed 51.505752086639404s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:50.361254 [debug] [MainThread]: Glue adapter: [elapsed 52.721287965774536s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:51.586847 [debug] [MainThread]: Glue adapter: [elapsed 53.953702211380005s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:52.804166 [debug] [MainThread]: Glue adapter: [elapsed 55.17178821563721s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:54.006274 [debug] [MainThread]: Glue adapter: [elapsed 56.39255404472351s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:55.218701 [debug] [MainThread]: Glue adapter: [elapsed 57.593300104141235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:56.427902 [debug] [MainThread]: Glue adapter: [elapsed 58.80759811401367s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:57.654426 [debug] [MainThread]: Glue adapter: [elapsed 60.018699169158936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:53:58.869757 [debug] [MainThread]: Glue adapter: [elapsed 61.24272799491882s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:00.086379 [debug] [MainThread]: Glue adapter: [elapsed 62.453179121017456s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:01.298438 [debug] [MainThread]: Glue adapter: [elapsed 63.672029972076416s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:02.523534 [debug] [MainThread]: Glue adapter: [elapsed 64.88627004623413s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:03.759827 [debug] [MainThread]: Glue adapter: [elapsed 66.13470602035522s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:04.984458 [debug] [MainThread]: Glue adapter: [elapsed 67.34962105751038s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:06.196696 [debug] [MainThread]: Glue adapter: [elapsed 68.57291507720947s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:07.413463 [debug] [MainThread]: Glue adapter: [elapsed 69.7888252735138s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:08.627377 [debug] [MainThread]: Glue adapter: [elapsed 70.99374604225159s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:09.846462 [debug] [MainThread]: Glue adapter: [elapsed 72.21008634567261s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:11.090063 [debug] [MainThread]: Glue adapter: [elapsed 73.43844318389893s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-df42607f-73b3-4c76-8616-e71bd4866367 in STOPPING state
[0m12:54:12.228581 [info ] [MainThread]: 
[0m12:54:12.230191 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 16.63 seconds (76.63s).
[0m12:54:12.233683 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m12:54:12.248226 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

[0m12:54:12.393932 [debug] [MainThread]: Command `dbt run` failed at 12:54:12.393202 after 78.85 seconds
[0m12:54:12.395809 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:54:12.396479 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:54:12.470852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f789ef900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a1d24af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78a25a7c10>]}
[0m12:54:12.472386 [debug] [MainThread]: Flushing usage events
[0m12:54:49.012223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12c7837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12ada7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12f374cd0>]}


============================== 12:54:49.019655 | c307882c-7378-430f-a537-c2e9abf1189f ==============================
[0m12:54:49.019655 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:54:49.020734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:49.402825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c307882c-7378-430f-a537-c2e9abf1189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12ada7af0>]}
[0m12:54:49.426235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c307882c-7378-430f-a537-c2e9abf1189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12fa58f40>]}
[0m12:54:49.427878 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:54:49.457325 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:54:49.559139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:49.559700 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:49.567078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c307882c-7378-430f-a537-c2e9abf1189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12fac70d0>]}
[0m12:54:49.586790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c307882c-7378-430f-a537-c2e9abf1189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12fc7bc10>]}
[0m12:54:49.587700 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:54:49.588252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c307882c-7378-430f-a537-c2e9abf1189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12fc7ba30>]}
[0m12:54:49.590204 [info ] [MainThread]: 
[0m12:54:49.591378 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:54:49.592934 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:54:49.593716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:49.595123 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (23614, 123145551777792)
[0m12:54:49.595559 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:54:49.595944 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:54:49.596381 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:54:50.611525 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:54:50.612273 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:54:50.614281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:54:50.616121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:51.150994 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m12:54:51.152104 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m12:54:51.155070 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:54:51.155693 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:54:51.159238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:54:51.159911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:51.336123 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m12:54:51.338423 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:54:51.339110 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:54:51.340715 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:54:51.341253 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:54:51.474537 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:51.742665 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:52.880844 [debug] [MainThread]: Glue adapter: [elapsed 1.4050829410552979s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:52.959132 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:54.182473 [debug] [MainThread]: Glue adapter: [elapsed 2.6213529109954834s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:54.253528 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:55.389616 [debug] [MainThread]: Glue adapter: [elapsed 3.9155828952789307s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:55.466190 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:56.613173 [debug] [MainThread]: Glue adapter: [elapsed 5.126070022583008s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:56.689920 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:57.841132 [debug] [MainThread]: Glue adapter: [elapsed 6.349501848220825s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:57.907358 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:54:59.039851 [debug] [MainThread]: Glue adapter: [elapsed 7.56821084022522s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:54:59.109414 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:00.245592 [debug] [MainThread]: Glue adapter: [elapsed 8.77314281463623s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:00.321553 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:01.452518 [debug] [MainThread]: Glue adapter: [elapsed 9.9809889793396s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:01.517319 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:02.648255 [debug] [MainThread]: Glue adapter: [elapsed 11.176996946334839s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:02.718849 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:03.858656 [debug] [MainThread]: Glue adapter: [elapsed 12.378127813339233s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:03.928954 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:05.054410 [debug] [MainThread]: Glue adapter: [elapsed 13.588282823562622s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:05.127682 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:06.266012 [debug] [MainThread]: Glue adapter: [elapsed 14.791118860244751s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:06.340489 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:07.465160 [debug] [MainThread]: Glue adapter: [elapsed 16.000444889068604s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:07.541934 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:08.704366 [debug] [MainThread]: Glue adapter: [elapsed 17.205502033233643s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:08.780432 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:09.931406 [debug] [MainThread]: Glue adapter: [elapsed 18.443615913391113s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:10.005243 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:11.153306 [debug] [MainThread]: Glue adapter: [elapsed 19.667821884155273s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:11.218196 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:12.359024 [debug] [MainThread]: Glue adapter: [elapsed 20.878593683242798s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:12.423016 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:13.556776 [debug] [MainThread]: Glue adapter: [elapsed 22.08406686782837s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:13.630446 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:14.941152 [debug] [MainThread]: Glue adapter: [elapsed 23.29418706893921s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in PROVISIONING state
[0m12:55:15.018321 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m12:55:16.163623 [debug] [MainThread]: Glue adapter: [elapsed 24.679664850234985s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in READY state
[0m12:55:17.556844 [debug] [MainThread]: Glue adapter: [elapsed 26.069520950317383s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:18.741617 [debug] [MainThread]: Glue adapter: [elapsed 27.28005290031433s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:19.964767 [debug] [MainThread]: Glue adapter: [elapsed 28.45780301094055s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:21.171106 [debug] [MainThread]: Glue adapter: [elapsed 29.700336933135986s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:22.377303 [debug] [MainThread]: Glue adapter: [elapsed 30.905823945999146s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:23.588672 [debug] [MainThread]: Glue adapter: [elapsed 32.10038876533508s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:24.804388 [debug] [MainThread]: Glue adapter: [elapsed 33.31771492958069s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:26.045777 [debug] [MainThread]: Glue adapter: [elapsed 34.57588982582092s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:27.241187 [debug] [MainThread]: Glue adapter: [elapsed 35.77387809753418s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:28.448007 [debug] [MainThread]: Glue adapter: [elapsed 36.969456911087036s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:29.647922 [debug] [MainThread]: Glue adapter: [elapsed 38.17490887641907s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:30.851103 [debug] [MainThread]: Glue adapter: [elapsed 39.37394571304321s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:32.056811 [debug] [MainThread]: Glue adapter: [elapsed 40.58246684074402s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:33.259405 [debug] [MainThread]: Glue adapter: [elapsed 41.78548288345337s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:34.471438 [debug] [MainThread]: Glue adapter: [elapsed 42.99865388870239s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:35.685728 [debug] [MainThread]: Glue adapter: [elapsed 44.1965548992157s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:36.904154 [debug] [MainThread]: Glue adapter: [elapsed 45.422990798950195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:38.096248 [debug] [MainThread]: Glue adapter: [elapsed 46.63720178604126s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:39.302604 [debug] [MainThread]: Glue adapter: [elapsed 47.82408595085144s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:40.519210 [debug] [MainThread]: Glue adapter: [elapsed 49.03601098060608s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:41.734059 [debug] [MainThread]: Glue adapter: [elapsed 50.24822497367859s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:42.948499 [debug] [MainThread]: Glue adapter: [elapsed 51.46265769004822s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:44.149051 [debug] [MainThread]: Glue adapter: [elapsed 52.67837190628052s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:45.346922 [debug] [MainThread]: Glue adapter: [elapsed 53.86409592628479s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:46.567104 [debug] [MainThread]: Glue adapter: [elapsed 55.081526041030884s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:47.783026 [debug] [MainThread]: Glue adapter: [elapsed 56.3022940158844s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:48.980204 [debug] [MainThread]: Glue adapter: [elapsed 57.51103067398071s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:50.181035 [debug] [MainThread]: Glue adapter: [elapsed 58.707239866256714s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:51.393217 [debug] [MainThread]: Glue adapter: [elapsed 59.906614780426025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:52.601298 [debug] [MainThread]: Glue adapter: [elapsed 61.123451948165894s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:53.790258 [debug] [MainThread]: Glue adapter: [elapsed 62.330262660980225s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:54.996031 [debug] [MainThread]: Glue adapter: [elapsed 63.52236795425415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:56.208845 [debug] [MainThread]: Glue adapter: [elapsed 64.72969770431519s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:57.426833 [debug] [MainThread]: Glue adapter: [elapsed 65.94420981407166s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:58.636962 [debug] [MainThread]: Glue adapter: [elapsed 67.15824174880981s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:55:59.844714 [debug] [MainThread]: Glue adapter: [elapsed 68.36477589607239s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:01.038006 [debug] [MainThread]: Glue adapter: [elapsed 69.56290578842163s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:02.246484 [debug] [MainThread]: Glue adapter: [elapsed 70.76848793029785s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:03.486620 [debug] [MainThread]: Glue adapter: [elapsed 71.9829330444336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:04.706346 [debug] [MainThread]: Glue adapter: [elapsed 73.22530484199524s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:05.882392 [debug] [MainThread]: Glue adapter: [elapsed 74.43192672729492s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:07.093596 [debug] [MainThread]: Glue adapter: [elapsed 75.61010885238647s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:08.288687 [debug] [MainThread]: Glue adapter: [elapsed 76.81437969207764s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:09.511207 [debug] [MainThread]: Glue adapter: [elapsed 78.03392791748047s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:10.711976 [debug] [MainThread]: Glue adapter: [elapsed 79.22530198097229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:11.929373 [debug] [MainThread]: Glue adapter: [elapsed 80.4475679397583s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:13.140949 [debug] [MainThread]: Glue adapter: [elapsed 81.66016697883606s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:14.348486 [debug] [MainThread]: Glue adapter: [elapsed 82.88350987434387s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:15.568082 [debug] [MainThread]: Glue adapter: [elapsed 84.07731890678406s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f3f7f2e5-8b6b-4ad5-8848-e7840bd8fb80 in STOPPING state
[0m12:56:16.708371 [info ] [MainThread]: 
[0m12:56:16.710890 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 27.12 seconds (87.12s).
[0m12:56:16.712445 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m12:56:16.720909 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

[0m12:56:16.741944 [debug] [MainThread]: Command `dbt run` failed at 12:56:16.741674 after 87.76 seconds
[0m12:56:16.742941 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:56:16.743847 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:56:16.818818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12c7837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1317ff0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1317ffaf0>]}
[0m12:56:16.820139 [debug] [MainThread]: Flushing usage events
[0m13:02:33.845349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c2790280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c05a7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c5475d60>]}


============================== 13:02:33.853215 | 65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d ==============================
[0m13:02:33.853215 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:02:33.854610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'profile', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:02:34.417351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c05a7a30>]}
[0m13:02:34.440219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c5a55fd0>]}
[0m13:02:34.441555 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:02:34.506938 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:02:34.623185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:34.623716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:34.630947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c5c070d0>]}
[0m13:02:34.653080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c5d7cca0>]}
[0m13:02:34.653994 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:02:34.654519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bb5c6b-4913-4b1b-a1f5-1fe8d9cb674d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c5d7cac0>]}
[0m13:02:34.656512 [info ] [MainThread]: 
[0m13:02:34.657592 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:02:34.659248 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:02:34.659814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:34.660408 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (24037, 123145542934528)
[0m13:02:34.660909 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:02:34.661343 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:02:34.661855 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:02:35.799037 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:02:35.799607 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:02:35.801158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:02:35.802070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:36.296177 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:02:36.297390 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:02:36.301632 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:02:36.302534 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:02:36.306171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:02:36.307037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:36.490202 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:02:36.493163 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:02:36.494053 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:02:36.496600 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:02:36.497634 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:02:36.643364 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:36.721252 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:37.879451 [debug] [MainThread]: Glue adapter: [elapsed 1.2263259887695312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:37.947515 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:39.095142 [debug] [MainThread]: Glue adapter: [elapsed 2.453382968902588s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:39.171726 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:40.332120 [debug] [MainThread]: Glue adapter: [elapsed 3.676154851913452s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:40.404120 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:41.559000 [debug] [MainThread]: Glue adapter: [elapsed 4.910378932952881s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:41.630446 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:41.710577 [error] [MainThread]: Encountered an error:

[0m13:02:41.719038 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m13:02:41.726989 [debug] [MainThread]: Command `dbt run` failed at 13:02:41.726465 after 7.93 seconds
[0m13:02:41.728148 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:02:41.728989 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:02:41.902802 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:41.980624 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:43.126746 [debug] [MainThread]: Glue adapter: [elapsed 1.2537510395050049s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:43.211643 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:44.352499 [debug] [MainThread]: Glue adapter: [elapsed 2.4829838275909424s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:44.431449 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:45.565485 [debug] [MainThread]: Glue adapter: [elapsed 3.7028307914733887s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:45.640133 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:46.781527 [debug] [MainThread]: Glue adapter: [elapsed 4.911457061767578s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:46.860062 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:48.013831 [debug] [MainThread]: Glue adapter: [elapsed 6.136046886444092s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:48.085726 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:49.228397 [debug] [MainThread]: Glue adapter: [elapsed 7.3572328090667725s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-339e2270-da82-4de7-8ff2-0f2f8c028d7f in PROVISIONING state
[0m13:02:49.298227 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:02:50.123466 [debug] [MainThread]: Flushing usage events
[0m13:03:49.742326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a187d0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a164b1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1b474d30>]}


============================== 13:03:49.749278 | ca4177e9-8bf1-4e7d-998b-69b72dd3da79 ==============================
[0m13:03:49.749278 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:03:49.750255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:50.177316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca4177e9-8bf1-4e7d-998b-69b72dd3da79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a164b1a30>]}
[0m13:03:50.209974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca4177e9-8bf1-4e7d-998b-69b72dd3da79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1ba28fa0>]}
[0m13:03:50.211392 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:03:50.281552 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:03:50.385103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:50.385573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:50.394295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca4177e9-8bf1-4e7d-998b-69b72dd3da79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1ba880d0>]}
[0m13:03:50.420729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca4177e9-8bf1-4e7d-998b-69b72dd3da79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1bc3dc70>]}
[0m13:03:50.421639 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:03:50.422288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca4177e9-8bf1-4e7d-998b-69b72dd3da79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a1bc3da90>]}
[0m13:03:50.424473 [info ] [MainThread]: 
[0m13:03:50.425614 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:03:50.427530 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:03:50.428237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:50.428779 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (24090, 123145401966592)
[0m13:03:50.429277 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:03:50.429714 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:03:50.430145 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:03:51.422083 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:03:51.422971 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:03:51.424853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:03:51.425978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:52.107120 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:03:52.108171 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:03:52.111833 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:03:52.112408 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:03:52.114566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:03:52.115034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:52.284327 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:03:52.287365 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:03:52.288235 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:03:52.290773 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:03:52.291695 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:03:52.428017 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:52.508213 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:03:53.669622 [debug] [MainThread]: Glue adapter: [elapsed 1.2182600498199463s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:53.740291 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:03:54.685969 [error] [MainThread]: Encountered an error:

[0m13:03:54.695099 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m13:03:54.699987 [debug] [MainThread]: Command `dbt run` failed at 13:03:54.699731 after 5.00 seconds
[0m13:03:54.700698 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:03:54.701363 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:03:54.863379 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:54.933582 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:03:56.087139 [debug] [MainThread]: Glue adapter: [elapsed 1.2330172061920166s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:56.412795 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:03:57.556870 [debug] [MainThread]: Glue adapter: [elapsed 2.713481903076172s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:57.630075 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:03:58.779283 [debug] [MainThread]: Glue adapter: [elapsed 3.9296820163726807s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:03:58.853430 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:04:01.024562 [debug] [MainThread]: Glue adapter: [elapsed 5.152343034744263s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:04:01.106964 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:04:02.267298 [debug] [MainThread]: Glue adapter: [elapsed 7.408785104751587s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:04:02.337755 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:04:03.470522 [debug] [MainThread]: Glue adapter: [elapsed 8.637310981750488s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-a870fdf2-2da2-4961-b092-83059900ed90 in PROVISIONING state
[0m13:04:03.516846 [debug] [MainThread]: Flushing usage events
[0m13:31:53.389135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df37d0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df1596640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df6333df0>]}


============================== 13:31:53.396814 | f2cb84b6-7482-46e6-a69c-504e3f4f916b ==============================
[0m13:31:53.396814 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:31:53.397790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:53.871116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cb84b6-7482-46e6-a69c-504e3f4f916b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df1596640>]}
[0m13:31:53.894071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2cb84b6-7482-46e6-a69c-504e3f4f916b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df6a220a0>]}
[0m13:31:53.895431 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:31:53.955239 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:31:54.066675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:54.067200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:54.074520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2cb84b6-7482-46e6-a69c-504e3f4f916b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df6a870d0>]}
[0m13:31:54.094937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2cb84b6-7482-46e6-a69c-504e3f4f916b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df6d48d30>]}
[0m13:31:54.095804 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:31:54.096350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cb84b6-7482-46e6-a69c-504e3f4f916b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df6d48b50>]}
[0m13:31:54.098352 [info ] [MainThread]: 
[0m13:31:54.099429 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:31:54.101073 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:31:54.101763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:54.102422 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (24688, 123145507999744)
[0m13:31:54.102879 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:31:54.103263 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:31:54.103632 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:31:55.714247 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:31:55.715170 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:31:55.717168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:31:55.718271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:56.255886 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:31:56.256824 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:31:56.260042 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:31:56.260614 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:31:56.262931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:31:56.263482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:56.425580 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:31:56.427682 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:31:56.428332 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:31:56.429964 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:31:56.430486 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:31:56.577322 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:31:56.659251 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:31:57.795603 [debug] [MainThread]: Glue adapter: [elapsed 1.229508876800537s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:31:57.867518 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:31:59.009799 [debug] [MainThread]: Glue adapter: [elapsed 2.4386119842529297s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:31:59.088051 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:00.232300 [debug] [MainThread]: Glue adapter: [elapsed 3.6631271839141846s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:00.309261 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:01.456621 [debug] [MainThread]: Glue adapter: [elapsed 4.880995035171509s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:01.536519 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:02.686060 [debug] [MainThread]: Glue adapter: [elapsed 6.106894016265869s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:02.759260 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:03.908169 [debug] [MainThread]: Glue adapter: [elapsed 7.330756902694702s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:03.987975 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:05.151183 [debug] [MainThread]: Glue adapter: [elapsed 8.561805009841919s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:05.224959 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:06.373917 [debug] [MainThread]: Glue adapter: [elapsed 9.7984619140625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:06.454704 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:07.604134 [debug] [MainThread]: Glue adapter: [elapsed 11.02974009513855s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:07.678026 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:09.429840 [debug] [MainThread]: Glue adapter: [elapsed 12.24997615814209s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:09.520986 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:10.650302 [debug] [MainThread]: Glue adapter: [elapsed 14.095239877700806s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:10.725839 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:11.868366 [debug] [MainThread]: Glue adapter: [elapsed 15.30091404914856s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:11.940525 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:13.075233 [debug] [MainThread]: Glue adapter: [elapsed 16.51218008995056s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:13.148369 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:14.279724 [debug] [MainThread]: Glue adapter: [elapsed 17.723531007766724s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:15.267070 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:16.410830 [debug] [MainThread]: Glue adapter: [elapsed 19.84031891822815s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:16.485377 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:17.614296 [debug] [MainThread]: Glue adapter: [elapsed 21.056928157806396s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:17.692335 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:18.834113 [debug] [MainThread]: Glue adapter: [elapsed 22.267341136932373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:18.915595 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:20.050624 [debug] [MainThread]: Glue adapter: [elapsed 23.491053104400635s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:20.119520 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:21.251003 [debug] [MainThread]: Glue adapter: [elapsed 24.68971610069275s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:21.330219 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:22.486666 [debug] [MainThread]: Glue adapter: [elapsed 25.905208110809326s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:22.555248 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:23.670833 [debug] [MainThread]: Glue adapter: [elapsed 27.126222133636475s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:23.750817 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:24.924636 [debug] [MainThread]: Glue adapter: [elapsed 28.32136297225952s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:24.997734 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:26.137539 [debug] [MainThread]: Glue adapter: [elapsed 29.572700023651123s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:26.215366 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:27.362676 [debug] [MainThread]: Glue adapter: [elapsed 30.785757064819336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:27.432954 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:28.569730 [debug] [MainThread]: Glue adapter: [elapsed 32.00724506378174s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:28.640012 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:29.771662 [debug] [MainThread]: Glue adapter: [elapsed 33.210450887680054s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:29.840775 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:30.981893 [debug] [MainThread]: Glue adapter: [elapsed 34.41573095321655s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:31.053778 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:32.186413 [debug] [MainThread]: Glue adapter: [elapsed 35.625086069107056s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:32.257081 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:33.385560 [debug] [MainThread]: Glue adapter: [elapsed 36.82714915275574s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:33.454413 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:33.526502 [error] [MainThread]: Encountered an error:

[0m13:32:33.538552 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m13:32:33.549600 [debug] [MainThread]: Command `dbt run` failed at 13:32:33.548761 after 40.21 seconds
[0m13:32:33.550559 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:32:33.551936 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:32:33.697982 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:33.784704 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:34.920442 [debug] [MainThread]: Glue adapter: [elapsed 1.2382762432098389s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b456e312-4e77-4a30-90bc-48a9ed2f1832 in PROVISIONING state
[0m13:32:34.993212 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:32:35.439831 [debug] [MainThread]: Flushing usage events
[0m13:45:51.189732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6447d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6425b1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647334d00>]}


============================== 13:45:51.196270 | 3f5d273d-c092-4eb4-875e-db2f5c95e359 ==============================
[0m13:45:51.196270 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:45:51.197074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:51.643827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5d273d-c092-4eb4-875e-db2f5c95e359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6425b1a60>]}
[0m13:45:51.667951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5d273d-c092-4eb4-875e-db2f5c95e359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647a18f70>]}
[0m13:45:51.669395 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:45:51.707393 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:45:51.823023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:45:51.823585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:45:51.831514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f5d273d-c092-4eb4-875e-db2f5c95e359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647a870d0>]}
[0m13:45:51.848899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f5d273d-c092-4eb4-875e-db2f5c95e359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647d49c40>]}
[0m13:45:51.849789 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:45:51.850436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f5d273d-c092-4eb4-875e-db2f5c95e359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd647d49a60>]}
[0m13:45:51.852498 [info ] [MainThread]: 
[0m13:45:51.853625 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:45:51.855766 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:45:51.857046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:51.857521 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (24999, 123145542369280)
[0m13:45:51.857958 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:45:51.858379 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:45:51.858758 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:45:52.922474 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:45:52.923039 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:45:52.924415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:45:52.925184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:53.461764 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:45:53.462592 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:45:53.466096 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:45:53.466717 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:45:53.469161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:45:53.469854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:53.650443 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:45:53.652658 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:45:53.653335 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:45:53.655065 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:45:53.655704 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:45:53.792602 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:53.877419 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:45:55.016633 [debug] [MainThread]: Glue adapter: [elapsed 1.2233798503875732s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:55.100564 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:45:56.237943 [debug] [MainThread]: Glue adapter: [elapsed 2.444969892501831s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:56.318048 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:45:57.463729 [debug] [MainThread]: Glue adapter: [elapsed 3.664191961288452s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:57.534325 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:45:58.674175 [debug] [MainThread]: Glue adapter: [elapsed 4.8801209926605225s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:58.748582 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:45:59.907007 [debug] [MainThread]: Glue adapter: [elapsed 6.094757080078125s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:45:59.978935 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:01.124666 [debug] [MainThread]: Glue adapter: [elapsed 7.323631048202515s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:01.198984 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:02.345993 [debug] [MainThread]: Glue adapter: [elapsed 8.544134140014648s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:02.428261 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:03.607682 [debug] [MainThread]: Glue adapter: [elapsed 9.77773118019104s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:03.682742 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:04.825336 [debug] [MainThread]: Glue adapter: [elapsed 11.026807069778442s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:04.898220 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:06.039819 [debug] [MainThread]: Glue adapter: [elapsed 12.242954015731812s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:06.128781 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:07.274437 [debug] [MainThread]: Glue adapter: [elapsed 13.476721048355103s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:07.348386 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:08.486755 [debug] [MainThread]: Glue adapter: [elapsed 14.69326901435852s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:08.560651 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:09.708827 [debug] [MainThread]: Glue adapter: [elapsed 15.907586097717285s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:09.785778 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:10.931413 [debug] [MainThread]: Glue adapter: [elapsed 17.13491702079773s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:11.007650 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:12.152063 [debug] [MainThread]: Glue adapter: [elapsed 18.35273003578186s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in PROVISIONING state
[0m13:46:12.226311 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:46:13.371346 [debug] [MainThread]: Glue adapter: [elapsed 19.575781106948853s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in READY state
[0m13:46:14.759277 [debug] [MainThread]: Glue adapter: [elapsed 20.963781118392944s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:16.009343 [debug] [MainThread]: Glue adapter: [elapsed 22.17354393005371s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:17.224784 [debug] [MainThread]: Glue adapter: [elapsed 23.431435108184814s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:18.432949 [debug] [MainThread]: Glue adapter: [elapsed 24.637799978256226s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:19.682204 [debug] [MainThread]: Glue adapter: [elapsed 25.849576950073242s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:20.890283 [debug] [MainThread]: Glue adapter: [elapsed 27.09802484512329s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:22.104656 [debug] [MainThread]: Glue adapter: [elapsed 28.30739188194275s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:23.319110 [debug] [MainThread]: Glue adapter: [elapsed 29.522075176239014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:24.537115 [debug] [MainThread]: Glue adapter: [elapsed 30.73688006401062s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:25.748168 [debug] [MainThread]: Glue adapter: [elapsed 31.955058097839355s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:26.955301 [debug] [MainThread]: Glue adapter: [elapsed 33.160765171051025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:28.167312 [debug] [MainThread]: Glue adapter: [elapsed 34.370707988739014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:29.385774 [debug] [MainThread]: Glue adapter: [elapsed 35.58185386657715s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:30.611974 [debug] [MainThread]: Glue adapter: [elapsed 36.803227186203s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:31.829261 [debug] [MainThread]: Glue adapter: [elapsed 38.03157019615173s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:33.038480 [debug] [MainThread]: Glue adapter: [elapsed 39.247294902801514s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:34.272783 [debug] [MainThread]: Glue adapter: [elapsed 40.48432803153992s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:35.478209 [debug] [MainThread]: Glue adapter: [elapsed 41.68473219871521s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:36.691259 [debug] [MainThread]: Glue adapter: [elapsed 42.8896381855011s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:37.882991 [debug] [MainThread]: Glue adapter: [elapsed 44.099518060684204s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:39.089938 [debug] [MainThread]: Glue adapter: [elapsed 45.29698705673218s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:40.312543 [debug] [MainThread]: Glue adapter: [elapsed 46.4834349155426s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:41.511420 [debug] [MainThread]: Glue adapter: [elapsed 47.72118401527405s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:42.713401 [debug] [MainThread]: Glue adapter: [elapsed 48.91977596282959s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:43.899592 [debug] [MainThread]: Glue adapter: [elapsed 50.132668256759644s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:45.104670 [debug] [MainThread]: Glue adapter: [elapsed 51.3121452331543s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:46.455960 [debug] [MainThread]: Glue adapter: [elapsed 52.520999908447266s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:47.675056 [debug] [MainThread]: Glue adapter: [elapsed 53.875648021698s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:48.885117 [debug] [MainThread]: Glue adapter: [elapsed 55.0922110080719s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:50.089186 [debug] [MainThread]: Glue adapter: [elapsed 56.28471612930298s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:51.310369 [debug] [MainThread]: Glue adapter: [elapsed 57.509835958480835s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:52.505005 [debug] [MainThread]: Glue adapter: [elapsed 58.70979905128479s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:53.737779 [debug] [MainThread]: Glue adapter: [elapsed 59.934765100479126s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:54.947817 [debug] [MainThread]: Glue adapter: [elapsed 61.15028500556946s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:56.159826 [debug] [MainThread]: Glue adapter: [elapsed 62.36058592796326s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:58.014412 [debug] [MainThread]: Glue adapter: [elapsed 63.58934807777405s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:46:59.235134 [debug] [MainThread]: Glue adapter: [elapsed 65.4347939491272s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:00.411622 [debug] [MainThread]: Glue adapter: [elapsed 66.64894700050354s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:01.627293 [debug] [MainThread]: Glue adapter: [elapsed 67.82703709602356s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:02.834489 [debug] [MainThread]: Glue adapter: [elapsed 69.043869972229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:04.055440 [debug] [MainThread]: Glue adapter: [elapsed 70.25812721252441s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:05.262471 [debug] [MainThread]: Glue adapter: [elapsed 71.47595405578613s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:06.457751 [debug] [MainThread]: Glue adapter: [elapsed 72.68153595924377s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:07.681294 [debug] [MainThread]: Glue adapter: [elapsed 73.86349105834961s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:08.907072 [debug] [MainThread]: Glue adapter: [elapsed 75.10015988349915s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:10.108102 [debug] [MainThread]: Glue adapter: [elapsed 76.30834102630615s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:11.311332 [debug] [MainThread]: Glue adapter: [elapsed 77.51376605033875s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:12.514629 [debug] [MainThread]: Glue adapter: [elapsed 78.71405696868896s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fe0ac122-d349-46df-900c-74dd1757d1f8 in STOPPING state
[0m13:47:13.665031 [info ] [MainThread]: 
[0m13:47:13.672485 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 21.81 seconds (81.81s).
[0m13:47:13.674359 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m13:47:13.684153 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

[0m13:47:13.688362 [debug] [MainThread]: Command `dbt run` failed at 13:47:13.687976 after 82.54 seconds
[0m13:47:13.689492 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:47:13.690256 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:47:13.760189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6447d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6496ea280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6496ea550>]}
[0m13:47:13.761953 [debug] [MainThread]: Flushing usage events
[0m13:51:49.485552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc51f900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc50ca7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc55374d00>]}


============================== 13:51:49.492310 | 372b6860-27db-4d48-8a93-c442e89b1115 ==============================
[0m13:51:49.492310 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:51:49.493206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:49.866702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '372b6860-27db-4d48-8a93-c442e89b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc50ca7a60>]}
[0m13:51:49.888676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '372b6860-27db-4d48-8a93-c442e89b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc55a5df70>]}
[0m13:51:49.892192 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:51:49.936004 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:51:50.045664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:50.046181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:50.053507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372b6860-27db-4d48-8a93-c442e89b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc55c070d0>]}
[0m13:51:50.073896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372b6860-27db-4d48-8a93-c442e89b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc55d7bc40>]}
[0m13:51:50.074706 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:51:50.075384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '372b6860-27db-4d48-8a93-c442e89b1115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc55d7ba60>]}
[0m13:51:50.077366 [info ] [MainThread]: 
[0m13:51:50.078541 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:51:50.080099 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:51:50.081959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:50.082466 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (25130, 123145546252288)
[0m13:51:50.082890 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:51:50.083278 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:51:50.083674 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:51:51.155410 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:51:51.156274 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:51:51.158100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:51:51.159185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:51.710070 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:51:51.710886 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:51:51.713951 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:51:51.714509 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:51:51.716844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:51:51.717437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:51.876397 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:51:51.878480 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:51:51.879132 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:51:51.880829 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:51:51.881368 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:51:52.030351 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:52.117391 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:53.274212 [debug] [MainThread]: Glue adapter: [elapsed 1.2400569915771484s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:53.346585 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:54.499895 [debug] [MainThread]: Glue adapter: [elapsed 2.470780849456787s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:54.576848 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:55.731020 [debug] [MainThread]: Glue adapter: [elapsed 3.7003519535064697s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:55.810650 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:56.955676 [debug] [MainThread]: Glue adapter: [elapsed 4.930958986282349s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:57.029592 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:58.171286 [debug] [MainThread]: Glue adapter: [elapsed 6.153299808502197s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:58.247757 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:51:59.396833 [debug] [MainThread]: Glue adapter: [elapsed 7.3681910037994385s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:51:59.473933 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:00.634040 [debug] [MainThread]: Glue adapter: [elapsed 8.595396995544434s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:00.711162 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:01.877069 [debug] [MainThread]: Glue adapter: [elapsed 9.83423399925232s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:01.958877 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:03.102010 [debug] [MainThread]: Glue adapter: [elapsed 11.082496881484985s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:03.182780 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:04.328156 [debug] [MainThread]: Glue adapter: [elapsed 12.30222487449646s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:04.411032 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:05.583081 [debug] [MainThread]: Glue adapter: [elapsed 13.531814813613892s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:05.661606 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:06.807474 [debug] [MainThread]: Glue adapter: [elapsed 14.784687042236328s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:06.883682 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:08.029993 [debug] [MainThread]: Glue adapter: [elapsed 16.003926992416382s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:08.114165 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:09.266647 [debug] [MainThread]: Glue adapter: [elapsed 17.236177921295166s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:09.344711 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:10.490090 [debug] [MainThread]: Glue adapter: [elapsed 18.465818881988525s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in PROVISIONING state
[0m13:52:10.568277 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:52:11.718515 [debug] [MainThread]: Glue adapter: [elapsed 19.691065073013306s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in READY state
[0m13:52:13.060189 [debug] [MainThread]: Glue adapter: [elapsed 21.032041788101196s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:14.282191 [debug] [MainThread]: Glue adapter: [elapsed 22.25118899345398s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:16.135237 [debug] [MainThread]: Glue adapter: [elapsed 24.1061429977417s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:17.358698 [debug] [MainThread]: Glue adapter: [elapsed 25.32419180870056s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:18.574803 [debug] [MainThread]: Glue adapter: [elapsed 26.549742937088013s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:19.794742 [debug] [MainThread]: Glue adapter: [elapsed 27.770964860916138s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:21.009889 [debug] [MainThread]: Glue adapter: [elapsed 28.98993992805481s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:22.231993 [debug] [MainThread]: Glue adapter: [elapsed 30.199172973632812s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:23.461294 [debug] [MainThread]: Glue adapter: [elapsed 31.422050952911377s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:24.766970 [debug] [MainThread]: Glue adapter: [elapsed 32.732287883758545s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:25.984305 [debug] [MainThread]: Glue adapter: [elapsed 33.95616793632507s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:27.203764 [debug] [MainThread]: Glue adapter: [elapsed 35.181373834609985s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:28.427947 [debug] [MainThread]: Glue adapter: [elapsed 36.399354696273804s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:29.663836 [debug] [MainThread]: Glue adapter: [elapsed 37.62786674499512s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:30.887211 [debug] [MainThread]: Glue adapter: [elapsed 38.85737085342407s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:32.108500 [debug] [MainThread]: Glue adapter: [elapsed 40.081871032714844s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:33.339036 [debug] [MainThread]: Glue adapter: [elapsed 41.30172681808472s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:34.558369 [debug] [MainThread]: Glue adapter: [elapsed 42.53628373146057s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:35.781097 [debug] [MainThread]: Glue adapter: [elapsed 43.74602174758911s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:37.009279 [debug] [MainThread]: Glue adapter: [elapsed 44.980712890625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:38.244697 [debug] [MainThread]: Glue adapter: [elapsed 46.21429705619812s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:39.464379 [debug] [MainThread]: Glue adapter: [elapsed 47.43577480316162s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:40.696527 [debug] [MainThread]: Glue adapter: [elapsed 48.661022901535034s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:41.915398 [debug] [MainThread]: Glue adapter: [elapsed 49.887407064437866s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:43.132994 [debug] [MainThread]: Glue adapter: [elapsed 51.10214185714722s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:44.366737 [debug] [MainThread]: Glue adapter: [elapsed 52.32649803161621s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:45.601856 [debug] [MainThread]: Glue adapter: [elapsed 53.57811713218689s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:46.826687 [debug] [MainThread]: Glue adapter: [elapsed 54.80219101905823s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:48.050883 [debug] [MainThread]: Glue adapter: [elapsed 56.025118827819824s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:49.283626 [debug] [MainThread]: Glue adapter: [elapsed 57.24699282646179s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:50.510416 [debug] [MainThread]: Glue adapter: [elapsed 58.47553205490112s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:51.714870 [debug] [MainThread]: Glue adapter: [elapsed 59.696682929992676s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:52.930315 [debug] [MainThread]: Glue adapter: [elapsed 60.903708934783936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:54.155700 [debug] [MainThread]: Glue adapter: [elapsed 62.12926983833313s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:55.417731 [debug] [MainThread]: Glue adapter: [elapsed 63.34960675239563s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:56.679429 [debug] [MainThread]: Glue adapter: [elapsed 64.65362596511841s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:57.894406 [debug] [MainThread]: Glue adapter: [elapsed 65.8682291507721s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:52:58.711287 [error] [MainThread]: Encountered an error:

[0m13:52:58.721199 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m13:52:58.730824 [debug] [MainThread]: Command `dbt run` failed at 13:52:58.729267 after 69.28 seconds
[0m13:52:58.732959 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:52:58.733814 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:52:59.175816 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:53:00.361953 [debug] [MainThread]: Glue adapter: [elapsed 1.5006837844848633s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:53:01.657254 [debug] [MainThread]: Glue adapter: [elapsed 2.7053608894348145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-37ae0a66-0d8c-4141-8e3a-db8360e54791 in STOPPING state
[0m13:53:02.816828 [debug] [MainThread]: Flushing usage events
[0m13:53:18.689275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f5e947f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f3cb1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f8b74cd0>]}


============================== 13:53:18.695652 | 11731a6f-b229-4103-a8c9-c28183012ed6 ==============================
[0m13:53:18.695652 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:53:18.696441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir profile', 'send_anonymous_usage_stats': 'True'}
[0m13:53:19.066324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11731a6f-b229-4103-a8c9-c28183012ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f3cb1af0>]}
[0m13:53:19.088904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11731a6f-b229-4103-a8c9-c28183012ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f9258f40>]}
[0m13:53:19.090589 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:53:19.134330 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:53:19.255236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:19.255865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:19.264060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11731a6f-b229-4103-a8c9-c28183012ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f92c70d0>]}
[0m13:53:19.279850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11731a6f-b229-4103-a8c9-c28183012ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f947bc10>]}
[0m13:53:19.280484 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:53:19.280947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11731a6f-b229-4103-a8c9-c28183012ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f947ba30>]}
[0m13:53:19.282712 [info ] [MainThread]: 
[0m13:53:19.283970 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:53:19.285488 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:53:19.286128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:19.286589 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (25184, 123145515106304)
[0m13:53:19.287007 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:53:19.287381 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:53:19.287753 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:53:20.227419 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:53:20.228214 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:53:20.229991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now create_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:53:20.231069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:20.760840 [error] [ThreadPool]: Glue adapter: An error occurred (AccessDeniedException) when calling the CreateDatabase operation: Insufficient Lake Formation permission(s) on s3://ikoch-lakeformation-db/nyctaxi-data/dbt_nyc_metrics/
[0m13:53:20.761659 [error] [ThreadPool]: Glue adapter: create_schema exception
[0m13:53:20.764763 [debug] [ThreadPool]: On create_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:53:20.765328 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:53:20.767707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_nyc_metrics_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:53:20.768260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:20.943484 [error] [ThreadPool]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database dbt_nyc_metrics not found.
[0m13:53:20.945546 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:53:20.946197 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:53:20.947890 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:53:20.948382 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:53:21.084425 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:21.159293 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:22.312557 [debug] [MainThread]: Glue adapter: [elapsed 1.2175581455230713s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:22.388533 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:23.531215 [debug] [MainThread]: Glue adapter: [elapsed 2.444218158721924s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:23.596884 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:24.747380 [debug] [MainThread]: Glue adapter: [elapsed 3.6493492126464844s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:24.820360 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:25.961665 [debug] [MainThread]: Glue adapter: [elapsed 4.875051021575928s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:26.028626 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:27.167485 [debug] [MainThread]: Glue adapter: [elapsed 6.084663152694702s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:27.236086 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:28.376277 [debug] [MainThread]: Glue adapter: [elapsed 7.292992115020752s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:28.454159 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:29.611458 [debug] [MainThread]: Glue adapter: [elapsed 8.508831024169922s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:29.678967 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:30.817272 [debug] [MainThread]: Glue adapter: [elapsed 9.732322216033936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:30.903000 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:32.054746 [debug] [MainThread]: Glue adapter: [elapsed 10.958755254745483s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:32.123509 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:33.273973 [debug] [MainThread]: Glue adapter: [elapsed 12.179188013076782s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:33.339902 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:34.492897 [debug] [MainThread]: Glue adapter: [elapsed 13.392003059387207s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:34.606388 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:35.754663 [debug] [MainThread]: Glue adapter: [elapsed 14.662115097045898s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:35.839202 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:36.986569 [debug] [MainThread]: Glue adapter: [elapsed 15.895751953125s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:37.068317 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:38.221089 [debug] [MainThread]: Glue adapter: [elapsed 17.125723123550415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:38.290106 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:39.415137 [debug] [MainThread]: Glue adapter: [elapsed 18.342484951019287s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in PROVISIONING state
[0m13:53:39.487186 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:53:40.639592 [debug] [MainThread]: Glue adapter: [elapsed 19.54347014427185s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in READY state
[0m13:53:42.056185 [debug] [MainThread]: Glue adapter: [elapsed 20.955295085906982s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:43.281354 [debug] [MainThread]: Glue adapter: [elapsed 22.180936098098755s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:44.494230 [debug] [MainThread]: Glue adapter: [elapsed 23.409564971923828s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:45.712777 [debug] [MainThread]: Glue adapter: [elapsed 24.620825052261353s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:47.075993 [debug] [MainThread]: Glue adapter: [elapsed 25.975250959396362s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:48.498178 [debug] [MainThread]: Glue adapter: [elapsed 27.405238151550293s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:49.715703 [debug] [MainThread]: Glue adapter: [elapsed 28.626485109329224s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:50.935951 [debug] [MainThread]: Glue adapter: [elapsed 29.842803955078125s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:52.144881 [debug] [MainThread]: Glue adapter: [elapsed 31.05163812637329s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:53.371202 [debug] [MainThread]: Glue adapter: [elapsed 32.27319312095642s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:54.580602 [debug] [MainThread]: Glue adapter: [elapsed 33.49590301513672s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:55.795890 [debug] [MainThread]: Glue adapter: [elapsed 34.71062397956848s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:57.027124 [debug] [MainThread]: Glue adapter: [elapsed 35.92952513694763s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:58.257116 [debug] [MainThread]: Glue adapter: [elapsed 37.16353106498718s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:53:59.482621 [debug] [MainThread]: Glue adapter: [elapsed 38.38643503189087s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:00.706887 [debug] [MainThread]: Glue adapter: [elapsed 39.607906103134155s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:01.929502 [debug] [MainThread]: Glue adapter: [elapsed 40.834768295288086s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:03.141757 [debug] [MainThread]: Glue adapter: [elapsed 42.050759077072144s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:04.557919 [debug] [MainThread]: Glue adapter: [elapsed 43.26620006561279s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:05.770021 [debug] [MainThread]: Glue adapter: [elapsed 44.68270492553711s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:06.991196 [debug] [MainThread]: Glue adapter: [elapsed 45.890775203704834s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:08.200645 [debug] [MainThread]: Glue adapter: [elapsed 47.116801023483276s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:09.408573 [debug] [MainThread]: Glue adapter: [elapsed 48.32840609550476s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:10.655225 [debug] [MainThread]: Glue adapter: [elapsed 49.558226108551025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:11.869438 [debug] [MainThread]: Glue adapter: [elapsed 50.77438497543335s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:13.096580 [debug] [MainThread]: Glue adapter: [elapsed 51.99216103553772s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:14.339456 [debug] [MainThread]: Glue adapter: [elapsed 53.257728099823s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:15.556914 [debug] [MainThread]: Glue adapter: [elapsed 54.455729961395264s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:16.775334 [debug] [MainThread]: Glue adapter: [elapsed 55.682899951934814s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:17.973457 [debug] [MainThread]: Glue adapter: [elapsed 56.893418073654175s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:19.168048 [debug] [MainThread]: Glue adapter: [elapsed 58.09191107749939s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:20.393551 [debug] [MainThread]: Glue adapter: [elapsed 59.28823208808899s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:21.606305 [debug] [MainThread]: Glue adapter: [elapsed 60.51619791984558s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:22.825421 [debug] [MainThread]: Glue adapter: [elapsed 61.72961616516113s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:24.833121 [debug] [MainThread]: Glue adapter: [elapsed 62.940690994262695s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:26.050312 [debug] [MainThread]: Glue adapter: [elapsed 64.95794725418091s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:27.249059 [debug] [MainThread]: Glue adapter: [elapsed 66.17357110977173s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:28.479293 [debug] [MainThread]: Glue adapter: [elapsed 67.36606311798096s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:29.698684 [debug] [MainThread]: Glue adapter: [elapsed 68.62142205238342s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:30.893673 [debug] [MainThread]: Glue adapter: [elapsed 69.82213521003723s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:32.084956 [debug] [MainThread]: Glue adapter: [elapsed 71.02258610725403s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:33.291801 [debug] [MainThread]: Glue adapter: [elapsed 72.22713017463684s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:34.514437 [debug] [MainThread]: Glue adapter: [elapsed 73.41105890274048s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:35.711687 [debug] [MainThread]: Glue adapter: [elapsed 74.62505912780762s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:36.929509 [debug] [MainThread]: Glue adapter: [elapsed 75.84327721595764s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:38.097992 [debug] [MainThread]: Glue adapter: [elapsed 77.03847908973694s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:39.300409 [debug] [MainThread]: Glue adapter: [elapsed 78.21072101593018s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-26d72d99-cd8d-4a44-bb2f-e30cd7fb3a1c in STOPPING state
[0m13:54:40.451192 [info ] [MainThread]: 
[0m13:54:40.451879 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 21.17 seconds (81.17s).
[0m13:54:40.452686 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m13:54:40.461058 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 429, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/run.py", line 447, in before_run
    self.populate_adapter_cache(adapter, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 407, in populate_adapter_cache
    adapter.set_relations_cache(self.manifest)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 473, in set_relations_cache
    self._relations_cache_for_schemas(manifest, required_schemas)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 450, in _relations_cache_for_schemas
    for relation in future.result():
TypeError: 'NoneType' object is not iterable

[0m13:54:40.463881 [debug] [MainThread]: Command `dbt run` failed at 13:54:40.463641 after 81.80 seconds
[0m13:54:40.464758 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:54:40.465922 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:54:40.554950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0f5e947f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0fae6f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0fae6ff40>]}
[0m13:54:40.556706 [debug] [MainThread]: Flushing usage events
[0m12:29:21.222788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedde7c37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede1334b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede1334d60>]}


============================== 12:29:21.229859 | 4f5f6baa-3d19-4468-909a-20cda3a1412d ==============================
[0m12:29:21.229859 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:29:21.230803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir profile', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:29:21.231582 [info ] [MainThread]: dbt version: 1.6.1
[0m12:29:21.232067 [info ] [MainThread]: python version: 3.9.12
[0m12:29:21.232522 [info ] [MainThread]: python path: /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/bin/python3
[0m12:29:21.233037 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m12:29:21.593676 [info ] [MainThread]: Using profiles dir at profile
[0m12:29:21.594234 [info ] [MainThread]: Using profiles.yml file at profile/profiles.yml
[0m12:29:21.594864 [info ] [MainThread]: Using dbt_project.yml file at /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/dbt_project.yml
[0m12:29:21.595907 [info ] [MainThread]: adapter type: glue
[0m12:29:21.598028 [info ] [MainThread]: adapter version: 1.6.2
[0m12:29:21.657565 [info ] [MainThread]: Configuration:
[0m12:29:21.658757 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:29:21.660855 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:29:21.663623 [info ] [MainThread]: Required dependencies:
[0m12:29:21.665608 [debug] [MainThread]: Executing "git --help"
[0m12:29:21.734274 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:29:21.735327 [debug] [MainThread]: STDERR: "b''"
[0m12:29:21.735795 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:29:21.736226 [info ] [MainThread]: Connection:
[0m12:29:21.736869 [info ] [MainThread]:   role_arn: arn:aws:iam::253491126433:role/GlueInteractiveSessionRole
[0m12:29:21.737561 [info ] [MainThread]:   region: us-east-1
[0m12:29:21.738066 [info ] [MainThread]:   workers: 2
[0m12:29:21.738528 [info ] [MainThread]:   worker_type: G.1X
[0m12:29:21.738919 [info ] [MainThread]:   session_provisioning_timeout_in_seconds: 120
[0m12:29:21.739569 [info ] [MainThread]:   schema: dbt_nyc_metrics
[0m12:29:21.740303 [info ] [MainThread]:   location: s3://ikoch-lakeformation-db/nyctaxi-data-out/
[0m12:29:21.741000 [info ] [MainThread]:   extra_jars: None
[0m12:29:21.741734 [info ] [MainThread]:   idle_timeout: 10
[0m12:29:21.742441 [info ] [MainThread]:   query_timeout_in_minutes: 300
[0m12:29:21.743119 [info ] [MainThread]:   glue_version: 4.0
[0m12:29:21.743992 [info ] [MainThread]:   security_configuration: None
[0m12:29:21.745200 [info ] [MainThread]:   connections: None
[0m12:29:21.746478 [info ] [MainThread]:   conf: None
[0m12:29:21.747303 [info ] [MainThread]:   extra_py_files: None
[0m12:29:21.748373 [info ] [MainThread]:   delta_athena_prefix: None
[0m12:29:21.749659 [info ] [MainThread]:   tags: None
[0m12:29:21.750826 [info ] [MainThread]:   seed_format: parquet
[0m12:29:21.752067 [info ] [MainThread]:   seed_mode: overwrite
[0m12:29:21.753280 [info ] [MainThread]:   default_arguments: None
[0m12:29:21.754298 [info ] [MainThread]:   iceberg_glue_commit_lock_table: myGlueLockTable
[0m12:29:21.755002 [info ] [MainThread]:   glue_session_id: None
[0m12:29:21.757557 [info ] [MainThread]:   glue_session_reuse: False
[0m12:29:21.759614 [info ] [MainThread]:   datalake_formats: None
[0m12:29:21.761342 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:29:21.816346 [debug] [MainThread]: Acquiring new glue connection 'debug'
[0m12:29:21.817584 [debug] [MainThread]: Using glue connection "debug"
[0m12:29:21.818098 [debug] [MainThread]: On debug: select 1 as id
[0m12:29:21.818518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:21.818990 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2447, 140704535110464)
[0m12:29:21.819426 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:29:21.819805 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:29:21.820181 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:29:22.761559 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:23.915504 [debug] [MainThread]: Glue adapter: [elapsed 1.152204990386963s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:25.061851 [debug] [MainThread]: Glue adapter: [elapsed 2.299926996231079s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:26.196499 [debug] [MainThread]: Glue adapter: [elapsed 3.438359022140503s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:27.337739 [debug] [MainThread]: Glue adapter: [elapsed 4.582034111022949s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:28.476647 [debug] [MainThread]: Glue adapter: [elapsed 5.718107223510742s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:30.445469 [debug] [MainThread]: Glue adapter: [elapsed 7.693885087966919s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:31.588566 [debug] [MainThread]: Glue adapter: [elapsed 8.828695058822632s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:32.726797 [debug] [MainThread]: Glue adapter: [elapsed 9.969136238098145s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:33.865511 [debug] [MainThread]: Glue adapter: [elapsed 11.107691049575806s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:34.997088 [debug] [MainThread]: Glue adapter: [elapsed 12.243250846862793s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:36.151935 [debug] [MainThread]: Glue adapter: [elapsed 13.392645120620728s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:37.300415 [debug] [MainThread]: Glue adapter: [elapsed 14.546905994415283s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:38.429631 [debug] [MainThread]: Glue adapter: [elapsed 15.675391912460327s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:39.564742 [debug] [MainThread]: Glue adapter: [elapsed 16.807802200317383s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:40.700872 [debug] [MainThread]: Glue adapter: [elapsed 17.947856187820435s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:41.895103 [debug] [MainThread]: Glue adapter: [elapsed 19.079044103622437s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in PROVISIONING state
[0m12:29:43.044254 [debug] [MainThread]: Glue adapter: [elapsed 20.284752130508423s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in READY state
[0m12:29:43.113186 [debug] [MainThread]: Glue adapter: GlueConnection _init_session called
[0m12:29:43.113997 [debug] [MainThread]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86
[0m12:29:53.548726 [debug] [MainThread]: Glue adapter: GlueCursor execute called
[0m12:29:53.549612 [debug] [MainThread]: Glue adapter: GlueCursor remove_comments_header called
[0m12:29:53.550304 [debug] [MainThread]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:29:53.551067 [debug] [MainThread]: Glue adapter: client : SqlWrapper2.execute('''select 1 as id''')
[0m12:29:59.544204 [debug] [MainThread]: Glue adapter: {'Statement': {'Id': 2, 'Code': "SqlWrapper2.execute('''select 1 as id''')", 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"id": 1}}], "description": [{"name": "id", "type": "IntegerType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694276993684, 'CompletedOn': 1694276998783}, 'ResponseMetadata': {'RequestId': 'cc999a6d-0aea-46a4-bb02-9bf6799cb9fe', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:29:59 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '400', 'connection': 'keep-alive', 'x-amzn-requestid': 'cc999a6d-0aea-46a4-bb02-9bf6799cb9fe'}, 'RetryAttempts': 0}}
[0m12:29:59.544873 [debug] [MainThread]: Glue adapter: status = ok
[0m12:29:59.545361 [debug] [MainThread]: Glue adapter: GlueCursor execute successfully
[0m12:29:59.545854 [debug] [MainThread]: SQL status: OK in 38.0 seconds
[0m12:29:59.547438 [debug] [MainThread]: On debug: Close
[0m12:29:59.547934 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:29:59.548549 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:29:59.549163 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:29:59.555581 [debug] [MainThread]: Command `dbt debug` succeeded at 12:29:59.550070 after 38.37 seconds
[0m12:29:59.556437 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:29:59.557068 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:29:59.694434 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in READY state
[0m12:30:01.040596 [debug] [MainThread]: Glue adapter: [elapsed 1.3393630981445312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:02.226829 [debug] [MainThread]: Glue adapter: [elapsed 2.5352859497070312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:03.442364 [debug] [MainThread]: Glue adapter: [elapsed 3.7458629608154297s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:05.234491 [debug] [MainThread]: Glue adapter: [elapsed 5.53955602645874s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:06.454141 [debug] [MainThread]: Glue adapter: [elapsed 6.745457172393799s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:07.661358 [debug] [MainThread]: Glue adapter: [elapsed 7.973970890045166s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:08.855034 [debug] [MainThread]: Glue adapter: [elapsed 9.1700599193573s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:10.115861 [debug] [MainThread]: Glue adapter: [elapsed 10.378661155700684s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:11.342087 [debug] [MainThread]: Glue adapter: [elapsed 11.644068002700806s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:12.551157 [debug] [MainThread]: Glue adapter: [elapsed 12.854930877685547s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:13.774499 [debug] [MainThread]: Glue adapter: [elapsed 14.061244010925293s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:14.994789 [debug] [MainThread]: Glue adapter: [elapsed 15.289747953414917s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:16.194354 [debug] [MainThread]: Glue adapter: [elapsed 16.504346132278442s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:17.405799 [debug] [MainThread]: Glue adapter: [elapsed 17.702727794647217s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:19.098064 [debug] [MainThread]: Glue adapter: [elapsed 19.405275106430054s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:20.478601 [debug] [MainThread]: Glue adapter: [elapsed 20.607582807540894s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:21.704535 [debug] [MainThread]: Glue adapter: [elapsed 22.00443696975708s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:22.919010 [debug] [MainThread]: Glue adapter: [elapsed 23.225122928619385s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:24.109461 [debug] [MainThread]: Glue adapter: [elapsed 24.436811923980713s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:25.313116 [debug] [MainThread]: Glue adapter: [elapsed 25.62431001663208s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:26.510587 [debug] [MainThread]: Glue adapter: [elapsed 26.819452047348022s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:27.708792 [debug] [MainThread]: Glue adapter: [elapsed 28.019461154937744s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:28.919907 [debug] [MainThread]: Glue adapter: [elapsed 29.227565050125122s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:30.143327 [debug] [MainThread]: Glue adapter: [elapsed 30.432265996932983s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:31.373563 [debug] [MainThread]: Glue adapter: [elapsed 31.68131709098816s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:32.544918 [debug] [MainThread]: Glue adapter: [elapsed 32.87179493904114s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:33.797238 [debug] [MainThread]: Glue adapter: [elapsed 34.064000844955444s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:35.002268 [debug] [MainThread]: Glue adapter: [elapsed 35.30248498916626s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:36.212497 [debug] [MainThread]: Glue adapter: [elapsed 36.515522956848145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:37.437226 [debug] [MainThread]: Glue adapter: [elapsed 37.74010491371155s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:38.662012 [debug] [MainThread]: Glue adapter: [elapsed 38.95146584510803s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:39.905991 [debug] [MainThread]: Glue adapter: [elapsed 40.18355989456177s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:41.113545 [debug] [MainThread]: Glue adapter: [elapsed 41.418511152267456s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:42.324713 [debug] [MainThread]: Glue adapter: [elapsed 42.634702920913696s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d938157e-e496-4c5c-bd9d-5c6e53ceee86 in STOPPING state
[0m12:30:43.496840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedde7c37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede1327c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fede1a14130>]}
[0m12:30:43.497923 [debug] [MainThread]: Flushing usage events
[0m12:30:50.702530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5187d0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe516596640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51b333df0>]}


============================== 12:30:50.708765 | 3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3 ==============================
[0m12:30:50.708765 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:30:50.709572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:51.145961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe516596640>]}
[0m12:30:51.170246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ba210a0>]}
[0m12:30:51.171713 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:30:51.206197 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:30:51.221702 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:30:51.222317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ba38c40>]}
[0m12:30:52.618033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51bdf10d0>]}
[0m12:30:52.635496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51ba21f70>]}
[0m12:30:52.636229 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:30:52.636725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51a0aec70>]}
[0m12:30:52.638563 [info ] [MainThread]: 
[0m12:30:52.640095 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:30:52.641613 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:30:52.642152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:52.642581 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (2488, 123145334890496)
[0m12:30:52.643077 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:30:52.643791 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:30:52.645502 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:30:53.540229 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:30:53.541068 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:30:53.543460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:30:53.544163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:53.717930 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:30:53.718806 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:30:53.720190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51d6b2fd0>]}
[0m12:30:53.720990 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:30:53.721563 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:30:53.722621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:53.723221 [info ] [MainThread]: 
[0m12:30:53.733307 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:30:53.734300 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m12:30:53.736051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m12:30:53.737217 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:30:53.819301 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:30:53.820428 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 12:30:53.738452 => 12:30:53.820132
[0m12:30:53.820951 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:30:53.838222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:30:54.074670 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:30:54.273031 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:30:54.274897 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:30:54.275478 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:30:54.406148 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:30:55.528377 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1334810256958008s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:30:56.677702 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.268764019012451s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:30:57.815169 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4187960624694824s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:30:58.955846 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.556219100952148s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:00.096950 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.69661021232605s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:01.230753 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.837418079376221s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:02.399845 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.002747058868408s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:03.531560 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.133038997650146s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:04.658062 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.268930196762085s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:05.800902 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.40512490272522s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:06.948114 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.548821210861206s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:08.073626 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.675243139266968s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in PROVISIONING state
[0m12:31:09.206627 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.819035053253174s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in READY state
[0m12:31:09.281299 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:31:09.282221 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050
[0m12:31:17.005302 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:31:17.006253 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:31:17.007025 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:31:17.007735 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m12:31:21.308117 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277077123, 'CompletedOn': 1694277080324}, 'ResponseMetadata': {'RequestId': '0f6dff21-662c-4a04-bb34-b7f5c1b26cd6', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:31:21 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '0f6dff21-662c-4a04-bb34-b7f5c1b26cd6'}, 'RetryAttempts': 0}}
[0m12:31:21.309175 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:31:21.310047 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:31:21.310967 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277077123, 'CompletedOn': 1694277080324}, 'ResponseMetadata': {'RequestId': '0f6dff21-662c-4a04-bb34-b7f5c1b26cd6', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:31:21 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '0f6dff21-662c-4a04-bb34-b7f5c1b26cd6'}, 'RetryAttempts': 0}}
[0m12:31:21.312012 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:31:21.312840 [debug] [Thread-1  ]: SQL status: OK in 27.0 seconds
[0m12:31:21.352052 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:31:21.352976 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:31:21.353437 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:31:21.353911 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m12:31:21.412760 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:31:21.413673 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050
[0m12:31:23.264711 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:31:23.265659 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:31:23.266475 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:31:23.267396 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  ''')
[0m12:31:24.629377 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year\n    , month \n    , payment_type as type\n    FROM nyctaxi.tripdata\n    WHERE year = "2022"\n    AND dropoff_datetime is not null \n    GROUP BY 5, 6, 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]\n         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]\n         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277083381, 'CompletedOn': 1694277084559}, 'ResponseMetadata': {'RequestId': '45436337-dd28-4791-b956-14bf84e4516c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:31:24 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3522', 'connection': 'keep-alive', 'x-amzn-requestid': '45436337-dd28-4791-b956-14bf84e4516c'}, 'RetryAttempts': 0}}
[0m12:31:24.630598 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:31:24.631528 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]
         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]

[0m12:31:24.632753 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]
         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]

[0m12:31:24.634208 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year
    , month 
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m12:31:24.635003 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m12:31:24.635671 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:31:24.636299 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m12:31:24.637055 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:31:24.638078 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 12:30:53.821313 => 12:31:24.637713
[0m12:31:24.647858 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      , year
      , month 
      , payment_type as type
      FROM nyctaxi.tripdata
      WHERE year = "2022"
      AND dropoff_datetime is not null 
      GROUP BY 5, 6, 7
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;
  'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias source_avg
        +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]
           +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
              +- SubqueryAlias spark_catalog.nyctaxi.tripdata
                 +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:31:24.648748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ef41fa5-47ef-4c1d-ad50-6702ed16e4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51d732b50>]}
[0m12:31:24.650946 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 30.91s]
[0m12:31:24.652445 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:31:24.654091 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:31:24.654861 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m12:31:24.660699 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:31:24.662785 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:31:24.663805 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m12:31:24.664917 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:31:24.666949 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:31:24.667991 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m12:31:24.669123 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:31:24.671523 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:24.672330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:24.674300 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2488, 140704535110464)
[0m12:31:24.676691 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:31:24.677606 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:31:24.678700 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:31:25.302793 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:31:25.303684 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:31:25.304373 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:31:25.305022 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:25.305569 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:31:25.306093 [debug] [MainThread]: On master: Close
[0m12:31:25.306633 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:31:25.307745 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:31:25.308301 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:31:25.435689 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in READY state
[0m12:31:26.840100 [debug] [MainThread]: Glue adapter: [elapsed 1.4053270816802979s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:28.050455 [debug] [MainThread]: Glue adapter: [elapsed 2.610563039779663s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:29.244607 [debug] [MainThread]: Glue adapter: [elapsed 3.8048200607299805s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:30.430911 [debug] [MainThread]: Glue adapter: [elapsed 4.999167203903198s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:31.637774 [debug] [MainThread]: Glue adapter: [elapsed 6.195967197418213s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:32.825261 [debug] [MainThread]: Glue adapter: [elapsed 7.3901989459991455s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:34.026504 [debug] [MainThread]: Glue adapter: [elapsed 8.587057113647461s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:35.214599 [debug] [MainThread]: Glue adapter: [elapsed 9.785818099975586s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:36.406945 [debug] [MainThread]: Glue adapter: [elapsed 10.971814155578613s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:37.607151 [debug] [MainThread]: Glue adapter: [elapsed 12.17244291305542s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:38.796693 [debug] [MainThread]: Glue adapter: [elapsed 13.371237993240356s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:39.993605 [debug] [MainThread]: Glue adapter: [elapsed 14.560034036636353s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:41.197904 [debug] [MainThread]: Glue adapter: [elapsed 15.74573802947998s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:42.378154 [debug] [MainThread]: Glue adapter: [elapsed 16.945605993270874s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:43.578918 [debug] [MainThread]: Glue adapter: [elapsed 18.140256881713867s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:44.776509 [debug] [MainThread]: Glue adapter: [elapsed 19.33993697166443s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:45.982150 [debug] [MainThread]: Glue adapter: [elapsed 20.54030704498291s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:47.184811 [debug] [MainThread]: Glue adapter: [elapsed 21.740382194519043s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:48.377146 [debug] [MainThread]: Glue adapter: [elapsed 22.95414113998413s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:49.576395 [debug] [MainThread]: Glue adapter: [elapsed 24.140516996383667s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:50.773192 [debug] [MainThread]: Glue adapter: [elapsed 25.33035111427307s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:51.955023 [debug] [MainThread]: Glue adapter: [elapsed 26.519804000854492s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:53.137017 [debug] [MainThread]: Glue adapter: [elapsed 27.716243028640747s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:54.335113 [debug] [MainThread]: Glue adapter: [elapsed 28.899034023284912s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:55.536716 [debug] [MainThread]: Glue adapter: [elapsed 30.094722032546997s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:56.828967 [debug] [MainThread]: Glue adapter: [elapsed 31.3043270111084s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:58.015521 [debug] [MainThread]: Glue adapter: [elapsed 32.573575019836426s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:31:59.209685 [debug] [MainThread]: Glue adapter: [elapsed 33.77450203895569s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:00.395033 [debug] [MainThread]: Glue adapter: [elapsed 34.97095322608948s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:01.586511 [debug] [MainThread]: Glue adapter: [elapsed 36.15442085266113s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:02.801918 [debug] [MainThread]: Glue adapter: [elapsed 37.35427117347717s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:04.215375 [debug] [MainThread]: Glue adapter: [elapsed 38.56444501876831s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:05.446173 [debug] [MainThread]: Glue adapter: [elapsed 39.970954179763794s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:06.642799 [debug] [MainThread]: Glue adapter: [elapsed 41.193365812301636s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:07.831944 [debug] [MainThread]: Glue adapter: [elapsed 42.400388956069946s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-ec37882b-0d9b-4feb-8ed2-07546e284050 in STOPPING state
[0m12:32:08.968173 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:32:09.099266 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in READY state
[0m12:32:10.479680 [debug] [MainThread]: Glue adapter: [elapsed 1.370269775390625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:11.702048 [debug] [MainThread]: Glue adapter: [elapsed 2.5874810218811035s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:12.914144 [debug] [MainThread]: Glue adapter: [elapsed 3.8089349269866943s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:14.102350 [debug] [MainThread]: Glue adapter: [elapsed 5.014981746673584s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:15.350563 [debug] [MainThread]: Glue adapter: [elapsed 6.2445387840271s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:16.587875 [debug] [MainThread]: Glue adapter: [elapsed 7.4444739818573s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:17.797242 [debug] [MainThread]: Glue adapter: [elapsed 8.692714929580688s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:18.978633 [debug] [MainThread]: Glue adapter: [elapsed 9.900285959243774s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:20.195618 [debug] [MainThread]: Glue adapter: [elapsed 11.080988883972168s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:21.398777 [debug] [MainThread]: Glue adapter: [elapsed 12.29258394241333s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:22.649131 [debug] [MainThread]: Glue adapter: [elapsed 13.53983998298645s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:23.850416 [debug] [MainThread]: Glue adapter: [elapsed 14.752086877822876s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:25.052530 [debug] [MainThread]: Glue adapter: [elapsed 15.944772005081177s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:26.260551 [debug] [MainThread]: Glue adapter: [elapsed 17.14668369293213s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:27.471673 [debug] [MainThread]: Glue adapter: [elapsed 18.35719895362854s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:28.665233 [debug] [MainThread]: Glue adapter: [elapsed 19.574785947799683s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:29.880095 [debug] [MainThread]: Glue adapter: [elapsed 20.77367901802063s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:31.089639 [debug] [MainThread]: Glue adapter: [elapsed 21.977547883987427s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:32.293947 [debug] [MainThread]: Glue adapter: [elapsed 23.190693855285645s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:33.507181 [debug] [MainThread]: Glue adapter: [elapsed 24.39609384536743s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:34.702348 [debug] [MainThread]: Glue adapter: [elapsed 25.59878897666931s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:35.901326 [debug] [MainThread]: Glue adapter: [elapsed 26.80454969406128s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:37.107110 [debug] [MainThread]: Glue adapter: [elapsed 28.00180196762085s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:38.354142 [debug] [MainThread]: Glue adapter: [elapsed 29.252613067626953s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:39.553347 [debug] [MainThread]: Glue adapter: [elapsed 30.447427988052368s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:40.751575 [debug] [MainThread]: Glue adapter: [elapsed 31.656516075134277s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:41.949865 [debug] [MainThread]: Glue adapter: [elapsed 32.851988792419434s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:43.193228 [debug] [MainThread]: Glue adapter: [elapsed 34.05374097824097s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:44.580629 [debug] [MainThread]: Glue adapter: [elapsed 35.46948504447937s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:45.794302 [debug] [MainThread]: Glue adapter: [elapsed 36.68148493766785s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:47.196227 [debug] [MainThread]: Glue adapter: [elapsed 37.9066858291626s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:48.410253 [debug] [MainThread]: Glue adapter: [elapsed 39.30084300041199s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:49.618589 [debug] [MainThread]: Glue adapter: [elapsed 40.50923490524292s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:50.840858 [debug] [MainThread]: Glue adapter: [elapsed 41.731597900390625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:52.051059 [debug] [MainThread]: Glue adapter: [elapsed 42.94389605522156s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:53.268366 [debug] [MainThread]: Glue adapter: [elapsed 44.15867781639099s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:54.477859 [debug] [MainThread]: Glue adapter: [elapsed 45.37755489349365s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:55.687898 [debug] [MainThread]: Glue adapter: [elapsed 46.572410106658936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-baf307b3-36e1-492b-89b0-23d5b4bfdd6f in STOPPING state
[0m12:32:56.868433 [info ] [MainThread]: 
[0m12:32:56.869466 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 4.23 seconds (124.23s).
[0m12:32:56.873931 [debug] [MainThread]: Command end result
[0m12:32:56.901827 [info ] [MainThread]: 
[0m12:32:56.902487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:32:56.903177 [info ] [MainThread]: 
[0m12:32:56.904022 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m12:32:56.905011 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m12:32:56.905856 [error] [MainThread]:   
[0m12:32:56.906622 [error] [MainThread]:     
[0m12:32:56.907600 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:32:56.908299 [error] [MainThread]:     using PARQUET
[0m12:32:56.909149 [error] [MainThread]:   	
[0m12:32:56.909934 [error] [MainThread]:   	
[0m12:32:56.910695 [error] [MainThread]:   	
[0m12:32:56.912005 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m12:32:56.915764 [error] [MainThread]:   	
[0m12:32:56.917189 [error] [MainThread]:   	as
[0m12:32:56.918002 [error] [MainThread]:   	WITH source_avg as ( 
[0m12:32:56.920006 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m12:32:56.920930 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m12:32:56.922314 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m12:32:56.923054 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m12:32:56.923682 [error] [MainThread]:       , year
[0m12:32:56.924300 [error] [MainThread]:       , month 
[0m12:32:56.924929 [error] [MainThread]:       , payment_type as type
[0m12:32:56.925407 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m12:32:56.926321 [error] [MainThread]:       WHERE year = "2022"
[0m12:32:56.927187 [error] [MainThread]:       AND dropoff_datetime is not null 
[0m12:32:56.928176 [error] [MainThread]:       GROUP BY 5, 6, 7
[0m12:32:56.928934 [error] [MainThread]:   ) 
[0m12:32:56.929997 [error] [MainThread]:   SELECT *
[0m12:32:56.932046 [error] [MainThread]:   FROM source_avg
[0m12:32:56.934080 [error] [MainThread]:     '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.]; line 21 pos 10;
[0m12:32:56.934777 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
[0m12:32:56.936543 [error] [MainThread]:   +- 'Project [*]
[0m12:32:56.937516 [error] [MainThread]:      +- 'SubqueryAlias source_avg
[0m12:32:56.944703 [error] [MainThread]:         +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'year, 'month, 'payment_type AS type#9]
[0m12:32:56.945648 [error] [MainThread]:            +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
[0m12:32:56.947016 [error] [MainThread]:               +- SubqueryAlias spark_catalog.nyctaxi.tripdata
[0m12:32:56.947719 [error] [MainThread]:                  +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.OpenCSVSerde, Data Cols: [#10], Partition Cols: []]
[0m12:32:56.948393 [error] [MainThread]:   
[0m12:32:56.949039 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:32:56.951501 [info ] [MainThread]: 
[0m12:32:56.952899 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m12:32:56.955177 [debug] [MainThread]: Command `dbt run` failed at 12:32:56.954541 after 126.28 seconds
[0m12:32:56.956626 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:32:56.958507 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:32:57.109682 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:32:57.182990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5187d0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51d694100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51d743580>]}
[0m12:32:57.183920 [debug] [MainThread]: Flushing usage events
[0m12:38:06.530881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b30794e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2eca7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33374d30>]}


============================== 12:38:06.537926 | 93365b6f-5eef-4899-9225-2bab204e2940 ==============================
[0m12:38:06.537926 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:38:06.538949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:06.977824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b2eca7a30>]}
[0m12:38:07.000759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33a67fa0>]}
[0m12:38:07.001893 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:38:07.037076 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:38:07.138773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:38:07.139645 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/schema.yml
[0m12:38:07.140097 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:38:07.235715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33cfc0d0>]}
[0m12:38:07.253403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33c70dc0>]}
[0m12:38:07.254194 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:38:07.254834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33cb1f70>]}
[0m12:38:07.257327 [info ] [MainThread]: 
[0m12:38:07.258429 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:38:07.259981 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:38:07.260537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:07.261155 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (2639, 123145403351040)
[0m12:38:07.261642 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:38:07.262080 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:38:07.262515 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:38:08.315507 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:38:08.316098 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:38:08.318134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:38:08.318653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:08.492403 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:38:08.493253 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:38:08.494573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33c7b580>]}
[0m12:38:08.495375 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:38:08.495940 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:38:08.497034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:08.497642 [info ] [MainThread]: 
[0m12:38:08.511155 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:38:08.512197 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m12:38:08.513286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m12:38:08.513808 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:38:08.523781 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:38:08.525191 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 12:38:08.514144 => 12:38:08.524659
[0m12:38:08.526056 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:38:08.555844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:08.751535 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:38:08.964686 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:38:08.966902 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:38:08.967601 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:38:09.109567 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:10.257941 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1481070518493652s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:11.398066 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.2793781757354736s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:12.534707 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4263410568237305s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:13.678984 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.557322978973389s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:14.820859 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.710891962051392s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:15.956226 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.84816312789917s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:17.095797 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.984270095825195s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:18.224187 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.112437963485718s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:19.361224 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.24858808517456s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:20.494372 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.381685972213745s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:21.627519 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.51790714263916s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:22.770860 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.657766103744507s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:23.905634 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.794824123382568s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:25.036999 [debug] [Thread-1  ]: Glue adapter: [elapsed 15.926377296447754s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:26.170419 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.058950185775757s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:27.308367 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.194472312927246s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in PROVISIONING state
[0m12:38:28.447387 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.33088207244873s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in READY state
[0m12:38:28.515501 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:38:28.516418 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe
[0m12:38:38.431840 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:38:38.438506 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:38:38.439784 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:38:38.440745 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m12:38:43.583142 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277518553, 'CompletedOn': 1694277522687}, 'ResponseMetadata': {'RequestId': 'fa485c91-cfbe-4d1e-9959-6fe8ac14f154', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:38:43 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'fa485c91-cfbe-4d1e-9959-6fe8ac14f154'}, 'RetryAttempts': 0}}
[0m12:38:43.584002 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:38:43.584560 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:38:43.585128 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277518553, 'CompletedOn': 1694277522687}, 'ResponseMetadata': {'RequestId': 'fa485c91-cfbe-4d1e-9959-6fe8ac14f154', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:38:43 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'fa485c91-cfbe-4d1e-9959-6fe8ac14f154'}, 'RetryAttempts': 0}}
[0m12:38:43.585695 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:38:43.586467 [debug] [Thread-1  ]: SQL status: OK in 35.0 seconds
[0m12:38:43.639054 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:38:43.644878 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:38:43.645672 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:38:43.646355 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m12:38:43.710437 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:38:43.711389 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe
[0m12:38:45.315679 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:38:45.316631 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:38:45.317446 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:38:45.318360 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  ''')
[0m12:38:46.860815 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    --, year\n    --, month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    WHERE year = "2022"\n    AND dropoff_datetime is not null \n    GROUP BY 5, 6, 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]\n         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]\n         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277525445, 'CompletedOn': 1694277526544}, 'ResponseMetadata': {'RequestId': 'f8d5af2c-a8a9-4c2e-b415-da0cba8fbaac', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:38:46 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '5301', 'connection': 'keep-alive', 'x-amzn-requestid': 'f8d5af2c-a8a9-4c2e-b415-da0cba8fbaac'}, 'RetryAttempts': 0}}
[0m12:38:46.862172 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:38:46.863214 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]

[0m12:38:46.868048 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
         +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]

[0m12:38:46.869522 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    WHERE year = "2022"
    AND dropoff_datetime is not null 
    GROUP BY 5, 6, 7
) 
SELECT *
FROM source_avg
  
[0m12:38:46.870260 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m12:38:46.870874 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:38:46.871436 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m12:38:46.872026 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:38:46.873176 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 12:38:08.526779 => 12:38:46.872676
[0m12:38:46.889347 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      --, year
      --, month
      , payment_type as type
      FROM nyctaxi.tripdata
      WHERE year = "2022"
      AND dropoff_datetime is not null 
      GROUP BY 5, 6, 7
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;
  'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias source_avg
        +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
           +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
              +- SubqueryAlias spark_catalog.nyctaxi.tripdata
                 +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:38:46.890870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93365b6f-5eef-4899-9225-2bab204e2940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b35e5d0a0>]}
[0m12:38:46.892644 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 38.38s]
[0m12:38:46.894300 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:38:46.899258 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:38:46.900153 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m12:38:46.901157 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:38:46.901973 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:38:46.902709 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m12:38:46.903603 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:38:46.904523 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:38:46.905434 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m12:38:46.906427 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:38:46.909277 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:46.910028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:46.910808 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2639, 140704535110464)
[0m12:38:46.911527 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:38:46.912097 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:38:46.912527 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:38:47.580388 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:38:47.581291 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:38:47.581977 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:38:47.582622 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:47.583165 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:38:47.583686 [debug] [MainThread]: On master: Close
[0m12:38:47.584224 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:38:47.585306 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:38:47.585876 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:38:47.711729 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in READY state
[0m12:38:49.123684 [debug] [MainThread]: Glue adapter: [elapsed 1.4056892395019531s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:50.317577 [debug] [MainThread]: Glue adapter: [elapsed 2.601586103439331s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:51.518048 [debug] [MainThread]: Glue adapter: [elapsed 3.8031740188598633s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:52.720143 [debug] [MainThread]: Glue adapter: [elapsed 5.002367973327637s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:53.921593 [debug] [MainThread]: Glue adapter: [elapsed 6.203206300735474s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:55.123744 [debug] [MainThread]: Glue adapter: [elapsed 7.407749176025391s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:56.326917 [debug] [MainThread]: Glue adapter: [elapsed 8.605034112930298s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:57.769445 [debug] [MainThread]: Glue adapter: [elapsed 9.82146406173706s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:38:58.984481 [debug] [MainThread]: Glue adapter: [elapsed 11.249922037124634s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:00.190304 [debug] [MainThread]: Glue adapter: [elapsed 12.471476078033447s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:01.423965 [debug] [MainThread]: Glue adapter: [elapsed 13.686822891235352s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:02.643239 [debug] [MainThread]: Glue adapter: [elapsed 14.909508228302002s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:03.854541 [debug] [MainThread]: Glue adapter: [elapsed 16.127443075180054s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:05.056831 [debug] [MainThread]: Glue adapter: [elapsed 17.33390712738037s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:06.267077 [debug] [MainThread]: Glue adapter: [elapsed 18.545520305633545s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:07.460893 [debug] [MainThread]: Glue adapter: [elapsed 19.738661289215088s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:08.642152 [debug] [MainThread]: Glue adapter: [elapsed 20.928186178207397s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:09.837543 [debug] [MainThread]: Glue adapter: [elapsed 22.10460591316223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:11.038495 [debug] [MainThread]: Glue adapter: [elapsed 23.32167100906372s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:12.565447 [debug] [MainThread]: Glue adapter: [elapsed 24.521647214889526s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:13.776810 [debug] [MainThread]: Glue adapter: [elapsed 26.043965101242065s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:14.950390 [debug] [MainThread]: Glue adapter: [elapsed 27.24571704864502s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:16.138138 [debug] [MainThread]: Glue adapter: [elapsed 28.435854196548462s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:17.356334 [debug] [MainThread]: Glue adapter: [elapsed 29.61849617958069s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:18.554453 [debug] [MainThread]: Glue adapter: [elapsed 30.838293075561523s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:19.748734 [debug] [MainThread]: Glue adapter: [elapsed 32.030906200408936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:20.947237 [debug] [MainThread]: Glue adapter: [elapsed 33.225558042526245s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:22.127329 [debug] [MainThread]: Glue adapter: [elapsed 34.42673707008362s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:23.336986 [debug] [MainThread]: Glue adapter: [elapsed 35.60531830787659s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:24.544317 [debug] [MainThread]: Glue adapter: [elapsed 36.81560707092285s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:25.745991 [debug] [MainThread]: Glue adapter: [elapsed 38.031368017196655s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:26.967845 [debug] [MainThread]: Glue adapter: [elapsed 39.24712085723877s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:28.155293 [debug] [MainThread]: Glue adapter: [elapsed 40.449443101882935s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-da56f246-34cd-483a-b57d-6f6f9cb5a3fe in STOPPING state
[0m12:39:29.297485 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:39:29.426287 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in READY state
[0m12:39:30.739355 [debug] [MainThread]: Glue adapter: [elapsed 1.2963991165161133s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:31.928106 [debug] [MainThread]: Glue adapter: [elapsed 2.497666120529175s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:33.128283 [debug] [MainThread]: Glue adapter: [elapsed 3.6932191848754883s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:34.330543 [debug] [MainThread]: Glue adapter: [elapsed 4.898224115371704s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:35.531779 [debug] [MainThread]: Glue adapter: [elapsed 6.101657152175903s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:36.736285 [debug] [MainThread]: Glue adapter: [elapsed 7.3055243492126465s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:38.151289 [debug] [MainThread]: Glue adapter: [elapsed 8.742357969284058s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:39.339601 [debug] [MainThread]: Glue adapter: [elapsed 9.915446996688843s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:40.554512 [debug] [MainThread]: Glue adapter: [elapsed 11.110382080078125s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:41.740869 [debug] [MainThread]: Glue adapter: [elapsed 12.322587251663208s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:42.941373 [debug] [MainThread]: Glue adapter: [elapsed 13.509456157684326s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:44.145569 [debug] [MainThread]: Glue adapter: [elapsed 14.715879201889038s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:45.329391 [debug] [MainThread]: Glue adapter: [elapsed 15.902546167373657s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:46.523386 [debug] [MainThread]: Glue adapter: [elapsed 17.098634004592896s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:47.738865 [debug] [MainThread]: Glue adapter: [elapsed 18.3106369972229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:48.917406 [debug] [MainThread]: Glue adapter: [elapsed 19.494359016418457s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:50.131651 [debug] [MainThread]: Glue adapter: [elapsed 20.685840129852295s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:51.333705 [debug] [MainThread]: Glue adapter: [elapsed 21.905094146728516s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:52.525394 [debug] [MainThread]: Glue adapter: [elapsed 23.092875957489014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:53.717594 [debug] [MainThread]: Glue adapter: [elapsed 24.29276204109192s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:54.918003 [debug] [MainThread]: Glue adapter: [elapsed 25.494243144989014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:56.117343 [debug] [MainThread]: Glue adapter: [elapsed 26.69313931465149s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:57.315707 [debug] [MainThread]: Glue adapter: [elapsed 27.878729343414307s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:58.529237 [debug] [MainThread]: Glue adapter: [elapsed 29.09696316719055s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:39:59.752992 [debug] [MainThread]: Glue adapter: [elapsed 30.310875177383423s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:01.005480 [debug] [MainThread]: Glue adapter: [elapsed 31.545582056045532s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:02.216012 [debug] [MainThread]: Glue adapter: [elapsed 32.78127408027649s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:03.457361 [debug] [MainThread]: Glue adapter: [elapsed 34.00294232368469s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:05.341861 [debug] [MainThread]: Glue adapter: [elapsed 35.87669515609741s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:06.555688 [debug] [MainThread]: Glue adapter: [elapsed 37.11773610115051s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:07.753863 [debug] [MainThread]: Glue adapter: [elapsed 38.33605408668518s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-196aedde-1143-4589-a1ed-00846642ecfc in STOPPING state
[0m12:40:08.903090 [info ] [MainThread]: 
[0m12:40:08.904193 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 1.64 seconds (121.64s).
[0m12:40:08.906322 [debug] [MainThread]: Command end result
[0m12:40:08.928251 [info ] [MainThread]: 
[0m12:40:08.929296 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:08.930362 [info ] [MainThread]: 
[0m12:40:08.932492 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m12:40:08.933380 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m12:40:08.934724 [error] [MainThread]:   
[0m12:40:08.935706 [error] [MainThread]:     
[0m12:40:08.936196 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:40:08.936718 [error] [MainThread]:     using PARQUET
[0m12:40:08.937167 [error] [MainThread]:   	
[0m12:40:08.937629 [error] [MainThread]:   	
[0m12:40:08.938066 [error] [MainThread]:   	
[0m12:40:08.938498 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m12:40:08.938927 [error] [MainThread]:   	
[0m12:40:08.939384 [error] [MainThread]:   	as
[0m12:40:08.939841 [error] [MainThread]:   	WITH source_avg as ( 
[0m12:40:08.940408 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m12:40:08.941166 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m12:40:08.941908 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m12:40:08.942609 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m12:40:08.943130 [error] [MainThread]:       --, year
[0m12:40:08.943700 [error] [MainThread]:       --, month
[0m12:40:08.944127 [error] [MainThread]:       , payment_type as type
[0m12:40:08.944522 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m12:40:08.944936 [error] [MainThread]:       WHERE year = "2022"
[0m12:40:08.945507 [error] [MainThread]:       AND dropoff_datetime is not null 
[0m12:40:08.946093 [error] [MainThread]:       GROUP BY 5, 6, 7
[0m12:40:08.946635 [error] [MainThread]:   ) 
[0m12:40:08.947245 [error] [MainThread]:   SELECT *
[0m12:40:08.947704 [error] [MainThread]:   FROM source_avg
[0m12:40:08.948158 [error] [MainThread]:     '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.improvement_surcharge, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime]; line 21 pos 10;
[0m12:40:08.948690 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
[0m12:40:08.949382 [error] [MainThread]:   +- 'Project [*]
[0m12:40:08.950225 [error] [MainThread]:      +- 'SubqueryAlias source_avg
[0m12:40:08.951059 [error] [MainThread]:         +- 'Aggregate [unresolvedordinal(5), unresolvedordinal(6), unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
[0m12:40:08.951853 [error] [MainThread]:            +- 'Filter (('year = 2022) AND isnotnull('dropoff_datetime))
[0m12:40:08.952552 [error] [MainThread]:               +- SubqueryAlias spark_catalog.nyctaxi.tripdata
[0m12:40:08.953265 [error] [MainThread]:                  +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]
[0m12:40:08.953965 [error] [MainThread]:   
[0m12:40:08.954671 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:40:08.955487 [info ] [MainThread]: 
[0m12:40:08.956556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m12:40:08.959903 [debug] [MainThread]: Command `dbt run` failed at 12:40:08.959593 after 122.46 seconds
[0m12:40:08.960957 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:40:08.962535 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:40:09.035806 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:40:09.093065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b30794e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b33c70f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b35e674f0>]}
[0m12:40:09.094068 [debug] [MainThread]: Flushing usage events
[0m12:40:28.528269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a0f83700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3b75ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a3b75e80>]}


============================== 12:40:28.535000 | b7c93bab-d343-4cce-9fc0-f01f193c81f7 ==============================
[0m12:40:28.535000 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:40:28.535898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:28.985151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889f5a7af0>]}
[0m12:40:29.009739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a4259f10>]}
[0m12:40:29.011067 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:40:29.040059 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:40:29.149087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:29.149891 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:40:29.230971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a44ff0d0>]}
[0m12:40:29.244862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a447ac10>]}
[0m12:40:29.245438 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:40:29.245893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a447aa30>]}
[0m12:40:29.247622 [info ] [MainThread]: 
[0m12:40:29.248587 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:40:29.250239 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:40:29.250834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:29.251283 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (2700, 123145375563776)
[0m12:40:29.251702 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:40:29.252087 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:40:29.252522 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:40:30.225688 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:40:30.226530 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:40:30.228932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:40:30.229668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:30.456760 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:40:30.457719 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:40:30.459308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a427b5e0>]}
[0m12:40:30.460188 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:40:30.460782 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:40:30.461699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:30.462213 [info ] [MainThread]: 
[0m12:40:30.465358 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:40:30.466180 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m12:40:30.467569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m12:40:30.468428 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:40:30.478397 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:40:30.479344 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 12:40:30.468997 => 12:40:30.479084
[0m12:40:30.479842 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:40:30.503261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:40:30.696563 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:40:31.010268 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:40:31.012064 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:40:31.012626 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:40:31.121609 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:32.248857 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.124683141708374s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:33.398997 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.256762981414795s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:34.542302 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.406083106994629s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:35.693557 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.549231290817261s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:36.833485 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.691806077957153s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:37.972884 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.831060171127319s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:39.110849 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.979522228240967s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:40.246224 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.107022047042847s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:41.401759 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.258981943130493s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:42.533327 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.399487972259521s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:43.674400 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.541943073272705s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:44.820693 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.680742979049683s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in PROVISIONING state
[0m12:40:45.961971 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.822680234909058s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in READY state
[0m12:40:46.032796 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:40:46.033729 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337
[0m12:40:52.719693 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:40:52.720660 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:40:52.721479 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:40:52.722373 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m12:40:57.582731 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277652837, 'CompletedOn': 1694277657250}, 'ResponseMetadata': {'RequestId': 'dcbc94ff-bad1-4e30-9fd8-d621a1ad0fe5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:40:57 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'dcbc94ff-bad1-4e30-9fd8-d621a1ad0fe5'}, 'RetryAttempts': 0}}
[0m12:40:57.583812 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:40:57.584736 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:40:57.585613 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277652837, 'CompletedOn': 1694277657250}, 'ResponseMetadata': {'RequestId': 'dcbc94ff-bad1-4e30-9fd8-d621a1ad0fe5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:40:57 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': 'dcbc94ff-bad1-4e30-9fd8-d621a1ad0fe5'}, 'RetryAttempts': 0}}
[0m12:40:57.586336 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:40:57.587001 [debug] [Thread-1  ]: SQL status: OK in 27.0 seconds
[0m12:40:57.628160 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:40:57.636847 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:40:57.637787 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:40:57.638656 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  
[0m12:40:57.705747 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:40:57.706672 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337
[0m12:40:59.374397 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:40:59.375360 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:40:59.376185 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:40:59.377100 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  ''')
[0m12:41:00.756409 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    --, year\n    --, month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    GROUP BY 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'dropoff_datetime' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.improvement_surcharge]; line 22 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]\n         +- 'Filter isnotnull('dropoff_datetime)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'dropoff_datetime' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.improvement_surcharge]; line 22 pos 10;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]\n         +- 'Filter isnotnull('dropoff_datetime)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277659485, 'CompletedOn': 1694277660343}, 'ResponseMetadata': {'RequestId': '30817bd1-82ee-4450-b4b4-6eb2f7ac7a23', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:41:00 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '5216', 'connection': 'keep-alive', 'x-amzn-requestid': '30817bd1-82ee-4450-b4b4-6eb2f7ac7a23'}, 'RetryAttempts': 0}}
[0m12:41:00.757851 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:41:00.758843 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'dropoff_datetime' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.improvement_surcharge]; line 22 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
         +- 'Filter isnotnull('dropoff_datetime)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]

[0m12:41:00.763037 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: Column 'dropoff_datetime' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.improvement_surcharge]; line 22 pos 10;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
         +- 'Filter isnotnull('dropoff_datetime)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]

[0m12:41:00.764476 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  
[0m12:41:00.765273 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m12:41:00.765821 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:41:00.766333 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m12:41:00.766853 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:41:00.767558 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 12:40:30.480167 => 12:41:00.767274
[0m12:41:00.777656 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      --, year
      --, month
      , payment_type as type
      FROM nyctaxi.tripdata
      --WHERE year = "2022"
      WHERE dropoff_datetime is not null
      --GROUP BY 5, 6, 7
      GROUP BY 7
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: Column 'dropoff_datetime' does not exist. Did you mean one of the following? [spark_catalog.nyctaxi.tripdata.extra, spark_catalog.nyctaxi.tripdata.mta_tax, spark_catalog.nyctaxi.tripdata.tip_amount, spark_catalog.nyctaxi.tripdata.vendorid, spark_catalog.nyctaxi.tripdata.ratecodeid, spark_catalog.nyctaxi.tripdata.fare_amount, spark_catalog.nyctaxi.tripdata.payment_type, spark_catalog.nyctaxi.tripdata.dolocationid, spark_catalog.nyctaxi.tripdata.pulocationid, spark_catalog.nyctaxi.tripdata.tolls_amount, spark_catalog.nyctaxi.tripdata.total_amount, spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime, spark_catalog.nyctaxi.tripdata.trip_distance, spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime, spark_catalog.nyctaxi.tripdata.passenger_count, spark_catalog.nyctaxi.tripdata.congestion_surcharge, spark_catalog.nyctaxi.tripdata.store_and_fwd_flag, spark_catalog.nyctaxi.tripdata.improvement_surcharge]; line 22 pos 10;
  'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias source_avg
        +- 'Aggregate [unresolvedordinal(7)], ['avg(((cast('tpep_dropoff_datetime as bigint) - cast('tpep_pickup_datetime as bigint)) / 60)) AS avg_duration#5, 'avg('passenger_count) AS avg_passenger_count#6, 'avg('trip_distance) AS avg_trip_distance#7, 'avg('total_amount) AS avg_total_amount#8, 'payment_type AS type#9]
           +- 'Filter isnotnull('dropoff_datetime)
              +- SubqueryAlias spark_catalog.nyctaxi.tripdata
                 +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#10L, tpep_pickup_datetime#11, tpep_dropoff_datetime#12, passenger_count#13, trip_distan..., Partition Cols: []]
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:41:00.779163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7c93bab-d343-4cce-9fc0-f01f193c81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88a427b7c0>]}
[0m12:41:00.780000 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 30.31s]
[0m12:41:00.781036 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:41:00.782137 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:41:00.782740 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m12:41:00.783304 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:41:00.783887 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:41:00.784592 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m12:41:00.785199 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:41:00.785788 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:41:00.786438 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m12:41:00.787019 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:41:00.788527 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:00.788985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:00.789417 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2700, 140704535110464)
[0m12:41:00.789836 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:41:00.790229 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:41:00.790647 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:41:01.420449 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:41:01.421355 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:41:01.422059 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:41:01.422699 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:01.423248 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:41:01.423784 [debug] [MainThread]: On master: Close
[0m12:41:01.424329 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:41:01.425414 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:41:01.425978 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:41:01.565515 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in READY state
[0m12:41:02.989106 [debug] [MainThread]: Glue adapter: [elapsed 1.4067158699035645s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:04.204226 [debug] [MainThread]: Glue adapter: [elapsed 2.639369010925293s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:05.406568 [debug] [MainThread]: Glue adapter: [elapsed 3.848820924758911s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:06.640822 [debug] [MainThread]: Glue adapter: [elapsed 5.083862066268921s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:07.838957 [debug] [MainThread]: Glue adapter: [elapsed 6.283926963806152s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:09.055191 [debug] [MainThread]: Glue adapter: [elapsed 7.483918190002441s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:10.261381 [debug] [MainThread]: Glue adapter: [elapsed 8.705411911010742s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:11.477519 [debug] [MainThread]: Glue adapter: [elapsed 9.906003952026367s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:12.683256 [debug] [MainThread]: Glue adapter: [elapsed 11.121257066726685s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:13.912014 [debug] [MainThread]: Glue adapter: [elapsed 12.326816082000732s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:15.124059 [debug] [MainThread]: Glue adapter: [elapsed 13.555896043777466s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:16.353638 [debug] [MainThread]: Glue adapter: [elapsed 14.776549816131592s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:17.568713 [debug] [MainThread]: Glue adapter: [elapsed 16.000458002090454s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:18.795493 [debug] [MainThread]: Glue adapter: [elapsed 17.23411512374878s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:19.999528 [debug] [MainThread]: Glue adapter: [elapsed 18.440021991729736s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:21.207724 [debug] [MainThread]: Glue adapter: [elapsed 19.644186973571777s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:22.422092 [debug] [MainThread]: Glue adapter: [elapsed 20.857105016708374s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:23.616963 [debug] [MainThread]: Glue adapter: [elapsed 22.066622972488403s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:24.858104 [debug] [MainThread]: Glue adapter: [elapsed 23.298503875732422s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:26.072286 [debug] [MainThread]: Glue adapter: [elapsed 24.5071280002594s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:27.300384 [debug] [MainThread]: Glue adapter: [elapsed 25.721460103988647s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:28.518067 [debug] [MainThread]: Glue adapter: [elapsed 26.949303150177002s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:29.738201 [debug] [MainThread]: Glue adapter: [elapsed 28.16550302505493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:30.944530 [debug] [MainThread]: Glue adapter: [elapsed 29.384351015090942s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:32.161650 [debug] [MainThread]: Glue adapter: [elapsed 30.592270851135254s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:33.377786 [debug] [MainThread]: Glue adapter: [elapsed 31.80625581741333s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:34.600268 [debug] [MainThread]: Glue adapter: [elapsed 33.033409118652344s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:35.821549 [debug] [MainThread]: Glue adapter: [elapsed 34.25648593902588s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:37.034564 [debug] [MainThread]: Glue adapter: [elapsed 35.47187519073486s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:38.248951 [debug] [MainThread]: Glue adapter: [elapsed 36.68079209327698s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:39.452325 [debug] [MainThread]: Glue adapter: [elapsed 37.895971059799194s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:40.716046 [debug] [MainThread]: Glue adapter: [elapsed 39.09184384346008s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:41.926276 [debug] [MainThread]: Glue adapter: [elapsed 40.36201596260071s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:43.146021 [debug] [MainThread]: Glue adapter: [elapsed 41.57977795600891s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:44.531227 [debug] [MainThread]: Glue adapter: [elapsed 42.79157614707947s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e1433af4-87c6-43ae-b2bf-b47170a87337 in STOPPING state
[0m12:41:45.677844 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:41:45.787791 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in READY state
[0m12:41:45.982602 [error] [MainThread]: Encountered an error:

[0m12:41:45.993321 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m12:41:46.007329 [debug] [MainThread]: Command `dbt run` failed at 12:41:46.007025 after 77.51 seconds
[0m12:41:46.008070 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:41:46.008907 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:41:46.083296 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:41:46.202142 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:47.437125 [debug] [MainThread]: Glue adapter: [elapsed 1.2049508094787598s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:48.615724 [debug] [MainThread]: Glue adapter: [elapsed 2.419174909591675s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:49.812911 [debug] [MainThread]: Glue adapter: [elapsed 3.598320960998535s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:50.993375 [debug] [MainThread]: Glue adapter: [elapsed 4.790205001831055s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:52.197143 [debug] [MainThread]: Glue adapter: [elapsed 5.979840040206909s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:53.405431 [debug] [MainThread]: Glue adapter: [elapsed 7.185698747634888s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:54.591674 [debug] [MainThread]: Glue adapter: [elapsed 8.39199686050415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-cd9d747d-6d96-4bac-805a-050102fcc0ad in STOPPING state
[0m12:41:55.018834 [debug] [MainThread]: Flushing usage events
[0m12:42:00.344986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac0f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabedb1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac3c34d30>]}


============================== 12:42:00.351835 | 84474b23-9e75-41ec-a5a9-56cde6442340 ==============================
[0m12:42:00.351835 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:42:00.352886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'profile', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir profile', 'send_anonymous_usage_stats': 'True'}
[0m12:42:00.711644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabedb1a30>]}
[0m12:42:00.733401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac4317fa0>]}
[0m12:42:00.736231 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:42:00.762005 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:42:00.870275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:00.871079 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:42:00.952031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac45c40d0>]}
[0m12:42:00.967458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac453aca0>]}
[0m12:42:00.968250 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:42:00.968902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac453aac0>]}
[0m12:42:00.971276 [info ] [MainThread]: 
[0m12:42:00.972501 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:42:00.974188 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:42:00.974846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:00.975374 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (2751, 123145569624064)
[0m12:42:00.975859 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:42:00.976301 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:42:00.976738 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:42:01.970283 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:42:01.971125 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:42:01.973496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:42:01.974200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:42:02.146392 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:42:02.147289 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:42:02.148933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac452dd60>]}
[0m12:42:02.149888 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:42:02.150514 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:42:02.151813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:02.152626 [info ] [MainThread]: 
[0m12:42:02.176814 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:42:02.177834 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m12:42:02.180477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m12:42:02.181302 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:42:02.202016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:42:02.203752 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 12:42:02.181842 => 12:42:02.203269
[0m12:42:02.205147 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:42:02.226291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:42:02.403638 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:42:02.605165 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:42:02.607224 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:42:02.607936 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:42:02.737598 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:03.890288 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1327621936798096s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:05.015548 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.2831451892852783s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:06.153582 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.404219150543213s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:07.294463 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.549802303314209s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:08.433923 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.683212995529175s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:09.562118 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.821075201034546s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:10.681685 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.95407509803772s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:11.975384 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.077203273773193s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:13.118422 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.368535995483398s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:14.261905 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.511330127716064s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:15.414046 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.66140627861023s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:16.559221 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.809193134307861s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in PROVISIONING state
[0m12:42:17.693390 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.95331597328186s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in READY state
[0m12:42:17.756513 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:42:17.757436 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b
[0m12:42:26.409169 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:42:26.410168 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:42:26.410823 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:42:26.411528 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m12:42:30.203211 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277746525, 'CompletedOn': 1694277749926}, 'ResponseMetadata': {'RequestId': '997474cc-b0d4-4048-880a-6d3dece9baab', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:42:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '997474cc-b0d4-4048-880a-6d3dece9baab'}, 'RetryAttempts': 0}}
[0m12:42:30.204269 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:42:30.205149 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:42:30.206026 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277746525, 'CompletedOn': 1694277749926}, 'ResponseMetadata': {'RequestId': '997474cc-b0d4-4048-880a-6d3dece9baab', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:42:30 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '997474cc-b0d4-4048-880a-6d3dece9baab'}, 'RetryAttempts': 0}}
[0m12:42:30.206745 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:42:30.207399 [debug] [Thread-1  ]: SQL status: OK in 28.0 seconds
[0m12:42:30.251541 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:42:30.253050 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:42:30.253617 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:42:30.254095 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  
[0m12:42:30.330475 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:42:30.331411 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b
[0m12:42:32.130155 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:42:32.131149 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:42:32.131958 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:42:32.132876 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  ''')
[0m12:42:33.604776 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    --, year\n    --, month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    GROUP BY 7\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': 'GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13', 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', 'pyspark.sql.utils.AnalysisException: GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13\n']}, 'Progress': 1.0, 'StartedOn': 1694277752253, 'CompletedOn': 1694277753328}, 'ResponseMetadata': {'RequestId': '349b81f0-a722-4e46-88ee-55a7c10977ad', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:42:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1919', 'connection': 'keep-alive', 'x-amzn-requestid': '349b81f0-a722-4e46-88ee-55a7c10977ad'}, 'RetryAttempts': 0}}
[0m12:42:33.605913 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:42:33.606794 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13
[0m12:42:33.608153 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  '''), AnalysisException: GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13
[0m12:42:33.609123 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 7
) 
SELECT *
FROM source_avg
  
[0m12:42:33.609914 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m12:42:33.610610 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:42:33.611286 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m12:42:33.611950 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:42:33.612819 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 12:42:02.206399 => 12:42:33.612469
[0m12:42:33.632466 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      --, year
      --, month
      , payment_type as type
      FROM nyctaxi.tripdata
      --WHERE year = "2022"
      WHERE tpep_dropoff_datetime is not null
      --GROUP BY 5, 6, 7
      GROUP BY 7
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:42:33.633637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84474b23-9e75-41ec-a5a9-56cde6442340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac5d25880>]}
[0m12:42:33.634779 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 31.45s]
[0m12:42:33.636157 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:42:33.637583 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:42:33.640440 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m12:42:33.641833 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:42:33.642832 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:42:33.643579 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m12:42:33.644230 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:42:33.644826 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:42:33.645467 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m12:42:33.646075 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:42:33.648068 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:33.648612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:33.649113 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2751, 140704535110464)
[0m12:42:33.649548 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:42:33.649934 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:42:33.650398 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:42:34.195657 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:42:34.196528 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:42:34.197078 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:42:34.197621 [debug] [MainThread]: On master: ROLLBACK
[0m12:42:34.198164 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:42:34.198680 [debug] [MainThread]: On master: Close
[0m12:42:34.199215 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:42:34.200288 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:42:34.200847 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:42:34.330170 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in READY state
[0m12:42:35.768820 [debug] [MainThread]: Glue adapter: [elapsed 1.4069392681121826s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:36.972869 [debug] [MainThread]: Glue adapter: [elapsed 2.6359243392944336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:38.180248 [debug] [MainThread]: Glue adapter: [elapsed 3.8423821926116943s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:39.386349 [debug] [MainThread]: Glue adapter: [elapsed 5.043582201004028s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:40.593582 [debug] [MainThread]: Glue adapter: [elapsed 6.260731220245361s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:41.801339 [debug] [MainThread]: Glue adapter: [elapsed 7.464494228363037s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:43.010047 [debug] [MainThread]: Glue adapter: [elapsed 8.6670081615448s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:44.221254 [debug] [MainThread]: Glue adapter: [elapsed 9.878641128540039s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:45.461488 [debug] [MainThread]: Glue adapter: [elapsed 11.094306230545044s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:46.658785 [debug] [MainThread]: Glue adapter: [elapsed 12.32601809501648s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:47.855068 [debug] [MainThread]: Glue adapter: [elapsed 13.519898176193237s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:49.071446 [debug] [MainThread]: Glue adapter: [elapsed 14.727713108062744s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:50.283467 [debug] [MainThread]: Glue adapter: [elapsed 15.949264287948608s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:51.509699 [debug] [MainThread]: Glue adapter: [elapsed 17.160950183868408s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:52.729986 [debug] [MainThread]: Glue adapter: [elapsed 18.396664142608643s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:53.960262 [debug] [MainThread]: Glue adapter: [elapsed 19.60560631752014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:55.165300 [debug] [MainThread]: Glue adapter: [elapsed 20.827792167663574s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:56.389368 [debug] [MainThread]: Glue adapter: [elapsed 22.04599928855896s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:57.589465 [debug] [MainThread]: Glue adapter: [elapsed 23.261091232299805s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:42:58.809265 [debug] [MainThread]: Glue adapter: [elapsed 24.46660828590393s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:00.023341 [debug] [MainThread]: Glue adapter: [elapsed 25.680581092834473s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:01.243672 [debug] [MainThread]: Glue adapter: [elapsed 26.895747184753418s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:02.454269 [debug] [MainThread]: Glue adapter: [elapsed 28.12779426574707s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:03.647081 [debug] [MainThread]: Glue adapter: [elapsed 29.311199188232422s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:05.341569 [debug] [MainThread]: Glue adapter: [elapsed 31.00257110595703s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:06.537086 [debug] [MainThread]: Glue adapter: [elapsed 32.21110820770264s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:07.748381 [debug] [MainThread]: Glue adapter: [elapsed 33.41127014160156s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:08.971547 [debug] [MainThread]: Glue adapter: [elapsed 34.609781980514526s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:10.180735 [debug] [MainThread]: Glue adapter: [elapsed 35.84395432472229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:11.387997 [debug] [MainThread]: Glue adapter: [elapsed 37.04587125778198s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:12.569877 [debug] [MainThread]: Glue adapter: [elapsed 38.25357532501221s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:13.749115 [debug] [MainThread]: Glue adapter: [elapsed 39.42824029922485s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:14.979701 [debug] [MainThread]: Glue adapter: [elapsed 40.61989116668701s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:16.247017 [debug] [MainThread]: Glue adapter: [elapsed 41.83000326156616s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-0930828c-758a-4029-9bf3-e9dc50406f1b in STOPPING state
[0m12:43:17.393206 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:43:17.530379 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in READY state
[0m12:43:18.844680 [debug] [MainThread]: Glue adapter: [elapsed 1.3073108196258545s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:20.073005 [debug] [MainThread]: Glue adapter: [elapsed 2.5245556831359863s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:21.283137 [debug] [MainThread]: Glue adapter: [elapsed 3.751149892807007s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:22.498385 [debug] [MainThread]: Glue adapter: [elapsed 4.9607250690460205s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:23.702594 [debug] [MainThread]: Glue adapter: [elapsed 6.177880764007568s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:24.907815 [debug] [MainThread]: Glue adapter: [elapsed 7.379272937774658s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:26.104370 [debug] [MainThread]: Glue adapter: [elapsed 8.586188793182373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:27.299261 [debug] [MainThread]: Glue adapter: [elapsed 9.778374910354614s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:28.523602 [debug] [MainThread]: Glue adapter: [elapsed 10.978073835372925s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:29.740084 [debug] [MainThread]: Glue adapter: [elapsed 12.204131841659546s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:30.950210 [debug] [MainThread]: Glue adapter: [elapsed 13.41918396949768s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:32.196705 [debug] [MainThread]: Glue adapter: [elapsed 14.636010646820068s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:33.418758 [debug] [MainThread]: Glue adapter: [elapsed 15.88270902633667s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:34.639811 [debug] [MainThread]: Glue adapter: [elapsed 17.094972848892212s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:35.850046 [debug] [MainThread]: Glue adapter: [elapsed 18.312833786010742s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:37.054272 [debug] [MainThread]: Glue adapter: [elapsed 19.519200801849365s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:38.248381 [debug] [MainThread]: Glue adapter: [elapsed 20.72680401802063s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:39.447704 [debug] [MainThread]: Glue adapter: [elapsed 21.92450475692749s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:40.647518 [debug] [MainThread]: Glue adapter: [elapsed 23.119431972503662s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:41.857406 [debug] [MainThread]: Glue adapter: [elapsed 24.335901021957397s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:43.073346 [debug] [MainThread]: Glue adapter: [elapsed 25.536128044128418s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:44.280713 [debug] [MainThread]: Glue adapter: [elapsed 26.753185749053955s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:45.480831 [debug] [MainThread]: Glue adapter: [elapsed 27.96037483215332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:46.683051 [debug] [MainThread]: Glue adapter: [elapsed 29.155624866485596s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:47.895239 [debug] [MainThread]: Glue adapter: [elapsed 30.360936880111694s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:49.114514 [debug] [MainThread]: Glue adapter: [elapsed 31.575604915618896s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:50.351781 [debug] [MainThread]: Glue adapter: [elapsed 32.793874979019165s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:51.572006 [debug] [MainThread]: Glue adapter: [elapsed 34.0347957611084s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:52.786256 [debug] [MainThread]: Glue adapter: [elapsed 35.251688957214355s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:54.005777 [debug] [MainThread]: Glue adapter: [elapsed 36.465157985687256s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-e3b5d6e8-50b8-4abb-a8a0-1cc089cfc988 in STOPPING state
[0m12:43:55.148830 [info ] [MainThread]: 
[0m12:43:55.149813 [info ] [MainThread]: Finished running 4 table models in 0 hours 1 minutes and 54.18 seconds (114.18s).
[0m12:43:55.151626 [debug] [MainThread]: Command end result
[0m12:43:55.170405 [info ] [MainThread]: 
[0m12:43:55.171275 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:43:55.171877 [info ] [MainThread]: 
[0m12:43:55.172541 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m12:43:55.173571 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m12:43:55.174185 [error] [MainThread]:   
[0m12:43:55.174837 [error] [MainThread]:     
[0m12:43:55.177427 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:43:55.178636 [error] [MainThread]:     using PARQUET
[0m12:43:55.179479 [error] [MainThread]:   	
[0m12:43:55.180137 [error] [MainThread]:   	
[0m12:43:55.180718 [error] [MainThread]:   	
[0m12:43:55.181348 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m12:43:55.181829 [error] [MainThread]:   	
[0m12:43:55.182264 [error] [MainThread]:   	as
[0m12:43:55.182715 [error] [MainThread]:   	WITH source_avg as ( 
[0m12:43:55.183185 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m12:43:55.183627 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m12:43:55.184072 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m12:43:55.184518 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m12:43:55.184954 [error] [MainThread]:       --, year
[0m12:43:55.185669 [error] [MainThread]:       --, month
[0m12:43:55.186154 [error] [MainThread]:       , payment_type as type
[0m12:43:55.186709 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m12:43:55.187353 [error] [MainThread]:       --WHERE year = "2022"
[0m12:43:55.187870 [error] [MainThread]:       WHERE tpep_dropoff_datetime is not null
[0m12:43:55.188488 [error] [MainThread]:       --GROUP BY 5, 6, 7
[0m12:43:55.189250 [error] [MainThread]:       GROUP BY 7
[0m12:43:55.189997 [error] [MainThread]:   ) 
[0m12:43:55.190856 [error] [MainThread]:   SELECT *
[0m12:43:55.191614 [error] [MainThread]:   FROM source_avg
[0m12:43:55.192276 [error] [MainThread]:     '''), AnalysisException: GROUP BY position 7 is not in select list (valid range is [1, 5]); line 24 pos 13
[0m12:43:55.192971 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:43:55.193550 [info ] [MainThread]: 
[0m12:43:55.194306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m12:43:55.195660 [debug] [MainThread]: Command `dbt run` failed at 12:43:55.195141 after 114.87 seconds
[0m12:43:55.198452 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:43:55.199339 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:43:55.253014 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:43:55.320990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac0f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac453aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbac452de50>]}
[0m12:43:55.321939 [debug] [MainThread]: Flushing usage events
[0m12:44:06.253681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa187e65e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1865b1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18ab34d30>]}


============================== 12:44:06.257788 | a5fc8014-cf6f-48fe-b04e-0ebe7787c428 ==============================
[0m12:44:06.257788 [info ] [MainThread]: Running with dbt=1.6.1
[0m12:44:06.258538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:06.475516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1865b1a30>]}
[0m12:44:06.499478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b21dfa0>]}
[0m12:44:06.500374 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m12:44:06.531101 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m12:44:06.580097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:06.580904 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m12:44:06.665460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b4c10d0>]}
[0m12:44:06.680304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b43aca0>]}
[0m12:44:06.680899 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m12:44:06.681362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b43aac0>]}
[0m12:44:06.683155 [info ] [MainThread]: 
[0m12:44:06.684217 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m12:44:06.685586 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m12:44:06.686121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:06.686629 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (2803, 123145385652224)
[0m12:44:06.687093 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m12:44:06.687493 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m12:44:06.687878 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m12:44:07.602513 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m12:44:07.603347 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:44:07.605803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m12:44:07.606522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:07.767170 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m12:44:07.768050 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m12:44:07.769385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18b42cd60>]}
[0m12:44:07.770173 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:44:07.770739 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:44:07.771768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:07.772383 [info ] [MainThread]: 
[0m12:44:07.775036 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:44:07.775738 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m12:44:07.776679 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m12:44:07.777235 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:44:07.787347 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:44:07.788289 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 12:44:07.777615 => 12:44:07.788028
[0m12:44:07.788758 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:44:07.814709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:44:07.988903 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:44:08.190579 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:44:08.192679 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:44:08.193386 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:44:08.320420 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:09.463356 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.13820481300354s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:10.619195 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.278228998184204s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:11.770322 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.446847915649414s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:12.907270 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.584192991256714s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:14.047131 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.716859817504883s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:15.198294 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.873382806777954s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:16.345436 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.018570899963379s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:17.493364 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.163771152496338s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:18.620709 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.297677040100098s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:19.759947 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.430059909820557s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:20.903193 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.577892065048218s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:22.051669 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.715171098709106s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in PROVISIONING state
[0m12:44:23.186456 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.856758117675781s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in READY state
[0m12:44:23.255505 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:44:23.256429 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:44:30.934707 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:44:30.936401 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:44:30.937421 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:44:30.938434 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m12:44:34.731231 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277871125, 'CompletedOn': 1694277874643}, 'ResponseMetadata': {'RequestId': '3e14f940-9720-4a12-8430-02266131139b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:34 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '3e14f940-9720-4a12-8430-02266131139b'}, 'RetryAttempts': 0}}
[0m12:44:34.732294 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:44:34.733169 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:44:34.734081 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277871125, 'CompletedOn': 1694277874643}, 'ResponseMetadata': {'RequestId': '3e14f940-9720-4a12-8430-02266131139b', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:34 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '3e14f940-9720-4a12-8430-02266131139b'}, 'RetryAttempts': 0}}
[0m12:44:34.734793 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:44:34.735443 [debug] [Thread-1  ]: SQL status: OK in 27.0 seconds
[0m12:44:34.778520 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:44:34.779451 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:44:34.779916 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m12:44:34.780389 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m12:44:34.843957 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:44:34.844914 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:44:36.566271 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:44:36.567410 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:44:36.568281 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:44:36.569100 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    --, year
    --, month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m12:44:55.045693 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    --, year\n    --, month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    --, year\\n    --, month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    --GROUP BY 5, 6, 7\\n    GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277876682, 'CompletedOn': 1694277893989}, 'ResponseMetadata': {'RequestId': 'dee6bb42-26f1-4d3c-b9c9-b75cb4e7f3cd', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2277', 'connection': 'keep-alive', 'x-amzn-requestid': 'dee6bb42-26f1-4d3c-b9c9-b75cb4e7f3cd'}, 'RetryAttempts': 0}}
[0m12:44:55.046660 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:44:55.047414 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    --, year\\n    --, month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    --GROUP BY 5, 6, 7\\n    GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:44:55.048320 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    --, year\n    --, month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\tWITH source_avg as ( \\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    --, year\\n    --, month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    --GROUP BY 5, 6, 7\\n    GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277876682, 'CompletedOn': 1694277893989}, 'ResponseMetadata': {'RequestId': 'dee6bb42-26f1-4d3c-b9c9-b75cb4e7f3cd', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2277', 'connection': 'keep-alive', 'x-amzn-requestid': 'dee6bb42-26f1-4d3c-b9c9-b75cb4e7f3cd'}, 'RetryAttempts': 0}}
[0m12:44:55.049107 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:44:55.049862 [debug] [Thread-1  ]: SQL status: OK in 20.0 seconds
[0m12:44:55.074466 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 12:44:07.789078 => 12:44:55.074218
[0m12:44:55.075001 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m12:44:55.075459 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:44:55.075892 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m12:44:55.076341 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:44:55.077162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cc80c40>]}
[0m12:44:55.077856 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 47.30s]
[0m12:44:55.078641 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m12:44:55.079608 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:44:55.080163 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m12:44:55.081043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m12:44:55.081562 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:44:55.085115 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m12:44:55.085998 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 12:44:55.081949 => 12:44:55.085754
[0m12:44:55.086457 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:44:55.088934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:44:55.282460 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:44:55.475795 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:44:55.477875 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m12:44:55.478571 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m12:44:55.560593 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:44:55.561558 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:44:57.458023 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:44:57.458972 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:44:57.459779 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:44:57.460642 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m12:44:58.900820 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277897580, 'CompletedOn': 1694277897961}, 'ResponseMetadata': {'RequestId': 'e81b5e78-0abc-4d10-a57c-8c7d5ff37a4c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:58 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '918', 'connection': 'keep-alive', 'x-amzn-requestid': 'e81b5e78-0abc-4d10-a57c-8c7d5ff37a4c'}, 'RetryAttempts': 0}}
[0m12:44:58.901879 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:44:58.902756 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:44:58.903671 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277897580, 'CompletedOn': 1694277897961}, 'ResponseMetadata': {'RequestId': 'e81b5e78-0abc-4d10-a57c-8c7d5ff37a4c', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:44:58 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '918', 'connection': 'keep-alive', 'x-amzn-requestid': 'e81b5e78-0abc-4d10-a57c-8c7d5ff37a4c'}, 'RetryAttempts': 0}}
[0m12:44:58.904384 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:44:58.905018 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m12:44:58.915295 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m12:44:58.916318 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:44:58.916860 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m12:44:58.917397 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:44:58.986998 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:44:58.987934 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:45:00.682637 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:45:00.683450 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:00.684105 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:00.684845 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m12:45:02.187041 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 11, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists\n+- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists\n+- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277900810, 'CompletedOn': 1694277901540}, 'ResponseMetadata': {'RequestId': '96a1d7e8-3abc-4467-a7c5-5f60dd22eb62', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:02 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3334', 'connection': 'keep-alive', 'x-amzn-requestid': '96a1d7e8-3abc-4467-a7c5-5f60dd22eb62'}, 'RetryAttempts': 0}}
[0m12:45:02.188278 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:45:02.189157 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists
+- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:02.190312 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists
+- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:02.191288 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:45:02.192010 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m12:45:02.192721 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:45:02.193481 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m12:45:02.194199 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:45:02.195053 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 12:44:55.086775 => 12:45:02.194710
[0m12:45:02.209743 [debug] [Thread-1  ]: Database Error in model gold_nyctaxi_cost_metrics (models/gold_metrics/gold_nyctaxi_cost_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
  
    
      create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
  	
  	as
  	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
  , (avg_total_amount/avg_duration) as avg_cost_per_minute
  , year
  , month 
  , type 
  FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;
  'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists
  +- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]
     +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
        +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_cost_metrics.sql
[0m12:45:02.210489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cc59490>]}
[0m12:45:02.211282 [error] [Thread-1  ]: 2 of 4 ERROR creating sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics  [[31mERROR[0m in 7.13s]
[0m12:45:02.212488 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m12:45:02.213114 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:45:02.213994 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m12:45:02.215043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m12:45:02.215563 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:45:02.220382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m12:45:02.221363 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 12:45:02.215898 => 12:45:02.221097
[0m12:45:02.221853 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:45:02.226436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:45:02.429219 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:45:02.788622 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:45:02.790713 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m12:45:02.791439 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m12:45:02.859766 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:45:02.860681 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:45:04.533408 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:45:04.534348 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:04.535149 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:04.536016 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m12:45:05.912910 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277904648, 'CompletedOn': 1694277904980}, 'ResponseMetadata': {'RequestId': 'dd1b44b9-4531-475a-a7fb-429a396e4689', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:05 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': 'dd1b44b9-4531-475a-a7fb-429a396e4689'}, 'RetryAttempts': 0}}
[0m12:45:05.914063 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:45:05.914757 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:45:05.915525 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277904648, 'CompletedOn': 1694277904980}, 'ResponseMetadata': {'RequestId': 'dd1b44b9-4531-475a-a7fb-429a396e4689', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:05 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': 'dd1b44b9-4531-475a-a7fb-429a396e4689'}, 'RetryAttempts': 0}}
[0m12:45:05.916273 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:45:05.917443 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m12:45:05.927972 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m12:45:05.928931 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:05.929392 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m12:45:05.929849 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:45:06.008875 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:45:06.009806 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:45:07.701249 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:45:07.702679 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:07.704127 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:07.704710 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m12:45:09.143385 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 17, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists\n+- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists\n+- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277907818, 'CompletedOn': 1694277908271}, 'ResponseMetadata': {'RequestId': '154bc3ab-b34f-44f8-b1f3-fa4720beaa45', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:09 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3164', 'connection': 'keep-alive', 'x-amzn-requestid': '154bc3ab-b34f-44f8-b1f3-fa4720beaa45'}, 'RetryAttempts': 0}}
[0m12:45:09.144571 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:45:09.145494 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists
+- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:09.146609 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists
+- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:09.147899 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:45:09.148943 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m12:45:09.149630 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:45:09.150133 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m12:45:09.150654 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:45:09.151340 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 12:45:02.222304 => 12:45:09.151061
[0m12:45:09.153012 [debug] [Thread-1  ]: Database Error in model gold_nyctaxi_distance_metrics (models/gold_metrics/gold_nyctaxi_distance_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
  
    
      create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
  	
  	as
  	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
  , year
  , month 
  , type 
  FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;
  'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists
  +- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]
     +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
        +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_distance_metrics.sql
[0m12:45:09.153730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18ce1fa90>]}
[0m12:45:09.154499 [error] [Thread-1  ]: 3 of 4 ERROR creating sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[31mERROR[0m in 6.94s]
[0m12:45:09.155394 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m12:45:09.156022 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:45:09.156747 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m12:45:09.157731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m12:45:09.158284 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:45:09.163047 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m12:45:09.164021 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 12:45:09.158987 => 12:45:09.163743
[0m12:45:09.164521 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:45:09.171685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:45:09.364026 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:45:09.551946 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m12:45:09.554282 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m12:45:09.555022 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m12:45:09.621232 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:45:09.621863 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:45:11.374834 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:45:11.375546 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:11.383849 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:11.384968 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m12:45:12.747275 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277911491, 'CompletedOn': 1694277911858}, 'ResponseMetadata': {'RequestId': '0791c724-0bd8-46a7-a2d8-6c571dbcea31', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:12 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': '0791c724-0bd8-46a7-a2d8-6c571dbcea31'}, 'RetryAttempts': 0}}
[0m12:45:12.748344 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m12:45:12.749250 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m12:45:12.750044 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694277911491, 'CompletedOn': 1694277911858}, 'ResponseMetadata': {'RequestId': '0791c724-0bd8-46a7-a2d8-6c571dbcea31', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:12 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': '0791c724-0bd8-46a7-a2d8-6c571dbcea31'}, 'RetryAttempts': 0}}
[0m12:45:12.750756 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m12:45:12.751387 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m12:45:12.764115 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m12:45:12.765008 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:12.765562 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m12:45:12.766034 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:45:12.835656 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m12:45:12.836326 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56
[0m12:45:14.480451 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m12:45:14.481412 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m12:45:14.482209 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m12:45:14.483336 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m12:45:15.852584 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 23, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists\n+- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;\n'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists\n+- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]\n   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694277914597, 'CompletedOn': 1694277915017}, 'ResponseMetadata': {'RequestId': '313171dd-ff52-4fe2-9f45-811bf64fc522', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 16:45:15 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '3661', 'connection': 'keep-alive', 'x-amzn-requestid': '313171dd-ff52-4fe2-9f45-811bf64fc522'}, 'RetryAttempts': 0}}
[0m12:45:15.854563 [debug] [Thread-1  ]: Glue adapter: status = error
[0m12:45:15.855423 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists
+- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:15.856623 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;
'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists
+- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]
   +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
      +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet

[0m12:45:15.857550 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m12:45:15.858270 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m12:45:15.858942 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m12:45:15.859822 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m12:45:15.861616 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m12:45:15.863385 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 12:45:09.164850 => 12:45:15.862870
[0m12:45:15.866107 [debug] [Thread-1  ]: Database Error in model gold_nyctaxi_passengers_metrics (models/gold_metrics/gold_nyctaxi_passengers_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
  
    
      create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
  	
  	as
  	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
  , (avg_duration/avg_passenger_count) as avg_duration_per_passenger
  , (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
  , year
  , month 
  , type 
  FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;
  'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists
  +- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]
     +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
        +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_passengers_metrics.sql
[0m12:45:15.866919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fc8014-cf6f-48fe-b04e-0ebe7787c428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cf6f880>]}
[0m12:45:15.867660 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[31mERROR[0m in 6.71s]
[0m12:45:15.868951 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m12:45:15.871201 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:15.871670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:15.872112 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (2803, 140704535110464)
[0m12:45:15.872500 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m12:45:15.872874 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m12:45:15.873246 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m12:45:16.538743 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:45:16.539621 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m12:45:16.540092 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m12:45:16.540551 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:16.541280 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m12:45:16.541934 [debug] [MainThread]: On master: Close
[0m12:45:16.542942 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m12:45:16.543804 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:45:16.544269 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:45:16.671256 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in READY state
[0m12:45:18.037271 [debug] [MainThread]: Glue adapter: [elapsed 1.3399441242218018s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:19.267020 [debug] [MainThread]: Glue adapter: [elapsed 2.5724048614501953s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:20.479083 [debug] [MainThread]: Glue adapter: [elapsed 3.798882007598877s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:21.728329 [debug] [MainThread]: Glue adapter: [elapsed 5.019057989120483s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:22.920170 [debug] [MainThread]: Glue adapter: [elapsed 6.24335503578186s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:24.129197 [debug] [MainThread]: Glue adapter: [elapsed 7.457319021224976s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:25.326995 [debug] [MainThread]: Glue adapter: [elapsed 8.64200496673584s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:26.532082 [debug] [MainThread]: Glue adapter: [elapsed 9.855588912963867s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:27.747859 [debug] [MainThread]: Glue adapter: [elapsed 11.071148872375488s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:28.956323 [debug] [MainThread]: Glue adapter: [elapsed 12.276947975158691s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:30.147132 [debug] [MainThread]: Glue adapter: [elapsed 13.470920085906982s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:31.321829 [debug] [MainThread]: Glue adapter: [elapsed 14.660701751708984s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:32.505054 [debug] [MainThread]: Glue adapter: [elapsed 15.834345817565918s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:33.709611 [debug] [MainThread]: Glue adapter: [elapsed 17.035383939743042s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:34.912827 [debug] [MainThread]: Glue adapter: [elapsed 18.221115112304688s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:36.147854 [debug] [MainThread]: Glue adapter: [elapsed 19.44229793548584s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:37.360053 [debug] [MainThread]: Glue adapter: [elapsed 20.6781108379364s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:38.578419 [debug] [MainThread]: Glue adapter: [elapsed 21.891093015670776s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:39.787537 [debug] [MainThread]: Glue adapter: [elapsed 23.108360767364502s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:40.995698 [debug] [MainThread]: Glue adapter: [elapsed 24.321017026901245s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:42.217939 [debug] [MainThread]: Glue adapter: [elapsed 25.532137870788574s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-906f84b1-c460-4678-a660-312925d7eb56 in STOPPING state
[0m12:45:43.354246 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:45:43.480368 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in READY state
[0m12:45:44.805596 [debug] [MainThread]: Glue adapter: [elapsed 1.3159799575805664s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:46.009894 [debug] [MainThread]: Glue adapter: [elapsed 2.5212788581848145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:47.232079 [debug] [MainThread]: Glue adapter: [elapsed 3.7314398288726807s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:48.436346 [debug] [MainThread]: Glue adapter: [elapsed 4.9421539306640625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:49.645529 [debug] [MainThread]: Glue adapter: [elapsed 6.14753794670105s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:50.845720 [debug] [MainThread]: Glue adapter: [elapsed 7.3577399253845215s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:52.400581 [debug] [MainThread]: Glue adapter: [elapsed 8.869343996047974s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:53.635285 [debug] [MainThread]: Glue adapter: [elapsed 10.132226705551147s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:54.862832 [debug] [MainThread]: Glue adapter: [elapsed 11.360981941223145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:56.097064 [debug] [MainThread]: Glue adapter: [elapsed 12.589240789413452s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:57.361296 [debug] [MainThread]: Glue adapter: [elapsed 13.867180824279785s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:58.591222 [debug] [MainThread]: Glue adapter: [elapsed 15.089250802993774s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:45:59.908978 [debug] [MainThread]: Glue adapter: [elapsed 16.320420742034912s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:01.132133 [debug] [MainThread]: Glue adapter: [elapsed 17.6445529460907s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:02.339477 [debug] [MainThread]: Glue adapter: [elapsed 18.842005968093872s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:03.553658 [debug] [MainThread]: Glue adapter: [elapsed 20.0547137260437s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:04.791986 [debug] [MainThread]: Glue adapter: [elapsed 21.261152029037476s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:06.009033 [debug] [MainThread]: Glue adapter: [elapsed 22.511185884475708s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:07.201437 [debug] [MainThread]: Glue adapter: [elapsed 23.7233247756958s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:08.414644 [debug] [MainThread]: Glue adapter: [elapsed 24.919314861297607s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:09.627892 [debug] [MainThread]: Glue adapter: [elapsed 26.132631063461304s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:10.834170 [debug] [MainThread]: Glue adapter: [elapsed 27.359015941619873s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:12.046243 [debug] [MainThread]: Glue adapter: [elapsed 28.556480884552002s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:13.256659 [debug] [MainThread]: Glue adapter: [elapsed 29.76657485961914s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:14.475135 [debug] [MainThread]: Glue adapter: [elapsed 30.966914653778076s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:15.687697 [debug] [MainThread]: Glue adapter: [elapsed 32.18179368972778s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:16.897724 [debug] [MainThread]: Glue adapter: [elapsed 33.39592385292053s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:18.108663 [debug] [MainThread]: Glue adapter: [elapsed 34.61055588722229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:19.367649 [debug] [MainThread]: Glue adapter: [elapsed 35.82669687271118s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:20.562223 [debug] [MainThread]: Glue adapter: [elapsed 37.07649898529053s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:21.779738 [debug] [MainThread]: Glue adapter: [elapsed 38.28812599182129s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:23.009950 [debug] [MainThread]: Glue adapter: [elapsed 39.4828417301178s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:24.411079 [debug] [MainThread]: Glue adapter: [elapsed 40.8954119682312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:25.650000 [debug] [MainThread]: Glue adapter: [elapsed 42.13191771507263s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:26.916628 [debug] [MainThread]: Glue adapter: [elapsed 43.4137818813324s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:28.109941 [debug] [MainThread]: Glue adapter: [elapsed 44.630897760391235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:29.330307 [debug] [MainThread]: Glue adapter: [elapsed 45.82499980926514s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:30.668679 [debug] [MainThread]: Glue adapter: [elapsed 47.04621386528015s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:31.875944 [debug] [MainThread]: Glue adapter: [elapsed 48.38762283325195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:33.159306 [debug] [MainThread]: Glue adapter: [elapsed 49.61390280723572s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:34.364171 [debug] [MainThread]: Glue adapter: [elapsed 50.87449884414673s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:35.575083 [debug] [MainThread]: Glue adapter: [elapsed 52.089881896972656s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:36.787981 [debug] [MainThread]: Glue adapter: [elapsed 53.29855990409851s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-adad7ac5-bcb7-4c4e-a4de-ee13ee896ed3 in STOPPING state
[0m12:46:37.955850 [info ] [MainThread]: 
[0m12:46:37.957259 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 31.27 seconds (151.27s).
[0m12:46:37.960701 [debug] [MainThread]: Command end result
[0m12:46:37.986755 [info ] [MainThread]: 
[0m12:46:37.987676 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:46:37.988278 [info ] [MainThread]: 
[0m12:46:37.988924 [error] [MainThread]: [33mDatabase Error in model gold_nyctaxi_cost_metrics (models/gold_metrics/gold_nyctaxi_cost_metrics.sql)[0m
[0m12:46:37.989545 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
[0m12:46:37.990122 [error] [MainThread]:   
[0m12:46:37.990731 [error] [MainThread]:     
[0m12:46:37.991234 [error] [MainThread]:       create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m12:46:37.991836 [error] [MainThread]:     using PARQUET
[0m12:46:37.992349 [error] [MainThread]:   	
[0m12:46:37.992741 [error] [MainThread]:   	
[0m12:46:37.993129 [error] [MainThread]:   	
[0m12:46:37.993519 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
[0m12:46:37.993893 [error] [MainThread]:   	
[0m12:46:37.994259 [error] [MainThread]:   	as
[0m12:46:37.994627 [error] [MainThread]:   	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
[0m12:46:37.994996 [error] [MainThread]:   , (avg_total_amount/avg_duration) as avg_cost_per_minute
[0m12:46:37.995378 [error] [MainThread]:   , year
[0m12:46:37.995753 [error] [MainThread]:   , month 
[0m12:46:37.996123 [error] [MainThread]:   , type 
[0m12:46:37.996492 [error] [MainThread]:   FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:37.996883 [error] [MainThread]:     '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 14 pos 2;
[0m12:46:37.997296 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_cost_metrics`, ErrorIfExists
[0m12:46:37.997685 [error] [MainThread]:   +- 'Project [(avg_total_amount#99 / avg_trip_distance#98) AS avg_cost_per_distance#94, (avg_total_amount#99 / avg_duration#96) AS avg_cost_per_minute#95, 'year, 'month, type#100L]
[0m12:46:37.998076 [error] [MainThread]:      +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:37.998482 [error] [MainThread]:         +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
[0m12:46:37.999090 [error] [MainThread]:   
[0m12:46:37.999773 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_cost_metrics.sql
[0m12:46:38.000910 [info ] [MainThread]: 
[0m12:46:38.001653 [error] [MainThread]: [33mDatabase Error in model gold_nyctaxi_distance_metrics (models/gold_metrics/gold_nyctaxi_distance_metrics.sql)[0m
[0m12:46:38.002141 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
[0m12:46:38.002573 [error] [MainThread]:   
[0m12:46:38.002977 [error] [MainThread]:     
[0m12:46:38.003378 [error] [MainThread]:       create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m12:46:38.003780 [error] [MainThread]:     using PARQUET
[0m12:46:38.004182 [error] [MainThread]:   	
[0m12:46:38.004654 [error] [MainThread]:   	
[0m12:46:38.005330 [error] [MainThread]:   	
[0m12:46:38.005851 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
[0m12:46:38.006559 [error] [MainThread]:   	
[0m12:46:38.007266 [error] [MainThread]:   	as
[0m12:46:38.007949 [error] [MainThread]:   	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
[0m12:46:38.008610 [error] [MainThread]:   , year
[0m12:46:38.009143 [error] [MainThread]:   , month 
[0m12:46:38.009648 [error] [MainThread]:   , type 
[0m12:46:38.010197 [error] [MainThread]:   FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:38.010949 [error] [MainThread]:     '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 13 pos 2;
[0m12:46:38.011596 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_distance_metrics`, ErrorIfExists
[0m12:46:38.012256 [error] [MainThread]:   +- 'Project [(avg_trip_distance#98 / avg_duration#96) AS avg_distance_per_duration#107, 'year, 'month, type#100L]
[0m12:46:38.012809 [error] [MainThread]:      +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:38.013349 [error] [MainThread]:         +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
[0m12:46:38.013890 [error] [MainThread]:   
[0m12:46:38.014411 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_distance_metrics.sql
[0m12:46:38.014945 [info ] [MainThread]: 
[0m12:46:38.015468 [error] [MainThread]: [33mDatabase Error in model gold_nyctaxi_passengers_metrics (models/gold_metrics/gold_nyctaxi_passengers_metrics.sql)[0m
[0m12:46:38.016018 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
[0m12:46:38.016661 [error] [MainThread]:   
[0m12:46:38.017371 [error] [MainThread]:     
[0m12:46:38.018080 [error] [MainThread]:       create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m12:46:38.018761 [error] [MainThread]:     using PARQUET
[0m12:46:38.019330 [error] [MainThread]:   	
[0m12:46:38.019877 [error] [MainThread]:   	
[0m12:46:38.020404 [error] [MainThread]:   	
[0m12:46:38.020942 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
[0m12:46:38.021383 [error] [MainThread]:   	
[0m12:46:38.021808 [error] [MainThread]:   	as
[0m12:46:38.022211 [error] [MainThread]:   	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
[0m12:46:38.022614 [error] [MainThread]:   , (avg_duration/avg_passenger_count) as avg_duration_per_passenger
[0m12:46:38.023020 [error] [MainThread]:   , (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
[0m12:46:38.023429 [error] [MainThread]:   , year
[0m12:46:38.023831 [error] [MainThread]:   , month 
[0m12:46:38.024239 [error] [MainThread]:   , type 
[0m12:46:38.024639 [error] [MainThread]:   FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:38.025049 [error] [MainThread]:     '''), AnalysisException: Column 'year' does not exist. Did you mean one of the following? [spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.type, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_duration, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_total_amount, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_trip_distance, spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics.avg_passenger_count]; line 15 pos 2;
[0m12:46:38.025466 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`gold_nyctaxi_passengers_metrics`, ErrorIfExists
[0m12:46:38.025918 [error] [MainThread]:   +- 'Project [(avg_total_amount#99 / avg_passenger_count#97) AS avg_cost_per_passenger#113, (avg_duration#96 / avg_passenger_count#97) AS avg_duration_per_passenger#114, (avg_trip_distance#98 / avg_passenger_count#97) AS avg_trip_distance_per_passenger#115, 'year, 'month, type#100L]
[0m12:46:38.026339 [error] [MainThread]:      +- SubqueryAlias spark_catalog.dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m12:46:38.026745 [error] [MainThread]:         +- Relation dbt_nyc_metrics.silver_nyctaxi_avg_metrics[avg_duration#96,avg_passenger_count#97,avg_trip_distance#98,avg_total_amount#99,type#100L] parquet
[0m12:46:38.027146 [error] [MainThread]:   
[0m12:46:38.027545 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/gold_metrics/gold_nyctaxi_passengers_metrics.sql
[0m12:46:38.027967 [info ] [MainThread]: 
[0m12:46:38.028508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m12:46:38.029743 [debug] [MainThread]: Command `dbt run` failed at 12:46:38.029551 after 151.83 seconds
[0m12:46:38.030523 [debug] [MainThread]: Glue adapter: cleanup called
[0m12:46:38.030924 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:46:38.264553 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m12:46:38.340985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa187e65e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18ccb5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18ccb5340>]}
[0m12:46:38.342383 [debug] [MainThread]: Flushing usage events
[0m13:10:59.772006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc626f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6255b1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62a334d30>]}


============================== 13:10:59.779947 | c11c3115-c90a-4465-b8de-3ad19530a042 ==============================
[0m13:10:59.779947 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:10:59.781035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:00.286313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6255b1a30>]}
[0m13:11:00.310206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62aa17fa0>]}
[0m13:11:00.311457 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:11:00.370558 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:11:00.474302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:11:00.475174 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/schema.yml
[0m13:11:00.475642 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:11:00.560972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62acc50d0>]}
[0m13:11:00.576750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62ac2ce20>]}
[0m13:11:00.577344 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:11:00.577799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62ac70f70>]}
[0m13:11:00.579525 [info ] [MainThread]: 
[0m13:11:00.580563 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:11:00.581921 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:11:00.582465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:00.582954 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (3268, 123145525391360)
[0m13:11:00.583402 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:11:00.583780 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:11:00.584153 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:11:01.732576 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:11:01.733366 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:11:01.735747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:11:01.736443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:01.928627 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:11:01.929501 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:11:01.931301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62ac3a520>]}
[0m13:11:01.932124 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:11:01.932752 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:11:01.933833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:01.934326 [info ] [MainThread]: 
[0m13:11:01.937969 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:11:01.938702 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m13:11:01.939643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m13:11:01.940194 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:11:01.950212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:11:01.951157 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 13:11:01.940571 => 13:11:01.950898
[0m13:11:01.951619 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:11:01.970365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:02.169424 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : silver_nyctaxi_avg_metrics
                             type : table
                        
[0m13:11:02.551414 [debug] [Thread-1  ]: Glue adapter: table_name : silver_nyctaxi_avg_metrics
[0m13:11:02.552376 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m13:11:02.554496 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:11:02.555171 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:11:02.711621 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:03.862548 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1597280502319336s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:05.018736 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.3108670711517334s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:06.194843 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4893369674682617s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:07.365933 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.638449192047119s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:08.531175 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.820833921432495s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:09.679376 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.970402956008911s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:10.833156 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.126675128936768s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:12.005560 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.2815101146698s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:13.191795 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.455029964447021s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:14.347931 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.646497011184692s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:15.514300 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.791441202163696s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:16.724436 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.020495176315308s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:17.874530 [debug] [Thread-1  ]: Glue adapter: [elapsed 15.176815032958984s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:19.305980 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.604724168777466s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:20.449449 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.75235915184021s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in PROVISIONING state
[0m13:11:21.620986 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.894529104232788s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in READY state
[0m13:11:21.691825 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:11:21.692747 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5
[0m13:11:31.641318 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:11:31.642279 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:11:31.643092 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:11:31.643973 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m13:11:44.756798 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279491720, 'CompletedOn': 1694279503852}, 'ResponseMetadata': {'RequestId': '9318316a-2873-4e55-9220-5a994401b2ea', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:11:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '9318316a-2873-4e55-9220-5a994401b2ea'}, 'RetryAttempts': 0}}
[0m13:11:44.757506 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:11:44.758040 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:11:44.758727 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279491720, 'CompletedOn': 1694279503852}, 'ResponseMetadata': {'RequestId': '9318316a-2873-4e55-9220-5a994401b2ea', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:11:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '9318316a-2873-4e55-9220-5a994401b2ea'}, 'RetryAttempts': 0}}
[0m13:11:44.759276 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:11:44.759755 [debug] [Thread-1  ]: SQL status: OK in 42.0 seconds
[0m13:11:44.800070 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:11:44.801220 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:11:44.801848 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:11:44.802342 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as LONG)) as year
    , month(CAST(tpep_dropoff_datetime as LONG)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:11:44.877778 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:11:44.878707 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5
[0m13:11:45.486183 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:11:45.487165 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:11:45.487984 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:11:45.488867 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as LONG)) as year
    , month(CAST(tpep_dropoff_datetime as LONG)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m13:11:46.902096 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as LONG)) as year\n    , month(CAST(tpep_dropoff_datetime as LONG)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]\n         +- Filter isnotnull(tpep_dropoff_datetime#29)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;\n'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists\n+- 'Project [*]\n   +- 'SubqueryAlias source_avg\n      +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]\n         +- Filter isnotnull(tpep_dropoff_datetime#29)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694279505569, 'CompletedOn': 1694279506351}, 'ResponseMetadata': {'RequestId': '5ac4587d-b65b-470e-89df-901a2e041c14', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:11:46 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '4328', 'connection': 'keep-alive', 'x-amzn-requestid': '5ac4587d-b65b-470e-89df-901a2e041c14'}, 'RetryAttempts': 0}}
[0m13:11:46.903383 [debug] [Thread-1  ]: Glue adapter: status = error
[0m13:11:46.904366 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as LONG)) as year
    , month(CAST(tpep_dropoff_datetime as LONG)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]
         +- Filter isnotnull(tpep_dropoff_datetime#29)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]

[0m13:11:46.908051 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as LONG)) as year
    , month(CAST(tpep_dropoff_datetime as LONG)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;
'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
+- 'Project [*]
   +- 'SubqueryAlias source_avg
      +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]
         +- Filter isnotnull(tpep_dropoff_datetime#29)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]

[0m13:11:46.909213 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as LONG)) as year
    , month(CAST(tpep_dropoff_datetime as LONG)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:11:46.909957 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m13:11:46.910621 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:11:46.911282 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m13:11:46.911828 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:11:46.912539 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 13:11:01.951935 => 13:11:46.912252
[0m13:11:46.925129 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      , year(CAST(tpep_dropoff_datetime as LONG)) as year
      , month(CAST(tpep_dropoff_datetime as LONG)) as month
      , payment_type as type
      FROM nyctaxi.tripdata
      --WHERE year = "2022"
      WHERE tpep_dropoff_datetime is not null
      --GROUP BY 5, 6, 7
      GROUP BY 5
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;
  'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
  +- 'Project [*]
     +- 'SubqueryAlias source_avg
        +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]
           +- Filter isnotnull(tpep_dropoff_datetime#29)
              +- SubqueryAlias spark_catalog.nyctaxi.tripdata
                 +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:11:46.926795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c11c3115-c90a-4465-b8de-3ad19530a042', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62ac48040>]}
[0m13:11:46.927991 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 44.99s]
[0m13:11:46.929410 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:11:46.930891 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:11:46.931637 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m13:11:46.932381 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:11:46.933286 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:11:46.934282 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m13:11:46.935220 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:11:46.936384 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:11:46.938407 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m13:11:46.939466 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:11:46.941431 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:46.941940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:46.942638 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (3268, 140704535110464)
[0m13:11:46.943106 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:11:46.943510 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m13:11:46.943936 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m13:11:47.505100 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:11:47.505997 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:11:47.506695 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:11:47.507335 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:47.507885 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:11:47.508412 [debug] [MainThread]: On master: Close
[0m13:11:47.508954 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:11:47.510019 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:11:47.510581 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:11:47.659889 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in READY state
[0m13:11:49.045824 [debug] [MainThread]: Glue adapter: [elapsed 1.407641887664795s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:50.248686 [debug] [MainThread]: Glue adapter: [elapsed 2.597568988800049s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:51.438147 [debug] [MainThread]: Glue adapter: [elapsed 3.7987420558929443s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:52.642352 [debug] [MainThread]: Glue adapter: [elapsed 4.9869279861450195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:53.863109 [debug] [MainThread]: Glue adapter: [elapsed 6.211091041564941s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:55.079673 [debug] [MainThread]: Glue adapter: [elapsed 7.4292380809783936s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:56.315681 [debug] [MainThread]: Glue adapter: [elapsed 8.64304804801941s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:57.523681 [debug] [MainThread]: Glue adapter: [elapsed 9.867693901062012s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:58.755554 [debug] [MainThread]: Glue adapter: [elapsed 11.093780040740967s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:11:59.999749 [debug] [MainThread]: Glue adapter: [elapsed 12.309307098388672s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:01.207004 [debug] [MainThread]: Glue adapter: [elapsed 13.551022052764893s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:02.434166 [debug] [MainThread]: Glue adapter: [elapsed 14.76826786994934s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:03.658396 [debug] [MainThread]: Glue adapter: [elapsed 16.00499391555786s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:04.884713 [debug] [MainThread]: Glue adapter: [elapsed 17.225321054458618s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:06.113859 [debug] [MainThread]: Glue adapter: [elapsed 18.450496196746826s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:07.347119 [debug] [MainThread]: Glue adapter: [elapsed 19.685796976089478s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:08.579343 [debug] [MainThread]: Glue adapter: [elapsed 20.91915512084961s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:09.800212 [debug] [MainThread]: Glue adapter: [elapsed 22.14810609817505s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:11.037865 [debug] [MainThread]: Glue adapter: [elapsed 23.372459888458252s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:12.268086 [debug] [MainThread]: Glue adapter: [elapsed 24.600367069244385s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:13.496273 [debug] [MainThread]: Glue adapter: [elapsed 25.8353009223938s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:14.706823 [debug] [MainThread]: Glue adapter: [elapsed 27.0613431930542s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:15.924895 [debug] [MainThread]: Glue adapter: [elapsed 28.269474983215332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:17.137106 [debug] [MainThread]: Glue adapter: [elapsed 29.49417519569397s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:18.368214 [debug] [MainThread]: Glue adapter: [elapsed 30.70453405380249s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:19.575418 [debug] [MainThread]: Glue adapter: [elapsed 31.93946099281311s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:20.798846 [debug] [MainThread]: Glue adapter: [elapsed 33.145796060562134s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-12cb994a-862e-4f09-ad6f-e036710267f5 in STOPPING state
[0m13:12:21.947829 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:12:22.101624 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in READY state
[0m13:12:23.492335 [debug] [MainThread]: Glue adapter: [elapsed 1.37367582321167s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:24.701351 [debug] [MainThread]: Glue adapter: [elapsed 2.6116158962249756s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:25.911309 [debug] [MainThread]: Glue adapter: [elapsed 3.8291449546813965s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:27.147711 [debug] [MainThread]: Glue adapter: [elapsed 5.031270980834961s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:28.386236 [debug] [MainThread]: Glue adapter: [elapsed 6.2875518798828125s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:29.693552 [debug] [MainThread]: Glue adapter: [elapsed 7.5118088722229s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:30.890779 [debug] [MainThread]: Glue adapter: [elapsed 8.814939022064209s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:32.124586 [debug] [MainThread]: Glue adapter: [elapsed 10.017991065979004s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:33.340199 [debug] [MainThread]: Glue adapter: [elapsed 11.250509977340698s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:34.550547 [debug] [MainThread]: Glue adapter: [elapsed 12.475951910018921s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:35.759669 [debug] [MainThread]: Glue adapter: [elapsed 13.668845891952515s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:36.986812 [debug] [MainThread]: Glue adapter: [elapsed 14.886482954025269s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:38.220149 [debug] [MainThread]: Glue adapter: [elapsed 16.111321926116943s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:39.416755 [debug] [MainThread]: Glue adapter: [elapsed 17.337528944015503s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:40.626568 [debug] [MainThread]: Glue adapter: [elapsed 18.537906885147095s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:41.825384 [debug] [MainThread]: Glue adapter: [elapsed 19.739346027374268s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:43.018831 [debug] [MainThread]: Glue adapter: [elapsed 20.945250034332275s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:44.202125 [debug] [MainThread]: Glue adapter: [elapsed 22.132955074310303s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:45.417101 [debug] [MainThread]: Glue adapter: [elapsed 23.332717895507812s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:46.616783 [debug] [MainThread]: Glue adapter: [elapsed 24.540029048919678s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:47.796101 [debug] [MainThread]: Glue adapter: [elapsed 25.732277870178223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:48.979910 [debug] [MainThread]: Glue adapter: [elapsed 26.905476093292236s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:50.171100 [debug] [MainThread]: Glue adapter: [elapsed 28.097341060638428s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:51.370379 [debug] [MainThread]: Glue adapter: [elapsed 29.287961959838867s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:52.845428 [debug] [MainThread]: Glue adapter: [elapsed 30.76172685623169s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:54.043997 [debug] [MainThread]: Glue adapter: [elapsed 31.957887887954712s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:55.260599 [debug] [MainThread]: Glue adapter: [elapsed 33.17207098007202s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:56.450600 [debug] [MainThread]: Glue adapter: [elapsed 34.381293058395386s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:57.646149 [debug] [MainThread]: Glue adapter: [elapsed 35.559746980667114s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:12:58.852248 [debug] [MainThread]: Glue adapter: [elapsed 36.77073693275452s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:00.680455 [debug] [MainThread]: Glue adapter: [elapsed 37.987452030181885s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:01.893570 [debug] [MainThread]: Glue adapter: [elapsed 39.79928684234619s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:03.107346 [debug] [MainThread]: Glue adapter: [elapsed 41.01548194885254s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:04.747549 [debug] [MainThread]: Glue adapter: [elapsed 42.64525508880615s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:05.932398 [debug] [MainThread]: Glue adapter: [elapsed 43.876976013183594s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:07.167578 [debug] [MainThread]: Glue adapter: [elapsed 45.05016374588013s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:08.372551 [debug] [MainThread]: Glue adapter: [elapsed 46.28462290763855s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:09.566416 [debug] [MainThread]: Glue adapter: [elapsed 47.492388010025024s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:10.760494 [debug] [MainThread]: Glue adapter: [elapsed 48.69289994239807s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:11.932966 [debug] [MainThread]: Glue adapter: [elapsed 49.86441373825073s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21ee627b-4855-4764-bd2e-24207e2b927c in STOPPING state
[0m13:13:13.064149 [info ] [MainThread]: 
[0m13:13:13.064958 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 12.48 seconds (132.48s).
[0m13:13:13.066471 [debug] [MainThread]: Command end result
[0m13:13:13.082199 [info ] [MainThread]: 
[0m13:13:13.082959 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:13:13.083495 [info ] [MainThread]: 
[0m13:13:13.084023 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m13:13:13.084507 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m13:13:13.085018 [error] [MainThread]:   
[0m13:13:13.085772 [error] [MainThread]:     
[0m13:13:13.086547 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:13:13.087400 [error] [MainThread]:     using PARQUET
[0m13:13:13.088022 [error] [MainThread]:   	
[0m13:13:13.088534 [error] [MainThread]:   	
[0m13:13:13.089744 [error] [MainThread]:   	
[0m13:13:13.091750 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m13:13:13.092681 [error] [MainThread]:   	
[0m13:13:13.095402 [error] [MainThread]:   	as
[0m13:13:13.096137 [error] [MainThread]:   	WITH source_avg as ( 
[0m13:13:13.096839 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m13:13:13.097492 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m13:13:13.098129 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m13:13:13.098754 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m13:13:13.099415 [error] [MainThread]:       , year(CAST(tpep_dropoff_datetime as LONG)) as year
[0m13:13:13.100091 [error] [MainThread]:       , month(CAST(tpep_dropoff_datetime as LONG)) as month
[0m13:13:13.100771 [error] [MainThread]:       , payment_type as type
[0m13:13:13.101420 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m13:13:13.102061 [error] [MainThread]:       --WHERE year = "2022"
[0m13:13:13.102739 [error] [MainThread]:       WHERE tpep_dropoff_datetime is not null
[0m13:13:13.103411 [error] [MainThread]:       --GROUP BY 5, 6, 7
[0m13:13:13.104068 [error] [MainThread]:       GROUP BY 5
[0m13:13:13.104808 [error] [MainThread]:   ) 
[0m13:13:13.105727 [error] [MainThread]:   SELECT *
[0m13:13:13.106431 [error] [MainThread]:   FROM source_avg
[0m13:13:13.107153 [error] [MainThread]:     '''), AnalysisException: cannot resolve 'year(CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT))' due to data type mismatch: argument 1 requires date type, however, 'CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT)' is of bigint type.; line 17 pos 6;
[0m13:13:13.107977 [error] [MainThread]:   'CreateTable `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists
[0m13:13:13.108642 [error] [MainThread]:   +- 'Project [*]
[0m13:13:13.110117 [error] [MainThread]:      +- 'SubqueryAlias source_avg
[0m13:13:13.110860 [error] [MainThread]:         +- 'Aggregate [unresolvedordinal(5)], [avg((cast((cast(tpep_dropoff_datetime#29 as bigint) - cast(tpep_pickup_datetime#28 as bigint)) as double) / cast(60 as double))) AS avg_duration#20, avg(passenger_count#30) AS avg_passenger_count#21, avg(trip_distance#31) AS avg_trip_distance#22, avg(total_amount#43) AS avg_total_amount#23, year(cast(tpep_dropoff_datetime#29 as bigint)) AS year#24, month(cast(tpep_dropoff_datetime#29 as bigint)) AS month#25, payment_type#36L AS type#26L]
[0m13:13:13.111888 [error] [MainThread]:            +- Filter isnotnull(tpep_dropoff_datetime#29)
[0m13:13:13.112633 [error] [MainThread]:               +- SubqueryAlias spark_catalog.nyctaxi.tripdata
[0m13:13:13.113341 [error] [MainThread]:                  +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#27L, tpep_pickup_datetime#28, tpep_dropoff_datetime#29, passenger_count#30, trip_distan..., Partition Cols: []]
[0m13:13:13.114103 [error] [MainThread]:   
[0m13:13:13.114686 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:13:13.115606 [info ] [MainThread]: 
[0m13:13:13.116456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m13:13:13.118345 [debug] [MainThread]: Command `dbt run` failed at 13:13:13.118033 after 133.39 seconds
[0m13:13:13.120637 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:13:13.121424 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:13:13.255527 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:13:13.327542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc626f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62ac487c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62a360850>]}
[0m13:13:13.328485 [debug] [MainThread]: Flushing usage events
[0m13:15:36.048952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefa7d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef8db1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefd335d00>]}


============================== 13:15:36.056177 | 06f6024f-a37a-4d95-bdc8-db588e66c56e ==============================
[0m13:15:36.056177 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:15:36.057166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'profile', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:36.405029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef8db1a60>]}
[0m13:15:36.427024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefda19f70>]}
[0m13:15:36.429991 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:15:36.466015 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:15:36.577925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:36.578851 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:15:36.667476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefddd20d0>]}
[0m13:15:36.682822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefdd4aca0>]}
[0m13:15:36.683499 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:15:36.684058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefdd4aac0>]}
[0m13:15:36.685860 [info ] [MainThread]: 
[0m13:15:36.686988 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:15:36.688483 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:15:36.689006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:36.689528 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (3366, 123145573888000)
[0m13:15:36.689987 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:15:36.690376 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:15:36.690755 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:15:37.733331 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:15:37.734200 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:15:37.737734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:15:37.738552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:37.940272 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:15:37.941161 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:15:37.942500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefdd3cd60>]}
[0m13:15:37.943301 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:15:37.943875 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:15:37.944916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:37.945525 [info ] [MainThread]: 
[0m13:15:37.954719 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:15:37.955502 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m13:15:37.956773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m13:15:37.957386 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:15:37.968917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:15:37.970423 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 13:15:37.957753 => 13:15:37.970058
[0m13:15:37.970951 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:15:37.995708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:38.182351 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:15:38.384446 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:15:38.386517 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:15:38.387213 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:15:38.532484 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:39.697472 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1676909923553467s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:40.853778 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.3113789558410645s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:41.998880 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4655349254608154s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:43.148122 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.610051870346069s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:44.296551 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.76394510269165s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:45.437504 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.902681827545166s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:46.583616 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.05098295211792s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:47.742725 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.207337141036987s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:48.880875 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.35242509841919s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:50.018045 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.490860939025879s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:51.159787 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.625200033187866s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:52.312291 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.774983882904053s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:53.460652 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.923714876174927s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:54.605567 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.07272720336914s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:55.752977 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.216237783432007s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:56.905543 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.374269008636475s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:58.039843 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.507138967514038s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:15:59.177788 [debug] [Thread-1  ]: Glue adapter: [elapsed 20.65017819404602s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:16:00.316423 [debug] [Thread-1  ]: Glue adapter: [elapsed 21.78352689743042s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:16:01.470367 [debug] [Thread-1  ]: Glue adapter: [elapsed 22.935118913650513s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:16:02.605605 [debug] [Thread-1  ]: Glue adapter: [elapsed 24.07642698287964s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in PROVISIONING state
[0m13:16:03.739745 [debug] [Thread-1  ]: Glue adapter: [elapsed 25.213634967803955s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in READY state
[0m13:16:03.813352 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:16:03.814284 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f
[0m13:16:14.969011 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:16:14.975958 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:16:14.976951 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:16:14.977852 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m13:16:19.994412 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279775148, 'CompletedOn': 1694279779819}, 'ResponseMetadata': {'RequestId': '99cea1db-d261-49f3-9a9f-c30eb9bad99f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:16:19 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '99cea1db-d261-49f3-9a9f-c30eb9bad99f'}, 'RetryAttempts': 0}}
[0m13:16:19.995489 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:16:19.996365 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:16:19.997271 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279775148, 'CompletedOn': 1694279779819}, 'ResponseMetadata': {'RequestId': '99cea1db-d261-49f3-9a9f-c30eb9bad99f', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:16:19 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '99cea1db-d261-49f3-9a9f-c30eb9bad99f'}, 'RetryAttempts': 0}}
[0m13:16:19.997981 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:16:19.998630 [debug] [Thread-1  ]: SQL status: OK in 42.0 seconds
[0m13:16:20.039523 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:16:20.040442 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:16:20.040905 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:16:20.041388 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:16:20.094248 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:16:20.095180 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f
[0m13:16:20.915210 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:16:20.916137 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:16:20.916799 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:16:20.917548 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m13:16:23.569273 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    --GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;\nCreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]\n+- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]\n   +- SubqueryAlias source_avg\n      +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]\n         +- Filter isnotnull(tpep_dropoff_datetime#14)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]\n", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;\nCreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]\n+- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]\n   +- SubqueryAlias source_avg\n      +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]\n         +- Filter isnotnull(tpep_dropoff_datetime#14)\n            +- SubqueryAlias spark_catalog.nyctaxi.tripdata\n               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]\n\n"]}, 'Progress': 1.0, 'StartedOn': 1694279781042, 'CompletedOn': 1694279782417}, 'ResponseMetadata': {'RequestId': '2ba9d01e-11c6-4fd3-bac1-ad0bcf350ad4', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:16:23 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '5684', 'connection': 'keep-alive', 'x-amzn-requestid': '2ba9d01e-11c6-4fd3-bac1-ad0bcf350ad4'}, 'RetryAttempts': 0}}
[0m13:16:23.570675 [debug] [Thread-1  ]: Glue adapter: status = error
[0m13:16:23.571641 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;
CreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]
+- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]
   +- SubqueryAlias source_avg
      +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]
         +- Filter isnotnull(tpep_dropoff_datetime#14)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]

[0m13:16:23.575085 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;
CreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]
+- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]
   +- SubqueryAlias source_avg
      +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]
         +- Filter isnotnull(tpep_dropoff_datetime#14)
            +- SubqueryAlias spark_catalog.nyctaxi.tripdata
               +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]

[0m13:16:23.576091 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    --GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:16:23.576820 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m13:16:23.577463 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:16:23.578067 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m13:16:23.578577 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:16:23.579271 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 13:15:37.971295 => 13:16:23.578991
[0m13:16:23.594719 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      , year(CAST(tpep_dropoff_datetime as timestamp)) as year
      , month(CAST(tpep_dropoff_datetime as timestamp)) as month
      , payment_type as type
      FROM nyctaxi.tripdata
      --WHERE year = "2022"
      WHERE tpep_dropoff_datetime is not null
      --GROUP BY 5, 6, 7
      --GROUP BY 5
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;
  CreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]
  +- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]
     +- SubqueryAlias source_avg
        +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]
           +- Filter isnotnull(tpep_dropoff_datetime#14)
              +- SubqueryAlias spark_catalog.nyctaxi.tripdata
                 +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]
  
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:16:23.597025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f6024f-a37a-4d95-bdc8-db588e66c56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeff533760>]}
[0m13:16:23.599543 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 45.64s]
[0m13:16:23.600696 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:16:23.602501 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:16:23.603659 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m13:16:23.604784 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:16:23.605714 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:16:23.606676 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m13:16:23.607659 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:16:23.608445 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:16:23.608963 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m13:16:23.609581 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:16:23.611601 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:23.612519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:23.613340 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (3366, 140704535110464)
[0m13:16:23.614068 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:16:23.614496 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m13:16:23.614952 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m13:16:24.295125 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:16:24.296051 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:16:24.296755 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:16:24.297396 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:24.297948 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:16:24.298471 [debug] [MainThread]: On master: Close
[0m13:16:24.299010 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:16:24.300119 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:16:24.300680 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:16:24.451308 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in READY state
[0m13:16:25.744590 [debug] [MainThread]: Glue adapter: [elapsed 1.3075649738311768s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:27.477669 [debug] [MainThread]: Glue adapter: [elapsed 3.037346124649048s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:28.668969 [debug] [MainThread]: Glue adapter: [elapsed 4.2466959953308105s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:29.879536 [debug] [MainThread]: Glue adapter: [elapsed 5.436269998550415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:31.076171 [debug] [MainThread]: Glue adapter: [elapsed 6.643683195114136s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:32.306414 [debug] [MainThread]: Glue adapter: [elapsed 7.841813087463379s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:33.489132 [debug] [MainThread]: Glue adapter: [elapsed 9.076774835586548s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:34.689891 [debug] [MainThread]: Glue adapter: [elapsed 10.254230976104736s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:36.275458 [debug] [MainThread]: Glue adapter: [elapsed 11.452888011932373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:37.709195 [debug] [MainThread]: Glue adapter: [elapsed 13.047161102294922s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:38.914899 [debug] [MainThread]: Glue adapter: [elapsed 14.477726936340332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:40.164669 [debug] [MainThread]: Glue adapter: [elapsed 15.676805019378662s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:41.361443 [debug] [MainThread]: Glue adapter: [elapsed 16.93182110786438s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:42.545070 [debug] [MainThread]: Glue adapter: [elapsed 18.11208701133728s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:43.743727 [debug] [MainThread]: Glue adapter: [elapsed 19.308543920516968s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:44.960979 [debug] [MainThread]: Glue adapter: [elapsed 20.511663913726807s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:46.164796 [debug] [MainThread]: Glue adapter: [elapsed 21.726339101791382s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:47.351680 [debug] [MainThread]: Glue adapter: [elapsed 22.935887098312378s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:48.572630 [debug] [MainThread]: Glue adapter: [elapsed 24.118459939956665s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:49.787184 [debug] [MainThread]: Glue adapter: [elapsed 25.348732948303223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:50.989731 [debug] [MainThread]: Glue adapter: [elapsed 26.556566953659058s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:52.193446 [debug] [MainThread]: Glue adapter: [elapsed 27.758063793182373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:53.459477 [debug] [MainThread]: Glue adapter: [elapsed 29.001115798950195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:54.624999 [debug] [MainThread]: Glue adapter: [elapsed 30.2221839427948s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:55.810359 [debug] [MainThread]: Glue adapter: [elapsed 31.37494921684265s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:57.003274 [debug] [MainThread]: Glue adapter: [elapsed 32.57426691055298s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:58.343513 [debug] [MainThread]: Glue adapter: [elapsed 33.892863035202026s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:16:59.550440 [debug] [MainThread]: Glue adapter: [elapsed 35.11611795425415s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:17:00.755693 [debug] [MainThread]: Glue adapter: [elapsed 36.31844997406006s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:17:01.962369 [debug] [MainThread]: Glue adapter: [elapsed 37.52376079559326s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-962ec592-e724-4b4c-828a-6059fbc6918f in STOPPING state
[0m13:17:03.137475 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:17:03.278352 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in READY state
[0m13:17:04.646786 [debug] [MainThread]: Glue adapter: [elapsed 1.3777999877929688s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:05.839063 [debug] [MainThread]: Glue adapter: [elapsed 2.579387903213501s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:07.031287 [debug] [MainThread]: Glue adapter: [elapsed 3.7643120288848877s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:08.226007 [debug] [MainThread]: Glue adapter: [elapsed 4.958454132080078s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:09.415562 [debug] [MainThread]: Glue adapter: [elapsed 6.149545907974243s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:10.618384 [debug] [MainThread]: Glue adapter: [elapsed 7.34820294380188s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:11.837022 [debug] [MainThread]: Glue adapter: [elapsed 8.555661916732788s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:13.060365 [debug] [MainThread]: Glue adapter: [elapsed 9.77295708656311s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:14.262728 [debug] [MainThread]: Glue adapter: [elapsed 10.996110916137695s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:15.513694 [debug] [MainThread]: Glue adapter: [elapsed 12.202939987182617s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:16.718929 [debug] [MainThread]: Glue adapter: [elapsed 13.449445962905884s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:17.924101 [debug] [MainThread]: Glue adapter: [elapsed 14.646939039230347s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:19.123317 [debug] [MainThread]: Glue adapter: [elapsed 15.858662843704224s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:20.358562 [debug] [MainThread]: Glue adapter: [elapsed 17.052961111068726s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:21.562773 [debug] [MainThread]: Glue adapter: [elapsed 18.290354013442993s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:22.774930 [debug] [MainThread]: Glue adapter: [elapsed 19.49175715446472s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:23.961186 [debug] [MainThread]: Glue adapter: [elapsed 20.69965696334839s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:25.155373 [debug] [MainThread]: Glue adapter: [elapsed 21.887000799179077s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:26.358582 [debug] [MainThread]: Glue adapter: [elapsed 23.09938907623291s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:27.568572 [debug] [MainThread]: Glue adapter: [elapsed 24.289788961410522s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:29.027106 [debug] [MainThread]: Glue adapter: [elapsed 25.751375913619995s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:30.249399 [debug] [MainThread]: Glue adapter: [elapsed 26.953763961791992s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:31.641893 [debug] [MainThread]: Glue adapter: [elapsed 28.177431106567383s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:32.845091 [debug] [MainThread]: Glue adapter: [elapsed 29.567562103271484s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:34.054314 [debug] [MainThread]: Glue adapter: [elapsed 30.778584957122803s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:35.256492 [debug] [MainThread]: Glue adapter: [elapsed 31.976452827453613s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:36.482913 [debug] [MainThread]: Glue adapter: [elapsed 33.20723509788513s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:37.698598 [debug] [MainThread]: Glue adapter: [elapsed 34.40273594856262s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:38.896200 [debug] [MainThread]: Glue adapter: [elapsed 35.628551959991455s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:40.090409 [debug] [MainThread]: Glue adapter: [elapsed 36.81858587265015s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:41.304775 [debug] [MainThread]: Glue adapter: [elapsed 38.02359986305237s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:43.320605 [debug] [MainThread]: Glue adapter: [elapsed 39.23858094215393s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:44.522820 [debug] [MainThread]: Glue adapter: [elapsed 41.245837926864624s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:45.727042 [debug] [MainThread]: Glue adapter: [elapsed 42.45550489425659s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:46.926423 [debug] [MainThread]: Glue adapter: [elapsed 43.65607786178589s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:48.123666 [debug] [MainThread]: Glue adapter: [elapsed 44.866055965423584s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:49.312587 [debug] [MainThread]: Glue adapter: [elapsed 46.052398920059204s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:50.532211 [debug] [MainThread]: Glue adapter: [elapsed 47.24737787246704s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:52.011121 [debug] [MainThread]: Glue adapter: [elapsed 48.46659517288208s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:53.209661 [debug] [MainThread]: Glue adapter: [elapsed 49.93335199356079s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:54.405722 [debug] [MainThread]: Glue adapter: [elapsed 51.13750600814819s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:55.608398 [debug] [MainThread]: Glue adapter: [elapsed 52.334534883499146s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPING state
[0m13:17:56.815288 [debug] [MainThread]: Glue adapter: [elapsed 53.537566900253296s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-7bcc4e87-d73f-49b2-a9b0-eb343bcef4fa in STOPPED state
[0m13:17:58.127656 [info ] [MainThread]: 
[0m13:17:58.128840 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 21.44 seconds (141.44s).
[0m13:17:58.131056 [debug] [MainThread]: Command end result
[0m13:17:58.150337 [info ] [MainThread]: 
[0m13:17:58.151020 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:17:58.151572 [info ] [MainThread]: 
[0m13:17:58.152094 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m13:17:58.152686 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m13:17:58.153379 [error] [MainThread]:   
[0m13:17:58.154078 [error] [MainThread]:     
[0m13:17:58.154762 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:17:58.155207 [error] [MainThread]:     using PARQUET
[0m13:17:58.155615 [error] [MainThread]:   	
[0m13:17:58.156015 [error] [MainThread]:   	
[0m13:17:58.156551 [error] [MainThread]:   	
[0m13:17:58.158240 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m13:17:58.159576 [error] [MainThread]:   	
[0m13:17:58.160369 [error] [MainThread]:   	as
[0m13:17:58.160930 [error] [MainThread]:   	WITH source_avg as ( 
[0m13:17:58.161373 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m13:17:58.161827 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m13:17:58.162234 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m13:17:58.162668 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m13:17:58.163302 [error] [MainThread]:       , year(CAST(tpep_dropoff_datetime as timestamp)) as year
[0m13:17:58.163930 [error] [MainThread]:       , month(CAST(tpep_dropoff_datetime as timestamp)) as month
[0m13:17:58.164695 [error] [MainThread]:       , payment_type as type
[0m13:17:58.165938 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m13:17:58.166804 [error] [MainThread]:       --WHERE year = "2022"
[0m13:17:58.167349 [error] [MainThread]:       WHERE tpep_dropoff_datetime is not null
[0m13:17:58.167904 [error] [MainThread]:       --GROUP BY 5, 6, 7
[0m13:17:58.168416 [error] [MainThread]:       --GROUP BY 5
[0m13:17:58.168916 [error] [MainThread]:   ) 
[0m13:17:58.169415 [error] [MainThread]:   SELECT *
[0m13:17:58.169927 [error] [MainThread]:   FROM source_avg
[0m13:17:58.170657 [error] [MainThread]:     '''), AnalysisException: grouping expressions sequence is empty, and 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' is not an aggregate function. Wrap '(avg((CAST((CAST(spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime AS BIGINT) - CAST(spark_catalog.nyctaxi.tripdata.tpep_pickup_datetime AS BIGINT)) AS DOUBLE) / CAST(60 AS DOUBLE))) AS avg_duration, avg(spark_catalog.nyctaxi.tripdata.passenger_count) AS avg_passenger_count, avg(spark_catalog.nyctaxi.tripdata.trip_distance) AS avg_trip_distance, avg(spark_catalog.nyctaxi.tripdata.total_amount) AS avg_total_amount)' in windowing function(s) or wrap 'spark_catalog.nyctaxi.tripdata.tpep_dropoff_datetime' in first() (or first_value) if you don't care which value you get.;
[0m13:17:58.172009 [error] [MainThread]:   CreateDataSourceTableAsSelectCommand `dbt_nyc_metrics`.`silver_nyctaxi_avg_metrics`, ErrorIfExists, [avg_duration, avg_passenger_count, avg_trip_distance, avg_total_amount, year, month, type]
[0m13:17:58.173515 [error] [MainThread]:   +- Project [avg_duration#5, avg_passenger_count#6, avg_trip_distance#7, avg_total_amount#8, year#9, month#10, type#11L]
[0m13:17:58.175095 [error] [MainThread]:      +- SubqueryAlias source_avg
[0m13:17:58.175976 [error] [MainThread]:         +- Aggregate [avg((cast((cast(tpep_dropoff_datetime#14 as bigint) - cast(tpep_pickup_datetime#13 as bigint)) as double) / cast(60 as double))) AS avg_duration#5, avg(passenger_count#15) AS avg_passenger_count#6, avg(trip_distance#16) AS avg_trip_distance#7, avg(total_amount#28) AS avg_total_amount#8, year(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS year#9, month(cast(cast(tpep_dropoff_datetime#14 as timestamp) as date)) AS month#10, payment_type#21L AS type#11L]
[0m13:17:58.178727 [error] [MainThread]:            +- Filter isnotnull(tpep_dropoff_datetime#14)
[0m13:17:58.180203 [error] [MainThread]:               +- SubqueryAlias spark_catalog.nyctaxi.tripdata
[0m13:17:58.181081 [error] [MainThread]:                  +- HiveTableRelation [`nyctaxi`.`tripdata`, org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, Data Cols: [vendorid#12L, tpep_pickup_datetime#13, tpep_dropoff_datetime#14, passenger_count#15, trip_distan..., Partition Cols: []]
[0m13:17:58.182053 [error] [MainThread]:   
[0m13:17:58.182765 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:17:58.183571 [info ] [MainThread]: 
[0m13:17:58.184508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m13:17:58.185665 [debug] [MainThread]: Command `dbt run` failed at 13:17:58.185463 after 142.17 seconds
[0m13:17:58.186427 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:17:58.187136 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:17:58.337875 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:17:58.403535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefa7d00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefdd4ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbefdd73be0>]}
[0m13:17:58.404392 [debug] [MainThread]: Flushing usage events
[0m13:18:09.133879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79fdfd00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79fbd96700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a00b73d90>]}


============================== 13:18:09.140532 | 41458b23-2a25-419c-82f9-ed647df8c22d ==============================
[0m13:18:09.140532 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:18:09.141309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:09.484460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79fbd96700>]}
[0m13:18:09.509669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a01259fd0>]}
[0m13:18:09.510843 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:18:09.538890 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:18:09.644696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:09.645485 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:18:09.734424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a015fb0d0>]}
[0m13:18:09.748456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0157cd30>]}
[0m13:18:09.749040 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:18:09.749504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0157cb50>]}
[0m13:18:09.751203 [info ] [MainThread]: 
[0m13:18:09.752120 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:18:09.753635 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:18:09.754318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:09.754779 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (3471, 123145591721984)
[0m13:18:09.755193 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:18:09.755574 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:18:09.755950 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:18:10.791920 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:18:10.792619 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:18:10.794783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:18:10.795539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:10.983841 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:18:10.984706 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:18:10.986065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0156ffa0>]}
[0m13:18:10.986868 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:18:10.987436 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:18:10.988527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:10.989162 [info ] [MainThread]: 
[0m13:18:10.997784 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:18:10.998667 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m13:18:10.999857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m13:18:11.000555 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:18:11.016751 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:18:11.017828 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 13:18:11.001036 => 13:18:11.017504
[0m13:18:11.018590 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:18:11.044049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:11.231528 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:18:11.430239 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:18:11.432297 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:18:11.432988 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:18:11.567020 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:12.725901 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1244280338287354s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:13.875424 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.297300100326538s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:15.019637 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.445707082748413s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:16.162941 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.585432052612305s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:17.290918 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.72199821472168s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:18.434046 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.861828088760376s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:19.561210 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.9941582679748535s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:21.236908 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.124443292617798s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:22.400333 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.828186273574829s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:23.575220 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.969283103942871s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:24.720381 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.142465114593506s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in PROVISIONING state
[0m13:18:25.864597 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.295098304748535s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in READY state
[0m13:18:25.937606 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:18:25.938523 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305
[0m13:18:34.858550 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:18:34.859511 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:18:34.860312 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:18:34.861198 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m13:18:44.490181 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279915056, 'CompletedOn': 1694279924024}, 'ResponseMetadata': {'RequestId': '6512a152-90c0-4188-b4fd-103f5bfff613', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:18:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '6512a152-90c0-4188-b4fd-103f5bfff613'}, 'RetryAttempts': 0}}
[0m13:18:44.491266 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:18:44.492140 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:18:44.493059 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694279915056, 'CompletedOn': 1694279924024}, 'ResponseMetadata': {'RequestId': '6512a152-90c0-4188-b4fd-103f5bfff613', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:18:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '6512a152-90c0-4188-b4fd-103f5bfff613'}, 'RetryAttempts': 0}}
[0m13:18:44.493769 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:18:44.494419 [debug] [Thread-1  ]: SQL status: OK in 33.0 seconds
[0m13:18:44.534521 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:18:44.535494 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:18:44.535961 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:18:44.536436 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:18:44.603302 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:18:44.604215 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305
[0m13:18:46.247026 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:18:46.247996 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:18:46.248801 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:18:46.249732 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m13:18:52.261974 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\tWITH source_avg as ( \n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': ''}, 'ExecutionCount': 5, 'Status': 'error', 'ErrorName': 'AnalysisException', 'ErrorValue': "CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.", 'Traceback': ['Traceback (most recent call last):\n', '  File "<stdin>", line 21, in execute\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/session.py", line 1034, in sql\n    return DataFrame(self._jsparkSession.sql(sqlQuery), self)\n', '  File "/opt/amazon/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py", line 1321, in __call__\n    return_value = get_return_value(\n', '  File "/opt/amazon/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 196, in deco\n    raise converted from None\n', "pyspark.sql.utils.AnalysisException: CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.\n"]}, 'Progress': 1.0, 'StartedOn': 1694279926449, 'CompletedOn': 1694279931308}, 'ResponseMetadata': {'RequestId': 'c3c2296a-df2f-4d98-9049-c53f7699421d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:18:52 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2426', 'connection': 'keep-alive', 'x-amzn-requestid': 'c3c2296a-df2f-4d98-9049-c53f7699421d'}, 'RetryAttempts': 0}}
[0m13:18:52.263164 [debug] [Thread-1  ]: Glue adapter: status = error
[0m13:18:52.264080 [error] [Thread-1  ]: Glue adapter: Glue returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.
[0m13:18:52.265482 [debug] [Thread-1  ]: Glue adapter: Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  '''), AnalysisException: CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.
[0m13:18:52.266901 [debug] [Thread-1  ]: Glue adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	WITH source_avg as ( 
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:18:52.267662 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m13:18:52.268319 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:18:52.268939 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m13:18:52.269570 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:18:52.270409 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 13:18:11.019168 => 13:18:52.270067
[0m13:18:52.286461 [debug] [Thread-1  ]: Database Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)
  Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
  
    
      create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
    using PARQUET
  	
  	
  	
  	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
  	
  	as
  	WITH source_avg as ( 
      SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
      , avg(passenger_count) as avg_passenger_count 
      , avg(trip_distance) as avg_trip_distance 
      , avg(total_amount) as avg_total_amount
      , year(CAST(tpep_dropoff_datetime as timestamp)) as year
      , month(CAST(tpep_dropoff_datetime as timestamp)) as month
      , payment_type as type
      FROM nyctaxi.tripdata
      --WHERE year = "2022"
      WHERE tpep_dropoff_datetime is not null
      GROUP BY 5, 6, 7
      --GROUP BY 5
  ) 
  SELECT *
  FROM source_avg
    '''), AnalysisException: CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.
  compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:18:52.287231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41458b23-2a25-419c-82f9-ed647df8c22d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a02d413a0>]}
[0m13:18:52.288020 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics  [[31mERROR[0m in 41.29s]
[0m13:18:52.289474 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:18:52.292074 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:18:52.292853 [info ] [Thread-1  ]: 2 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_cost_metrics ................. [[33mSKIP[0m]
[0m13:18:52.293411 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:18:52.293958 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:18:52.294542 [info ] [Thread-1  ]: 3 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_distance_metrics ............. [[33mSKIP[0m]
[0m13:18:52.295078 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:18:52.295592 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:18:52.296259 [info ] [Thread-1  ]: 4 of 4 SKIP relation dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ........... [[33mSKIP[0m]
[0m13:18:52.296976 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:18:52.298653 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:52.300072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:52.301544 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (3471, 140704535110464)
[0m13:18:52.302068 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:18:52.302480 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m13:18:52.302873 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m13:18:52.981613 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:18:52.982506 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:18:52.983197 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:18:52.983825 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:52.984367 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:18:52.984886 [debug] [MainThread]: On master: Close
[0m13:18:52.985419 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:18:52.986481 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:18:52.987031 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:18:53.128709 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in READY state
[0m13:18:54.460064 [debug] [MainThread]: Glue adapter: [elapsed 1.345546007156372s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:18:55.620255 [debug] [MainThread]: Glue adapter: [elapsed 2.528326988220215s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:18:56.821473 [debug] [MainThread]: Glue adapter: [elapsed 3.7018039226531982s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:18:58.009684 [debug] [MainThread]: Glue adapter: [elapsed 4.8956968784332275s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:18:59.201822 [debug] [MainThread]: Glue adapter: [elapsed 6.0935750007629395s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:00.372016 [debug] [MainThread]: Glue adapter: [elapsed 7.275256156921387s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:01.576324 [debug] [MainThread]: Glue adapter: [elapsed 8.442018985748291s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:02.787418 [debug] [MainThread]: Glue adapter: [elapsed 9.663615942001343s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:04.010586 [debug] [MainThread]: Glue adapter: [elapsed 10.870136022567749s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:05.189974 [debug] [MainThread]: Glue adapter: [elapsed 12.090044021606445s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:06.383176 [debug] [MainThread]: Glue adapter: [elapsed 13.270424127578735s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:07.564091 [debug] [MainThread]: Glue adapter: [elapsed 14.446593046188354s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:08.769320 [debug] [MainThread]: Glue adapter: [elapsed 15.646746158599854s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:09.970617 [debug] [MainThread]: Glue adapter: [elapsed 16.859707832336426s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:11.164846 [debug] [MainThread]: Glue adapter: [elapsed 18.057915925979614s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:12.447623 [debug] [MainThread]: Glue adapter: [elapsed 19.24889898300171s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:13.663513 [debug] [MainThread]: Glue adapter: [elapsed 20.533890962600708s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:15.529250 [debug] [MainThread]: Glue adapter: [elapsed 22.395244121551514s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:16.747488 [debug] [MainThread]: Glue adapter: [elapsed 23.62065100669861s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:17.966639 [debug] [MainThread]: Glue adapter: [elapsed 24.834968090057373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:19.182944 [debug] [MainThread]: Glue adapter: [elapsed 26.049177169799805s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:20.394088 [debug] [MainThread]: Glue adapter: [elapsed 27.261276960372925s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:21.611354 [debug] [MainThread]: Glue adapter: [elapsed 28.482625007629395s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:22.813650 [debug] [MainThread]: Glue adapter: [elapsed 29.69617009162903s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:24.035833 [debug] [MainThread]: Glue adapter: [elapsed 30.903954029083252s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:25.234839 [debug] [MainThread]: Glue adapter: [elapsed 32.12546110153198s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-f713bbcc-45e4-4e4f-976c-05b26e6e0305 in STOPPING state
[0m13:19:26.387310 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:19:26.532262 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in READY state
[0m13:19:27.920701 [debug] [MainThread]: Glue adapter: [elapsed 1.3910768032073975s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:29.148909 [debug] [MainThread]: Glue adapter: [elapsed 2.6144487857818604s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:30.369756 [debug] [MainThread]: Glue adapter: [elapsed 3.8451929092407227s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:31.569271 [debug] [MainThread]: Glue adapter: [elapsed 5.057565927505493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:32.776717 [debug] [MainThread]: Glue adapter: [elapsed 6.249035835266113s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:34.005758 [debug] [MainThread]: Glue adapter: [elapsed 7.474456787109375s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:35.224951 [debug] [MainThread]: Glue adapter: [elapsed 8.70403265953064s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:36.469293 [debug] [MainThread]: Glue adapter: [elapsed 9.902734756469727s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:38.042858 [debug] [MainThread]: Glue adapter: [elapsed 11.521724939346313s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:39.251009 [debug] [MainThread]: Glue adapter: [elapsed 12.725076913833618s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:40.472810 [debug] [MainThread]: Glue adapter: [elapsed 13.938702821731567s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:41.711572 [debug] [MainThread]: Glue adapter: [elapsed 15.173957824707031s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:42.925803 [debug] [MainThread]: Glue adapter: [elapsed 16.39633083343506s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:44.149981 [debug] [MainThread]: Glue adapter: [elapsed 17.618733882904053s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:45.360191 [debug] [MainThread]: Glue adapter: [elapsed 18.84153389930725s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:46.567422 [debug] [MainThread]: Glue adapter: [elapsed 20.05102801322937s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:47.781814 [debug] [MainThread]: Glue adapter: [elapsed 21.25223398208618s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:48.985874 [debug] [MainThread]: Glue adapter: [elapsed 22.473474740982056s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:50.182327 [debug] [MainThread]: Glue adapter: [elapsed 23.667810678482056s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:51.390204 [debug] [MainThread]: Glue adapter: [elapsed 24.86729669570923s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:52.593392 [debug] [MainThread]: Glue adapter: [elapsed 26.075188875198364s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:53.818822 [debug] [MainThread]: Glue adapter: [elapsed 27.27535080909729s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:55.038588 [debug] [MainThread]: Glue adapter: [elapsed 28.50746989250183s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:56.249107 [debug] [MainThread]: Glue adapter: [elapsed 29.719766855239868s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:57.446328 [debug] [MainThread]: Glue adapter: [elapsed 30.925119876861572s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:58.655614 [debug] [MainThread]: Glue adapter: [elapsed 32.1238899230957s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:19:59.863750 [debug] [MainThread]: Glue adapter: [elapsed 33.33383584022522s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:01.094949 [debug] [MainThread]: Glue adapter: [elapsed 34.547247886657715s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:02.308308 [debug] [MainThread]: Glue adapter: [elapsed 35.778525829315186s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:03.527706 [debug] [MainThread]: Glue adapter: [elapsed 36.99444103240967s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:04.739675 [debug] [MainThread]: Glue adapter: [elapsed 38.21515703201294s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:06.024944 [debug] [MainThread]: Glue adapter: [elapsed 39.429266929626465s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:07.228472 [debug] [MainThread]: Glue adapter: [elapsed 40.70287275314331s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:09.185690 [debug] [MainThread]: Glue adapter: [elapsed 42.6568169593811s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:10.397356 [debug] [MainThread]: Glue adapter: [elapsed 43.87405276298523s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:11.596511 [debug] [MainThread]: Glue adapter: [elapsed 45.07408881187439s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:12.809809 [debug] [MainThread]: Glue adapter: [elapsed 46.28544783592224s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-fc512257-caea-4a8f-b59e-216cc80d1d45 in STOPPING state
[0m13:20:13.958676 [info ] [MainThread]: 
[0m13:20:13.959793 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 4.21 seconds (124.21s).
[0m13:20:13.961889 [debug] [MainThread]: Command end result
[0m13:20:13.984458 [info ] [MainThread]: 
[0m13:20:13.985212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:13.986103 [info ] [MainThread]: 
[0m13:20:13.987570 [error] [MainThread]: [33mDatabase Error in model silver_nyctaxi_avg_metrics (models/silver_metrics/silver_nyctaxi_avg_metrics.sql)[0m
[0m13:20:13.989294 [error] [MainThread]:   Glue cursor returned `error` for statement None for code SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
[0m13:20:13.990178 [error] [MainThread]:   
[0m13:20:13.990981 [error] [MainThread]:     
[0m13:20:13.991694 [error] [MainThread]:       create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:20:13.992199 [error] [MainThread]:     using PARQUET
[0m13:20:13.993019 [error] [MainThread]:   	
[0m13:20:13.993855 [error] [MainThread]:   	
[0m13:20:13.995401 [error] [MainThread]:   	
[0m13:20:13.996407 [error] [MainThread]:   	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
[0m13:20:13.997798 [error] [MainThread]:   	
[0m13:20:13.998225 [error] [MainThread]:   	as
[0m13:20:13.998661 [error] [MainThread]:   	WITH source_avg as ( 
[0m13:20:13.999657 [error] [MainThread]:       SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
[0m13:20:14.001575 [error] [MainThread]:       , avg(passenger_count) as avg_passenger_count 
[0m13:20:14.002133 [error] [MainThread]:       , avg(trip_distance) as avg_trip_distance 
[0m13:20:14.002797 [error] [MainThread]:       , avg(total_amount) as avg_total_amount
[0m13:20:14.003552 [error] [MainThread]:       , year(CAST(tpep_dropoff_datetime as timestamp)) as year
[0m13:20:14.005115 [error] [MainThread]:       , month(CAST(tpep_dropoff_datetime as timestamp)) as month
[0m13:20:14.006282 [error] [MainThread]:       , payment_type as type
[0m13:20:14.006981 [error] [MainThread]:       FROM nyctaxi.tripdata
[0m13:20:14.007416 [error] [MainThread]:       --WHERE year = "2022"
[0m13:20:14.007867 [error] [MainThread]:       WHERE tpep_dropoff_datetime is not null
[0m13:20:14.008287 [error] [MainThread]:       GROUP BY 5, 6, 7
[0m13:20:14.008687 [error] [MainThread]:       --GROUP BY 5
[0m13:20:14.009084 [error] [MainThread]:   ) 
[0m13:20:14.009480 [error] [MainThread]:   SELECT *
[0m13:20:14.009868 [error] [MainThread]:   FROM source_avg
[0m13:20:14.010271 [error] [MainThread]:     '''), AnalysisException: CREATE-TABLE-AS-SELECT cannot create table with location to a non-empty directory s3://ikoch-lakeformation-db/nyctaxi-data-out/dbt_nyc_metrics/silver_nyctaxi_avg_metrics . To allow overwriting the existing non-empty directory, set 'spark.sql.legacy.allowNonEmptyLocationInCTAS' to true.
[0m13:20:14.010675 [error] [MainThread]:   compiled Code at target/run/dbtgluenyctaxidemo/models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:20:14.011104 [info ] [MainThread]: 
[0m13:20:14.011805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m13:20:14.013323 [debug] [MainThread]: Command `dbt run` failed at 13:20:14.013096 after 124.91 seconds
[0m13:20:14.014072 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:20:14.014491 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:20:14.139391 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:20:14.203358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79fdfd00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0157ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a02e02df0>]}
[0m13:20:14.204342 [debug] [MainThread]: Flushing usage events
[0m13:23:09.675738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff757fd0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff755c8c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75ab74dc0>]}


============================== 13:23:09.681496 | 25ae5543-4005-4e34-84f7-070208b3e0f6 ==============================
[0m13:23:09.681496 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:23:09.682378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:23:10.129312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff755c8c700>]}
[0m13:23:10.153205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b262070>]}
[0m13:23:10.154454 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:23:10.185034 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:23:10.293113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:10.293906 [debug] [MainThread]: Partial parsing: updated file: dbtgluenyctaxidemo://models/silver_metrics/silver_nyctaxi_avg_metrics.sql
[0m13:23:10.382892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b65ad60>]}
[0m13:23:10.398889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b58ad60>]}
[0m13:23:10.399469 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:23:10.399922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b58ab80>]}
[0m13:23:10.402094 [info ] [MainThread]: 
[0m13:23:10.403392 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:23:10.404867 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m13:23:10.405442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:10.406241 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (3580, 123145499029504)
[0m13:23:10.407482 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:23:10.408557 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:23:10.408976 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:23:11.455706 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m13:23:11.456674 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:23:11.459123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m13:23:11.459696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:11.613883 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:23:11.614733 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:23:11.616173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b57cfd0>]}
[0m13:23:11.616956 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:23:11.617544 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:23:11.618610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:11.619335 [info ] [MainThread]: 
[0m13:23:11.628613 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:23:11.629649 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m13:23:11.630970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m13:23:11.631552 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:23:11.644226 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:23:11.645347 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 13:23:11.631917 => 13:23:11.645066
[0m13:23:11.645992 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:23:11.674424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:11.873758 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:23:11.887172 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:23:11.887719 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:23:11.888177 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      
[0m13:23:12.023290 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:13.161784 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1367990970611572s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:14.304410 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.273130178451538s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:15.444467 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.420072317123413s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:16.580488 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.555585145950317s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:17.723751 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.696348190307617s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:18.867906 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.840471029281616s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:20.039010 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.016586065292358s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:21.179140 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.153825044631958s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:22.333440 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.308858156204224s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:23.478478 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.451064109802246s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:24.628642 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.59977126121521s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:25.767793 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.746562242507935s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:26.920941 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.886374235153198s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:28.063145 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.036938190460205s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:29.204183 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.181734323501587s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:30.367392 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.33893132209778s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:31.502771 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.482441425323486s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:32.642752 [debug] [Thread-1  ]: Glue adapter: [elapsed 20.61599826812744s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:33.822865 [debug] [Thread-1  ]: Glue adapter: [elapsed 21.764419078826904s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:34.962020 [debug] [Thread-1  ]: Glue adapter: [elapsed 22.941163063049316s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:36.102028 [debug] [Thread-1  ]: Glue adapter: [elapsed 24.074682235717773s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in PROVISIONING state
[0m13:23:37.286473 [debug] [Thread-1  ]: Glue adapter: [elapsed 25.252660989761353s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in READY state
[0m13:23:37.353386 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:23:37.354314 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:23:48.816844 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:23:48.817819 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:23:48.818624 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:23:48.819509 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      ''')
[0m13:23:55.080254 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true\n      \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"key": "spark.sql.legacy.allowNonEmptyLocationInCTAS", "value": "true"}}], "description": [{"name": "key", "type": "StringType()"}, {"name": "value", "type": "StringType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280228969, 'CompletedOn': 1694280233944}, 'ResponseMetadata': {'RequestId': 'a2f9700f-3344-4e40-b03c-95c3e12010f9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:23:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '770', 'connection': 'keep-alive', 'x-amzn-requestid': 'a2f9700f-3344-4e40-b03c-95c3e12010f9'}, 'RetryAttempts': 0}}
[0m13:23:55.081300 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:23:55.082123 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:23:55.082917 [debug] [Thread-1  ]: SQL status: OK in 43.0 seconds
[0m13:23:55.265808 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:23:55.267981 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:23:55.268679 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m13:23:55.340434 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:23:55.341357 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:23:57.151243 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:23:57.152198 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:23:57.152999 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:23:57.153894 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m13:23:58.518681 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280237292, 'CompletedOn': 1694280237717}, 'ResponseMetadata': {'RequestId': '4f50dcff-fa13-48c9-a870-e963bce0187d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:23:58 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '4f50dcff-fa13-48c9-a870-e963bce0187d'}, 'RetryAttempts': 0}}
[0m13:23:58.519729 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:23:58.520604 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:23:58.521520 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280237292, 'CompletedOn': 1694280237717}, 'ResponseMetadata': {'RequestId': '4f50dcff-fa13-48c9-a870-e963bce0187d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:23:58 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '4f50dcff-fa13-48c9-a870-e963bce0187d'}, 'RetryAttempts': 0}}
[0m13:23:58.522235 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:23:58.522871 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m13:23:58.563586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:23:58.564495 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:23:58.564997 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m13:23:58.635750 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:23:58.636667 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:00.406598 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:00.407561 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:00.408372 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:00.409306 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m13:24:22.713627 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280240577, 'CompletedOn': 1694280261678}, 'ResponseMetadata': {'RequestId': '1df76a27-dd30-491b-9765-960ebe5293b1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:22 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '1df76a27-dd30-491b-9765-960ebe5293b1'}, 'RetryAttempts': 0}}
[0m13:24:22.714813 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:22.715761 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:22.716754 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280240577, 'CompletedOn': 1694280261678}, 'ResponseMetadata': {'RequestId': '1df76a27-dd30-491b-9765-960ebe5293b1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:22 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '1df76a27-dd30-491b-9765-960ebe5293b1'}, 'RetryAttempts': 0}}
[0m13:24:22.717553 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:22.718186 [debug] [Thread-1  ]: SQL status: OK in 24.0 seconds
[0m13:24:22.740850 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 13:23:11.646514 => 13:24:22.740603
[0m13:24:22.741378 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m13:24:22.741841 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:24:22.742278 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m13:24:22.742725 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:24:22.743546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75d6c7e80>]}
[0m13:24:22.750117 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 71.11s]
[0m13:24:22.751946 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:24:22.754118 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:24:22.754995 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m13:24:22.756296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m13:24:22.756990 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:24:22.763081 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m13:24:22.764206 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 13:24:22.757462 => 13:24:22.763907
[0m13:24:22.764754 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:24:22.768136 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:22.972646 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:23.160700 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:23.162781 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m13:24:23.163503 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m13:24:23.236473 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:23.237383 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:23.837621 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:23.838583 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:23.839399 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:23.840099 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m13:24:25.375740 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280263976, 'CompletedOn': 1694280264387}, 'ResponseMetadata': {'RequestId': '684c0630-f6a0-4300-9104-be5666db6db9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:25 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '920', 'connection': 'keep-alive', 'x-amzn-requestid': '684c0630-f6a0-4300-9104-be5666db6db9'}, 'RetryAttempts': 0}}
[0m13:24:25.376808 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:25.377689 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:25.378550 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280263976, 'CompletedOn': 1694280264387}, 'ResponseMetadata': {'RequestId': '684c0630-f6a0-4300-9104-be5666db6db9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:25 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '920', 'connection': 'keep-alive', 'x-amzn-requestid': '684c0630-f6a0-4300-9104-be5666db6db9'}, 'RetryAttempts': 0}}
[0m13:24:25.379270 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:25.379907 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m13:24:25.390105 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m13:24:25.391098 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:24:25.391621 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m13:24:25.392157 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m13:24:25.564318 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:25.564982 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:26.224455 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:26.225478 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:26.226344 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:26.227349 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m13:24:29.815229 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280266359, 'CompletedOn': 1694280269461}, 'ResponseMetadata': {'RequestId': '3722bdea-9dc2-4f7c-bd52-4aad26172290', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:29 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '3722bdea-9dc2-4f7c-bd52-4aad26172290'}, 'RetryAttempts': 0}}
[0m13:24:29.816371 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:29.817271 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:29.818260 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280266359, 'CompletedOn': 1694280269461}, 'ResponseMetadata': {'RequestId': '3722bdea-9dc2-4f7c-bd52-4aad26172290', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:29 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '3722bdea-9dc2-4f7c-bd52-4aad26172290'}, 'RetryAttempts': 0}}
[0m13:24:29.819027 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:29.819652 [debug] [Thread-1  ]: SQL status: OK in 4.0 seconds
[0m13:24:29.823814 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 13:24:22.765139 => 13:24:29.823483
[0m13:24:29.824452 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m13:24:29.824967 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:24:29.825465 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m13:24:29.825972 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:24:29.826921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75d6d5790>]}
[0m13:24:29.827660 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics .... [[32mOK[0m in 7.07s]
[0m13:24:29.828487 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:24:29.829110 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:24:29.829792 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m13:24:29.830727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m13:24:29.831287 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:24:29.834944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m13:24:29.835817 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 13:24:29.831661 => 13:24:29.835575
[0m13:24:29.836270 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:24:29.838838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:30.038624 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:30.222787 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:30.224807 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m13:24:30.225496 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m13:24:30.305643 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:30.306558 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:32.083963 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:32.084753 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:32.085393 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:32.086092 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m13:24:33.567956 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280272236, 'CompletedOn': 1694280272593}, 'ResponseMetadata': {'RequestId': 'b8a735bb-0503-4480-bfe2-0d654456bf49', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': 'b8a735bb-0503-4480-bfe2-0d654456bf49'}, 'RetryAttempts': 0}}
[0m13:24:33.569016 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:33.569890 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:33.570764 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280272236, 'CompletedOn': 1694280272593}, 'ResponseMetadata': {'RequestId': 'b8a735bb-0503-4480-bfe2-0d654456bf49', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:33 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': 'b8a735bb-0503-4480-bfe2-0d654456bf49'}, 'RetryAttempts': 0}}
[0m13:24:33.571479 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:33.572117 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m13:24:33.583845 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m13:24:33.584840 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:24:33.585316 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m13:24:33.585770 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m13:24:33.654970 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:33.655881 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:34.199440 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:34.200377 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:34.201172 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:34.202054 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m13:24:37.047571 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280274319, 'CompletedOn': 1694280276690}, 'ResponseMetadata': {'RequestId': '9f622a95-467e-47f2-b9e1-c2a098e9fded', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:37 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '9f622a95-467e-47f2-b9e1-c2a098e9fded'}, 'RetryAttempts': 0}}
[0m13:24:37.048664 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:37.049566 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:37.050526 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280274319, 'CompletedOn': 1694280276690}, 'ResponseMetadata': {'RequestId': '9f622a95-467e-47f2-b9e1-c2a098e9fded', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:37 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '9f622a95-467e-47f2-b9e1-c2a098e9fded'}, 'RetryAttempts': 0}}
[0m13:24:37.051279 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:37.051909 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m13:24:37.055957 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 13:24:29.836585 => 13:24:37.055629
[0m13:24:37.056623 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m13:24:37.057135 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:24:37.057624 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m13:24:37.058127 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:24:37.059023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75d75f2e0>]}
[0m13:24:37.059760 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[32mOK[0m in 7.23s]
[0m13:24:37.060574 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:24:37.061261 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:24:37.062001 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m13:24:37.063601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m13:24:37.064754 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:24:37.069977 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m13:24:37.070961 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 13:24:37.065123 => 13:24:37.070710
[0m13:24:37.071427 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:24:37.074563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:37.304897 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:37.566901 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m13:24:37.569032 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m13:24:37.569742 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m13:24:37.638488 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:37.639257 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:38.378651 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:38.379604 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:38.380401 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:38.381269 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m13:24:38.994973 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280278531, 'CompletedOn': 1694280278851}, 'ResponseMetadata': {'RequestId': 'a7e89e1c-2b9b-4987-90f6-77a8389a28dd', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'a7e89e1c-2b9b-4987-90f6-77a8389a28dd'}, 'RetryAttempts': 0}}
[0m13:24:38.996021 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:38.996887 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:38.997795 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280278531, 'CompletedOn': 1694280278851}, 'ResponseMetadata': {'RequestId': 'a7e89e1c-2b9b-4987-90f6-77a8389a28dd', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'a7e89e1c-2b9b-4987-90f6-77a8389a28dd'}, 'RetryAttempts': 0}}
[0m13:24:38.998512 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:38.999150 [debug] [Thread-1  ]: SQL status: OK in 1.0 seconds
[0m13:24:39.009502 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m13:24:39.010485 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m13:24:39.011017 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m13:24:39.011549 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m13:24:39.081387 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m13:24:39.082300 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a
[0m13:24:39.774926 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m13:24:39.775876 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m13:24:39.776577 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m13:24:39.777307 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m13:24:42.347777 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280279912, 'CompletedOn': 1694280282242}, 'ResponseMetadata': {'RequestId': '7f3997e3-24f0-4693-8518-58f3ef0368ad', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:42 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '7f3997e3-24f0-4693-8518-58f3ef0368ad'}, 'RetryAttempts': 0}}
[0m13:24:42.348886 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m13:24:42.349789 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m13:24:42.350754 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694280279912, 'CompletedOn': 1694280282242}, 'ResponseMetadata': {'RequestId': '7f3997e3-24f0-4693-8518-58f3ef0368ad', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 17:24:42 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '7f3997e3-24f0-4693-8518-58f3ef0368ad'}, 'RetryAttempts': 0}}
[0m13:24:42.351509 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m13:24:42.352133 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m13:24:42.356260 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 13:24:37.071846 => 13:24:42.355931
[0m13:24:42.356910 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m13:24:42.357421 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m13:24:42.357910 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m13:24:42.358411 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m13:24:42.359374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ae5543-4005-4e34-84f7-070208b3e0f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75d78b940>]}
[0m13:24:42.360120 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[32mOK[0m in 5.30s]
[0m13:24:42.360933 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:24:42.362638 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:42.363116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:42.363575 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (3580, 140704535110464)
[0m13:24:42.364022 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m13:24:42.364471 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m13:24:42.364912 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m13:24:43.091205 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:24:43.091934 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m13:24:43.092482 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m13:24:43.093030 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:43.093572 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m13:24:43.094092 [debug] [MainThread]: On master: Close
[0m13:24:43.094638 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m13:24:43.095705 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:24:43.096269 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:24:43.238405 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in READY state
[0m13:24:44.632701 [debug] [MainThread]: Glue adapter: [elapsed 1.4090869426727295s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:45.855299 [debug] [MainThread]: Glue adapter: [elapsed 2.6249890327453613s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:47.055361 [debug] [MainThread]: Glue adapter: [elapsed 3.814647912979126s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:48.278497 [debug] [MainThread]: Glue adapter: [elapsed 5.0345778465271s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:49.498663 [debug] [MainThread]: Glue adapter: [elapsed 6.258364915847778s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:50.722679 [debug] [MainThread]: Glue adapter: [elapsed 7.48029899597168s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:51.974206 [debug] [MainThread]: Glue adapter: [elapsed 8.731165885925293s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:53.177782 [debug] [MainThread]: Glue adapter: [elapsed 9.945920944213867s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:54.400621 [debug] [MainThread]: Glue adapter: [elapsed 11.15995192527771s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:55.620014 [debug] [MainThread]: Glue adapter: [elapsed 12.378359079360962s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:56.836179 [debug] [MainThread]: Glue adapter: [elapsed 13.59678602218628s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:58.054335 [debug] [MainThread]: Glue adapter: [elapsed 14.814231157302856s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:24:59.273530 [debug] [MainThread]: Glue adapter: [elapsed 16.03516697883606s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:00.501797 [debug] [MainThread]: Glue adapter: [elapsed 17.238110065460205s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:01.703969 [debug] [MainThread]: Glue adapter: [elapsed 18.46259307861328s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:02.916168 [debug] [MainThread]: Glue adapter: [elapsed 19.671128749847412s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:04.122370 [debug] [MainThread]: Glue adapter: [elapsed 20.896587133407593s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:05.341635 [debug] [MainThread]: Glue adapter: [elapsed 22.100247144699097s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:06.546165 [debug] [MainThread]: Glue adapter: [elapsed 23.318192958831787s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:07.805115 [debug] [MainThread]: Glue adapter: [elapsed 24.51769709587097s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:09.023344 [debug] [MainThread]: Glue adapter: [elapsed 25.792290925979614s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:10.250593 [debug] [MainThread]: Glue adapter: [elapsed 27.002152919769287s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:11.471798 [debug] [MainThread]: Glue adapter: [elapsed 28.232161045074463s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:12.688102 [debug] [MainThread]: Glue adapter: [elapsed 29.440956830978394s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:13.913364 [debug] [MainThread]: Glue adapter: [elapsed 30.671395778656006s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:15.128469 [debug] [MainThread]: Glue adapter: [elapsed 31.88732075691223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:16.368494 [debug] [MainThread]: Glue adapter: [elapsed 33.12499690055847s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:17.589976 [debug] [MainThread]: Glue adapter: [elapsed 34.34984493255615s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:18.833336 [debug] [MainThread]: Glue adapter: [elapsed 35.57670617103577s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:20.066405 [debug] [MainThread]: Glue adapter: [elapsed 36.828322887420654s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:21.306702 [debug] [MainThread]: Glue adapter: [elapsed 38.05375599861145s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:22.567967 [debug] [MainThread]: Glue adapter: [elapsed 39.281006813049316s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:23.812197 [debug] [MainThread]: Glue adapter: [elapsed 40.56792497634888s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:25.017539 [debug] [MainThread]: Glue adapter: [elapsed 41.790520906448364s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:26.233644 [debug] [MainThread]: Glue adapter: [elapsed 42.996442794799805s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:27.413170 [debug] [MainThread]: Glue adapter: [elapsed 44.198817014694214s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:28.597060 [debug] [MainThread]: Glue adapter: [elapsed 45.384899854660034s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:29.808233 [debug] [MainThread]: Glue adapter: [elapsed 46.57061409950256s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:31.028561 [debug] [MainThread]: Glue adapter: [elapsed 47.78750276565552s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:32.231678 [debug] [MainThread]: Glue adapter: [elapsed 49.00783586502075s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:33.426103 [debug] [MainThread]: Glue adapter: [elapsed 50.20068693161011s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:34.648135 [debug] [MainThread]: Glue adapter: [elapsed 51.4089138507843s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:35.871298 [debug] [MainThread]: Glue adapter: [elapsed 52.62237906455994s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-afed0e0f-b192-4db6-9fc0-c8fb7b9d7c8a in STOPPING state
[0m13:25:37.008108 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:25:37.196752 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in READY state
[0m13:25:38.613134 [debug] [MainThread]: Glue adapter: [elapsed 1.4561288356781006s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:39.837298 [debug] [MainThread]: Glue adapter: [elapsed 2.6820220947265625s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:41.081900 [debug] [MainThread]: Glue adapter: [elapsed 3.911688804626465s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:42.287207 [debug] [MainThread]: Glue adapter: [elapsed 5.148578882217407s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:43.485595 [debug] [MainThread]: Glue adapter: [elapsed 6.337033987045288s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:44.713135 [debug] [MainThread]: Glue adapter: [elapsed 7.560860872268677s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:45.936387 [debug] [MainThread]: Glue adapter: [elapsed 8.776429891586304s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:47.143742 [debug] [MainThread]: Glue adapter: [elapsed 9.995862007141113s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:48.359472 [debug] [MainThread]: Glue adapter: [elapsed 11.211315870285034s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:49.577335 [debug] [MainThread]: Glue adapter: [elapsed 12.42847990989685s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:50.814705 [debug] [MainThread]: Glue adapter: [elapsed 13.644547939300537s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:52.436953 [debug] [MainThread]: Glue adapter: [elapsed 15.283252954483032s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:53.655106 [debug] [MainThread]: Glue adapter: [elapsed 16.501831769943237s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:54.862208 [debug] [MainThread]: Glue adapter: [elapsed 17.73193383216858s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:56.097336 [debug] [MainThread]: Glue adapter: [elapsed 18.9199538230896s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:57.301085 [debug] [MainThread]: Glue adapter: [elapsed 20.165474891662598s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:58.511390 [debug] [MainThread]: Glue adapter: [elapsed 21.36056113243103s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:25:59.722936 [debug] [MainThread]: Glue adapter: [elapsed 22.571950912475586s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:00.941124 [debug] [MainThread]: Glue adapter: [elapsed 23.788803100585938s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:02.195626 [debug] [MainThread]: Glue adapter: [elapsed 25.013492822647095s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:03.398283 [debug] [MainThread]: Glue adapter: [elapsed 26.25479292869568s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:04.639618 [debug] [MainThread]: Glue adapter: [elapsed 27.46393394470215s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:05.851512 [debug] [MainThread]: Glue adapter: [elapsed 28.705811977386475s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:07.061456 [debug] [MainThread]: Glue adapter: [elapsed 29.908225059509277s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:08.281294 [debug] [MainThread]: Glue adapter: [elapsed 31.131639003753662s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dc1dd3dd-a5d8-4325-95b2-930134771898 in STOPPING state
[0m13:26:09.724143 [info ] [MainThread]: 
[0m13:26:09.728836 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 59.32 seconds (179.32s).
[0m13:26:09.732263 [debug] [MainThread]: Command end result
[0m13:26:09.753231 [info ] [MainThread]: 
[0m13:26:09.754207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:09.754940 [info ] [MainThread]: 
[0m13:26:09.755849 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:26:09.757218 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:09.756940 after 180.12 seconds
[0m13:26:09.758189 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:26:09.758898 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:26:09.833656 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:26:09.896688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff757fd0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b57ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75b5ede50>]}
[0m13:26:09.897836 [debug] [MainThread]: Flushing usage events
[0m13:43:02.498377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933dbebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933ab8c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933f374e20>]}


============================== 13:43:02.504157 | fc0591ee-6345-4eb9-81ab-79e75b01ee12 ==============================
[0m13:43:02.504157 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:43:02.504841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir profile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:02.964906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933ab8c6a0>]}
[0m13:43:02.987609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933fa620d0>]}
[0m13:43:02.988849 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m13:43:03.025230 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:43:03.133677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:03.134212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:03.141292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933fac60d0>]}
[0m13:43:03.147146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933fc7cd90>]}
[0m13:43:03.148248 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m13:43:03.149060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933fc7ce50>]}
[0m13:43:03.151543 [info ] [MainThread]: 
[0m13:43:03.152815 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m13:43:03.154605 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics_dbt_nyc_metrics'
[0m13:43:03.155610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:03.156597 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (3987, 123145377239040)
[0m13:43:03.157450 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m13:43:03.158064 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m13:43:03.158519 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m13:43:04.336983 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m13:43:04.337700 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:43:04.340068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0591ee-6345-4eb9-81ab-79e75b01ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933fa62370>]}
[0m13:43:04.341318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:04.341920 [info ] [MainThread]: 
[0m13:43:04.345709 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:43:04.346756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m13:43:04.347321 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:43:04.360906 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m13:43:04.362156 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 13:43:04.347712 => 13:43:04.361783
[0m13:43:04.362641 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:43:04.363206 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 13:43:04.362965 => 13:43:04.362984
[0m13:43:04.364608 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m13:43:04.365539 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:43:04.366359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m13:43:04.366833 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:43:04.373011 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m13:43:04.374070 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 13:43:04.367195 => 13:43:04.373809
[0m13:43:04.374535 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:43:04.375082 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 13:43:04.374854 => 13:43:04.374865
[0m13:43:04.376130 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m13:43:04.376643 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:43:04.377415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m13:43:04.377876 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:43:04.381180 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m13:43:04.382007 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 13:43:04.378194 => 13:43:04.381768
[0m13:43:04.382458 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:43:04.383001 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 13:43:04.382775 => 13:43:04.382785
[0m13:43:04.384147 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m13:43:04.384859 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:43:04.385765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m13:43:04.386250 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:43:04.389457 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m13:43:04.391116 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 13:43:04.386574 => 13:43:04.390577
[0m13:43:04.391968 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:43:04.392960 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 13:43:04.392548 => 13:43:04.392563
[0m13:43:04.394707 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m13:43:04.396047 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:43:04.396627 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:43:04.541012 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:04.622916 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:05.764153 [debug] [MainThread]: Glue adapter: [elapsed 1.2268681526184082s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:05.843759 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:07.003195 [debug] [MainThread]: Glue adapter: [elapsed 2.4525649547576904s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:07.086689 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:08.245526 [debug] [MainThread]: Glue adapter: [elapsed 3.6914241313934326s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:08.329358 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:09.475114 [debug] [MainThread]: Glue adapter: [elapsed 4.93757700920105s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:09.546651 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:10.697910 [debug] [MainThread]: Glue adapter: [elapsed 6.155463933944702s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:10.772698 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:11.926027 [debug] [MainThread]: Glue adapter: [elapsed 7.3815600872039795s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:11.998985 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:13.149302 [debug] [MainThread]: Glue adapter: [elapsed 8.603538036346436s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:13.226260 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:14.383560 [debug] [MainThread]: Glue adapter: [elapsed 9.83476996421814s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:14.457498 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:15.622112 [debug] [MainThread]: Glue adapter: [elapsed 11.064647912979126s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:15.697737 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:16.843073 [debug] [MainThread]: Glue adapter: [elapsed 12.306517124176025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:16.942371 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:18.094589 [debug] [MainThread]: Glue adapter: [elapsed 13.547811031341553s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:18.167717 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:19.311725 [debug] [MainThread]: Glue adapter: [elapsed 14.771672248840332s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:19.386445 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:20.538965 [debug] [MainThread]: Glue adapter: [elapsed 15.995246171951294s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:20.611706 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:21.754837 [debug] [MainThread]: Glue adapter: [elapsed 17.216089963912964s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:21.831067 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:22.971118 [debug] [MainThread]: Glue adapter: [elapsed 18.435052156448364s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in PROVISIONING state
[0m13:43:23.045955 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m13:43:24.427709 [debug] [MainThread]: Glue adapter: [elapsed 19.649789094924927s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in READY state
[0m13:43:25.751895 [debug] [MainThread]: Glue adapter: [elapsed 21.21060299873352s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:26.975208 [debug] [MainThread]: Glue adapter: [elapsed 22.428556203842163s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:28.194437 [debug] [MainThread]: Glue adapter: [elapsed 23.65348505973816s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:29.404090 [debug] [MainThread]: Glue adapter: [elapsed 24.869597911834717s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:30.620332 [debug] [MainThread]: Glue adapter: [elapsed 26.079063177108765s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:31.840758 [debug] [MainThread]: Glue adapter: [elapsed 27.293156147003174s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:33.101279 [debug] [MainThread]: Glue adapter: [elapsed 28.518347024917603s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:34.330728 [debug] [MainThread]: Glue adapter: [elapsed 29.79445719718933s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:35.541798 [debug] [MainThread]: Glue adapter: [elapsed 31.007488012313843s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:36.766041 [debug] [MainThread]: Glue adapter: [elapsed 32.221015214920044s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:37.988274 [debug] [MainThread]: Glue adapter: [elapsed 33.43831515312195s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:39.200571 [debug] [MainThread]: Glue adapter: [elapsed 34.666099071502686s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:40.414699 [debug] [MainThread]: Glue adapter: [elapsed 35.87962102890015s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:41.633059 [debug] [MainThread]: Glue adapter: [elapsed 37.09691500663757s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:42.844135 [debug] [MainThread]: Glue adapter: [elapsed 38.30729413032532s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:44.059339 [debug] [MainThread]: Glue adapter: [elapsed 39.52300500869751s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:45.274583 [debug] [MainThread]: Glue adapter: [elapsed 40.73611116409302s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:46.497147 [debug] [MainThread]: Glue adapter: [elapsed 41.95307493209839s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:47.764267 [debug] [MainThread]: Glue adapter: [elapsed 43.221068143844604s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:48.980291 [debug] [MainThread]: Glue adapter: [elapsed 44.44222021102905s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:50.195528 [debug] [MainThread]: Glue adapter: [elapsed 45.66021800041199s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:51.406430 [debug] [MainThread]: Glue adapter: [elapsed 46.869158029556274s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:52.631948 [debug] [MainThread]: Glue adapter: [elapsed 48.09412908554077s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:53.844211 [debug] [MainThread]: Glue adapter: [elapsed 49.3102171421051s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:55.055370 [debug] [MainThread]: Glue adapter: [elapsed 50.51658606529236s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:56.262628 [debug] [MainThread]: Glue adapter: [elapsed 51.728463888168335s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:57.485927 [debug] [MainThread]: Glue adapter: [elapsed 52.93796110153198s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:58.687038 [debug] [MainThread]: Glue adapter: [elapsed 54.147780895233154s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:43:59.915430 [debug] [MainThread]: Glue adapter: [elapsed 55.37187218666077s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:01.142567 [debug] [MainThread]: Glue adapter: [elapsed 56.59652400016785s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:02.370780 [debug] [MainThread]: Glue adapter: [elapsed 57.83232307434082s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:03.596083 [debug] [MainThread]: Glue adapter: [elapsed 59.03137421607971s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:05.223616 [debug] [MainThread]: Glue adapter: [elapsed 60.276029109954834s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:06.432892 [debug] [MainThread]: Glue adapter: [elapsed 61.900426149368286s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:07.641239 [debug] [MainThread]: Glue adapter: [elapsed 63.09554600715637s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:08.866067 [debug] [MainThread]: Glue adapter: [elapsed 64.3231098651886s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:10.084474 [debug] [MainThread]: Glue adapter: [elapsed 65.54063701629639s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:11.248720 [debug] [MainThread]: Glue adapter: [elapsed 66.74639320373535s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:12.428804 [debug] [MainThread]: Glue adapter: [elapsed 67.90978908538818s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:13.760136 [debug] [MainThread]: Glue adapter: [elapsed 69.10319209098816s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:14.974518 [debug] [MainThread]: Glue adapter: [elapsed 70.42509007453918s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:16.157743 [debug] [MainThread]: Glue adapter: [elapsed 71.65374326705933s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:17.377359 [debug] [MainThread]: Glue adapter: [elapsed 72.83420181274414s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:18.602840 [debug] [MainThread]: Glue adapter: [elapsed 74.06687808036804s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:19.812454 [debug] [MainThread]: Glue adapter: [elapsed 75.27629709243774s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:21.039575 [debug] [MainThread]: Glue adapter: [elapsed 76.49910402297974s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:22.224720 [debug] [MainThread]: Glue adapter: [elapsed 77.71950697898865s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:23.440976 [debug] [MainThread]: Glue adapter: [elapsed 78.90054988861084s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPING state
[0m13:44:24.603264 [debug] [MainThread]: Command end result
[0m13:44:24.644176 [debug] [MainThread]: Re-using an available connection from the pool (formerly master, now generate_catalog)
[0m13:44:24.644832 [info ] [MainThread]: Building catalog
[0m13:44:24.647546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics, now dbt_nyc_metrics)
[0m13:44:24.648144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:25.218815 [debug] [ThreadPool]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:26.363768 [debug] [ThreadPool]: Glue adapter: [elapsed 1.1376457214355469s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:27.477063 [debug] [ThreadPool]: Glue adapter: [elapsed 2.264448881149292s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:28.655322 [debug] [ThreadPool]: Glue adapter: [elapsed 3.392683982849121s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:29.779010 [debug] [ThreadPool]: Glue adapter: [elapsed 4.5704498291015625s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:30.911010 [debug] [ThreadPool]: Glue adapter: [elapsed 5.68447470664978s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:32.034749 [debug] [ThreadPool]: Glue adapter: [elapsed 6.819514751434326s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:33.156861 [debug] [ThreadPool]: Glue adapter: [elapsed 7.936381816864014s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:34.307401 [debug] [ThreadPool]: Glue adapter: [elapsed 9.077502965927124s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:35.452549 [debug] [ThreadPool]: Glue adapter: [elapsed 10.218734741210938s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:36.577652 [debug] [ThreadPool]: Glue adapter: [elapsed 11.352684736251831s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:37.749167 [debug] [ThreadPool]: Glue adapter: [elapsed 12.52748990058899s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:38.886716 [debug] [ThreadPool]: Glue adapter: [elapsed 13.671679973602295s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:40.021257 [debug] [ThreadPool]: Glue adapter: [elapsed 14.788102865219116s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:41.167341 [debug] [ThreadPool]: Glue adapter: [elapsed 15.938366889953613s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:42.317036 [debug] [ThreadPool]: Glue adapter: [elapsed 17.091095685958862s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:43.454928 [debug] [ThreadPool]: Glue adapter: [elapsed 18.22776198387146s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:44.575366 [debug] [ThreadPool]: Glue adapter: [elapsed 19.36025071144104s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:45.747494 [debug] [ThreadPool]: Glue adapter: [elapsed 20.523462772369385s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:46.864125 [debug] [ThreadPool]: Glue adapter: [elapsed 21.654037952423096s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:48.019549 [debug] [ThreadPool]: Glue adapter: [elapsed 22.791523694992065s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:49.145589 [debug] [ThreadPool]: Glue adapter: [elapsed 23.921006679534912s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:50.290286 [debug] [ThreadPool]: Glue adapter: [elapsed 25.066657066345215s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:51.443204 [debug] [ThreadPool]: Glue adapter: [elapsed 26.210737943649292s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:52.597416 [debug] [ThreadPool]: Glue adapter: [elapsed 27.368626832962036s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:53.734457 [debug] [ThreadPool]: Glue adapter: [elapsed 28.506540775299072s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:54.867644 [debug] [ThreadPool]: Glue adapter: [elapsed 29.65675973892212s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:56.010777 [debug] [ThreadPool]: Glue adapter: [elapsed 30.772907972335815s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:57.156014 [debug] [ThreadPool]: Glue adapter: [elapsed 31.92617177963257s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:58.298139 [debug] [ThreadPool]: Glue adapter: [elapsed 33.074214935302734s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:44:59.452275 [debug] [ThreadPool]: Glue adapter: [elapsed 34.227396726608276s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:00.588746 [debug] [ThreadPool]: Glue adapter: [elapsed 35.37659478187561s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:01.765441 [debug] [ThreadPool]: Glue adapter: [elapsed 36.50878167152405s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:02.901381 [debug] [ThreadPool]: Glue adapter: [elapsed 37.68949770927429s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:04.021956 [debug] [ThreadPool]: Glue adapter: [elapsed 38.80882382392883s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:04.094748 [error] [ThreadPool]: Glue adapter: GlueSession took more than 120 seconds to start
[0m13:45:04.096125 [debug] [ThreadPool]: Glue adapter: columns before strip:
[0m13:45:04.096875 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:04.097372 [debug] [ThreadPool]: Glue adapter: columns after strip:
[0m13:45:04.097941 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:04.491253 [debug] [ThreadPool]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:04.562365 [error] [ThreadPool]: Glue adapter: GlueSession took more than 120 seconds to start
[0m13:45:04.563258 [debug] [ThreadPool]: Glue adapter: columns before strip:
[0m13:45:04.563946 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:04.564615 [debug] [ThreadPool]: Glue adapter: columns after strip:
[0m13:45:04.565249 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:05.041809 [debug] [ThreadPool]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:05.114791 [error] [ThreadPool]: Glue adapter: GlueSession took more than 120 seconds to start
[0m13:45:05.115737 [debug] [ThreadPool]: Glue adapter: columns before strip:
[0m13:45:05.116445 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:05.117028 [debug] [ThreadPool]: Glue adapter: columns after strip:
[0m13:45:05.117559 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:05.475976 [debug] [ThreadPool]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:05.545341 [error] [ThreadPool]: Glue adapter: GlueSession took more than 120 seconds to start
[0m13:45:05.546223 [debug] [ThreadPool]: Glue adapter: columns before strip:
[0m13:45:05.546916 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:05.547626 [debug] [ThreadPool]: Glue adapter: columns after strip:
[0m13:45:05.548272 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:05.552378 [debug] [ThreadPool]: On dbt_nyc_metrics: Close
[0m13:45:05.553038 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:45:05.556264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly dbt_nyc_metrics, now nyctaxi)
[0m13:45:05.556953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:06.128989 [debug] [ThreadPool]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-31cd6264-ee60-4232-a9e8-f8bb9a6ae927 in STOPPED state
[0m13:45:06.200953 [error] [ThreadPool]: Glue adapter: GlueSession took more than 120 seconds to start
[0m13:45:06.201849 [debug] [ThreadPool]: Glue adapter: columns before strip:
[0m13:45:06.202545 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:06.203221 [debug] [ThreadPool]: Glue adapter: columns after strip:
[0m13:45:06.203856 [debug] [ThreadPool]: Glue adapter: []
[0m13:45:06.205314 [debug] [ThreadPool]: On nyctaxi: Close
[0m13:45:06.205880 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m13:45:06.223520 [info ] [MainThread]: Catalog written to /Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/target/catalog.json
[0m13:45:06.225266 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:45:06.224749 after 123.76 seconds
[0m13:45:06.226925 [debug] [MainThread]: Glue adapter: cleanup called
[0m13:45:06.227580 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m13:45:06.295349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f933dbebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9341506640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93415066a0>]}
[0m13:45:06.296724 [debug] [MainThread]: Flushing usage events
[0m13:46:30.618175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea4f901c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea7b73d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea7b73f40>]}


============================== 13:46:30.624444 | 225efb7e-7225-4913-b4af-24c0e019a59d ==============================
[0m13:46:30.624444 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:46:30.625202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'profiles_dir': 'profile', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --profiles-dir profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:31.047110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '225efb7e-7225-4913-b4af-24c0e019a59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea7b67e20>]}
[0m13:46:31.071576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '225efb7e-7225-4913-b4af-24c0e019a59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea835efd0>]}
[0m14:35:51.950691 [error] [MainThread]: Encountered an error:

[0m14:35:51.966152 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/opt/anaconda3/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/anaconda3/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m14:35:51.970269 [debug] [MainThread]: Command `dbt docs serve` failed at 14:35:51.968998 after 1774.33 seconds
[0m14:35:51.973472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea4f901c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea83634c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea83636a0>]}
[0m14:35:51.975645 [debug] [MainThread]: Flushing usage events
[0m14:50:30.121032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a2f90760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a5b73850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a5b73a30>]}


============================== 14:50:30.128126 | 7211b142-f3b6-4279-9391-eaff28360b82 ==============================
[0m14:50:30.128126 [info ] [MainThread]: Running with dbt=1.6.1
[0m14:50:30.129002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:30.292980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7211b142-f3b6-4279-9391-eaff28360b82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a5b73d30>]}
[0m14:50:30.302286 [debug] [MainThread]: Command `dbt clean` succeeded at 14:50:30.301972 after 0.21 seconds
[0m14:50:30.304049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a2f90760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a5bf4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80a5b964c0>]}
[0m14:50:30.304853 [debug] [MainThread]: Flushing usage events
[0m14:59:26.256518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa063f90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa061d8c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa066b73d90>]}


============================== 14:59:26.264224 | cc0ec54d-7720-4c1b-9c23-a0505dff82ce ==============================
[0m14:59:26.264224 [info ] [MainThread]: Running with dbt=1.6.1
[0m14:59:26.265411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:26.723571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa061d8c700>]}
[0m14:59:26.747838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa067259fd0>]}
[0m14:59:26.749093 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m14:59:26.777738 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m14:59:26.779117 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:59:26.779910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa067278be0>]}
[0m14:59:28.157106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06745b7f0>]}
[0m14:59:28.173634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa067543df0>]}
[0m14:59:28.174282 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m14:59:28.174797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06719d070>]}
[0m14:59:28.176654 [info ] [MainThread]: 
[0m14:59:28.177583 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m14:59:28.178867 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m14:59:28.179338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:28.179832 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (5155, 123145560322048)
[0m14:59:28.180249 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m14:59:28.180628 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m14:59:28.181010 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m14:59:29.254191 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m14:59:29.255016 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m14:59:29.257625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m14:59:29.258350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:29.436505 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m14:59:29.437342 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m14:59:29.438688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa067475730>]}
[0m14:59:29.439474 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m14:59:29.440040 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m14:59:29.441081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:29.441684 [info ] [MainThread]: 
[0m14:59:29.451115 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m14:59:29.452184 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m14:59:29.453429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m14:59:29.454120 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m14:59:29.466442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m14:59:29.469145 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 14:59:29.454675 => 14:59:29.468781
[0m14:59:29.469685 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m14:59:29.489047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:59:29.679422 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m14:59:29.692731 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m14:59:29.693271 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m14:59:29.693732 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      
[0m14:59:29.838638 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:30.981726 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1446070671081543s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:32.131981 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.292067050933838s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:33.284189 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.447437047958374s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:34.431498 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.592117071151733s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:36.024732 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.748276948928833s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:37.177251 [debug] [Thread-1  ]: Glue adapter: [elapsed 7.336543083190918s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:38.343359 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.491647958755493s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:39.867925 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.029383182525635s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:41.015227 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.176632165908813s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:42.167030 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.327331066131592s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:43.321433 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.482726097106934s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:44.472545 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.62817096710205s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:45.619377 [debug] [Thread-1  ]: Glue adapter: [elapsed 15.783811092376709s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:46.772571 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.92902708053589s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:47.919899 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.07820224761963s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:49.062977 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.228564977645874s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in PROVISIONING state
[0m14:59:50.206392 [debug] [Thread-1  ]: Glue adapter: [elapsed 20.366149187088013s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in READY state
[0m14:59:50.277340 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m14:59:50.278254 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m14:59:59.184472 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m14:59:59.191370 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m14:59:59.192359 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m14:59:59.193283 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      ''')
[0m15:00:04.185418 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true\n      \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"key": "spark.sql.legacy.allowNonEmptyLocationInCTAS", "value": "true"}}], "description": [{"name": "key", "type": "StringType()"}, {"name": "value", "type": "StringType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694285999336, 'CompletedOn': 1694286004061}, 'ResponseMetadata': {'RequestId': '4fb76c98-2211-4161-98da-a56d6fb2e045', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '770', 'connection': 'keep-alive', 'x-amzn-requestid': '4fb76c98-2211-4161-98da-a56d6fb2e045'}, 'RetryAttempts': 0}}
[0m15:00:04.186450 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:04.187268 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:04.188109 [debug] [Thread-1  ]: SQL status: OK in 34.0 seconds
[0m15:00:04.444993 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:04.447084 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:00:04.447792 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m15:00:04.520736 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:04.521655 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:05.311441 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:05.312357 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:05.313158 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:05.314025 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */
drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m15:00:07.254620 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286005533, 'CompletedOn': 1694286005994}, 'ResponseMetadata': {'RequestId': '49dd003d-0221-4f20-8523-83374822e072', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '49dd003d-0221-4f20-8523-83374822e072'}, 'RetryAttempts': 0}}
[0m15:00:07.255270 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:07.256045 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:07.256676 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286005533, 'CompletedOn': 1694286005994}, 'ResponseMetadata': {'RequestId': '49dd003d-0221-4f20-8523-83374822e072', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '922', 'connection': 'keep-alive', 'x-amzn-requestid': '49dd003d-0221-4f20-8523-83374822e072'}, 'RetryAttempts': 0}}
[0m15:00:07.257346 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:07.258032 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m15:00:07.294757 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:00:07.295899 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:00:07.296411 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m15:00:07.363618 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:07.364543 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:09.092373 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:09.093332 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:09.094139 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:09.095069 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m15:00:28.762410 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286009254, 'CompletedOn': 1694286028111}, 'ResponseMetadata': {'RequestId': '5694872a-767f-4c30-8cab-5ff9f416751e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:28 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '5694872a-767f-4c30-8cab-5ff9f416751e'}, 'RetryAttempts': 0}}
[0m15:00:28.763590 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:28.764537 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:28.765608 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286009254, 'CompletedOn': 1694286028111}, 'ResponseMetadata': {'RequestId': '5694872a-767f-4c30-8cab-5ff9f416751e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:28 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '5694872a-767f-4c30-8cab-5ff9f416751e'}, 'RetryAttempts': 0}}
[0m15:00:28.766408 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:28.767049 [debug] [Thread-1  ]: SQL status: OK in 21.0 seconds
[0m15:00:28.789546 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 14:59:29.470014 => 15:00:28.789303
[0m15:00:28.790077 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m15:00:28.790536 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:00:28.790989 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m15:00:28.791437 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:00:28.792260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa068da2970>]}
[0m15:00:28.798706 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 59.34s]
[0m15:00:28.800269 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:00:28.802661 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:00:28.803642 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m15:00:28.804776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m15:00:28.805457 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:00:28.811242 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:00:28.812443 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 15:00:28.805921 => 15:00:28.812069
[0m15:00:28.813376 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:00:28.818426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:29.057830 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:29.245013 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:29.246993 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:00:29.247684 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m15:00:29.323858 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:29.324768 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:31.164355 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:31.165149 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:31.165793 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:31.166497 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m15:00:32.552180 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286031312, 'CompletedOn': 1694286031686}, 'ResponseMetadata': {'RequestId': 'd2fd4217-f705-42b8-93de-b5328e38e0b0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '920', 'connection': 'keep-alive', 'x-amzn-requestid': 'd2fd4217-f705-42b8-93de-b5328e38e0b0'}, 'RetryAttempts': 0}}
[0m15:00:32.553241 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:32.554106 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:32.555020 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286031312, 'CompletedOn': 1694286031686}, 'ResponseMetadata': {'RequestId': 'd2fd4217-f705-42b8-93de-b5328e38e0b0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '920', 'connection': 'keep-alive', 'x-amzn-requestid': 'd2fd4217-f705-42b8-93de-b5328e38e0b0'}, 'RetryAttempts': 0}}
[0m15:00:32.555722 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:32.556348 [debug] [Thread-1  ]: SQL status: OK in 3.0 seconds
[0m15:00:32.567970 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:00:32.569056 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:00:32.569576 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:00:32.570041 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:00:32.647354 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:32.648273 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:33.475842 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:33.476796 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:33.477452 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:33.478171 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:00:37.177989 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286033616, 'CompletedOn': 1694286036914}, 'ResponseMetadata': {'RequestId': '8980ba66-a379-4c4f-8c54-548296d7d5e0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:37 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '8980ba66-a379-4c4f-8c54-548296d7d5e0'}, 'RetryAttempts': 0}}
[0m15:00:37.178912 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:37.179639 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:37.180470 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286033616, 'CompletedOn': 1694286036914}, 'ResponseMetadata': {'RequestId': '8980ba66-a379-4c4f-8c54-548296d7d5e0', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:37 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '8980ba66-a379-4c4f-8c54-548296d7d5e0'}, 'RetryAttempts': 0}}
[0m15:00:37.181218 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:37.182189 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:00:37.186554 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 15:00:28.814021 => 15:00:37.186259
[0m15:00:37.187169 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m15:00:37.187711 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:00:37.188222 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m15:00:37.189053 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:00:37.190531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa068d71730>]}
[0m15:00:37.191784 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics .... [[32mOK[0m in 8.39s]
[0m15:00:37.193537 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:00:37.194503 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:00:37.195495 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m15:00:37.196912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m15:00:37.197829 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:00:37.203846 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:00:37.205251 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 15:00:37.198397 => 15:00:37.204835
[0m15:00:37.205880 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:00:37.211612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:37.403641 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:37.592033 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:37.594384 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:00:37.595316 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m15:00:37.668941 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:37.669882 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:38.308372 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:38.309633 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:38.310119 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:38.311865 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m15:00:39.755406 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286038480, 'CompletedOn': 1694286038909}, 'ResponseMetadata': {'RequestId': '04c15b9c-26bc-4fc1-8870-9ba4d5e479f4', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:39 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': '04c15b9c-26bc-4fc1-8870-9ba4d5e479f4'}, 'RetryAttempts': 0}}
[0m15:00:39.756574 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:39.757727 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:39.758984 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286038480, 'CompletedOn': 1694286038909}, 'ResponseMetadata': {'RequestId': '04c15b9c-26bc-4fc1-8870-9ba4d5e479f4', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:39 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '936', 'connection': 'keep-alive', 'x-amzn-requestid': '04c15b9c-26bc-4fc1-8870-9ba4d5e479f4'}, 'RetryAttempts': 0}}
[0m15:00:39.760052 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:39.760677 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m15:00:39.769689 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:00:39.770567 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:00:39.771026 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:00:39.771484 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:00:39.848653 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:39.849582 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:41.624686 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:41.625306 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:41.625782 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:41.626382 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:00:44.333880 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286041783, 'CompletedOn': 1694286044199}, 'ResponseMetadata': {'RequestId': '5af5d282-69e5-4ee6-93c2-f9f56022451d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '5af5d282-69e5-4ee6-93c2-f9f56022451d'}, 'RetryAttempts': 0}}
[0m15:00:44.334974 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:44.336188 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:44.337284 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286041783, 'CompletedOn': 1694286044199}, 'ResponseMetadata': {'RequestId': '5af5d282-69e5-4ee6-93c2-f9f56022451d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:44 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '5af5d282-69e5-4ee6-93c2-f9f56022451d'}, 'RetryAttempts': 0}}
[0m15:00:44.339212 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:44.340119 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:00:44.371713 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 15:00:37.206457 => 15:00:44.367787
[0m15:00:44.372947 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m15:00:44.373479 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:00:44.373923 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m15:00:44.374364 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:00:44.375225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa068d1fa00>]}
[0m15:00:44.376053 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[32mOK[0m in 7.18s]
[0m15:00:44.378502 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:00:44.379404 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:00:44.380034 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m15:00:44.380866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m15:00:44.381352 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:00:44.385185 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:00:44.386179 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 15:00:44.381680 => 15:00:44.385882
[0m15:00:44.386672 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:00:44.389346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:44.619326 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:44.819376 [debug] [Thread-1  ]: Glue adapter: An error occurred (EntityNotFoundException) when calling the GetTable operation: Entity Not Found
[0m15:00:44.822457 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:00:44.823710 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m15:00:44.898138 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:44.899407 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:45.570033 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:45.570986 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:45.571636 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:45.572344 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */
drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m15:00:47.078949 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286045704, 'CompletedOn': 1694286046096}, 'ResponseMetadata': {'RequestId': 'af2f0d20-db32-4c9e-b60f-507719233306', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:47 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'af2f0d20-db32-4c9e-b60f-507719233306'}, 'RetryAttempts': 0}}
[0m15:00:47.080117 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:47.081017 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:47.081870 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\ndrop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286045704, 'CompletedOn': 1694286046096}, 'ResponseMetadata': {'RequestId': 'af2f0d20-db32-4c9e-b60f-507719233306', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:47 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '944', 'connection': 'keep-alive', 'x-amzn-requestid': 'af2f0d20-db32-4c9e-b60f-507719233306'}, 'RetryAttempts': 0}}
[0m15:00:47.082577 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:47.083201 [debug] [Thread-1  ]: SQL status: OK in 2.0 seconds
[0m15:00:47.094399 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:00:47.095761 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:00:47.096332 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:00:47.096815 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:00:47.166943 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:00:47.167930 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746
[0m15:00:47.920760 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:00:47.921692 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:00:47.922486 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:00:47.923423 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:00:51.538224 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286048064, 'CompletedOn': 1694286050552}, 'ResponseMetadata': {'RequestId': 'fd808e7a-8e70-4026-9f45-31c1ad94164a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:51 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': 'fd808e7a-8e70-4026-9f45-31c1ad94164a'}, 'RetryAttempts': 0}}
[0m15:00:51.560519 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:00:51.561546 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:00:51.565264 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694286048064, 'CompletedOn': 1694286050552}, 'ResponseMetadata': {'RequestId': 'fd808e7a-8e70-4026-9f45-31c1ad94164a', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:00:51 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': 'fd808e7a-8e70-4026-9f45-31c1ad94164a'}, 'RetryAttempts': 0}}
[0m15:00:51.566217 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:00:51.566988 [debug] [Thread-1  ]: SQL status: OK in 4.0 seconds
[0m15:00:51.572315 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 15:00:44.386997 => 15:00:51.572065
[0m15:00:51.573275 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m15:00:51.573784 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:00:51.574242 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m15:00:51.574748 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:00:51.575619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0ec54d-7720-4c1b-9c23-a0505dff82ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa068d1f910>]}
[0m15:00:51.576357 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[32mOK[0m in 7.20s]
[0m15:00:51.577396 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:00:51.579410 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:51.580191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:51.581176 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (5155, 140704535110464)
[0m15:00:51.581660 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m15:00:51.582181 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m15:00:51.582602 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m15:00:52.285092 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:00:52.286050 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:00:52.287158 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:00:52.288098 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:52.288588 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:00:52.289033 [debug] [MainThread]: On master: Close
[0m15:00:52.289460 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m15:00:52.290299 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:00:52.290744 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:00:52.430733 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in READY state
[0m15:00:53.763125 [debug] [MainThread]: Glue adapter: [elapsed 1.3299980163574219s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:00:54.973319 [debug] [MainThread]: Glue adapter: [elapsed 2.546105146408081s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:00:56.194536 [debug] [MainThread]: Glue adapter: [elapsed 3.7576839923858643s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:00:57.604510 [debug] [MainThread]: Glue adapter: [elapsed 4.977254152297974s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:00:59.117918 [debug] [MainThread]: Glue adapter: [elapsed 6.699757099151611s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:00.329980 [debug] [MainThread]: Glue adapter: [elapsed 7.899938106536865s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:01.553770 [debug] [MainThread]: Glue adapter: [elapsed 9.099186897277832s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:03.700663 [debug] [MainThread]: Glue adapter: [elapsed 10.344084978103638s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:04.962140 [debug] [MainThread]: Glue adapter: [elapsed 12.528074026107788s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:06.186726 [debug] [MainThread]: Glue adapter: [elapsed 13.750940084457397s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:07.433992 [debug] [MainThread]: Glue adapter: [elapsed 14.962826013565063s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:08.623995 [debug] [MainThread]: Glue adapter: [elapsed 16.196474075317383s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:09.816330 [debug] [MainThread]: Glue adapter: [elapsed 17.403198957443237s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:11.025829 [debug] [MainThread]: Glue adapter: [elapsed 18.60229802131653s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:12.246576 [debug] [MainThread]: Glue adapter: [elapsed 19.801564931869507s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:13.462431 [debug] [MainThread]: Glue adapter: [elapsed 21.037069082260132s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:14.667259 [debug] [MainThread]: Glue adapter: [elapsed 22.248759984970093s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:15.883116 [debug] [MainThread]: Glue adapter: [elapsed 23.456796169281006s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:17.076292 [debug] [MainThread]: Glue adapter: [elapsed 24.670491218566895s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:18.275793 [debug] [MainThread]: Glue adapter: [elapsed 25.860785245895386s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:19.451680 [debug] [MainThread]: Glue adapter: [elapsed 27.042185068130493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:20.611955 [debug] [MainThread]: Glue adapter: [elapsed 28.22682213783264s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:21.790432 [debug] [MainThread]: Glue adapter: [elapsed 29.371854066848755s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:22.966471 [debug] [MainThread]: Glue adapter: [elapsed 30.55791211128235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:24.155769 [debug] [MainThread]: Glue adapter: [elapsed 31.747693061828613s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:25.363818 [debug] [MainThread]: Glue adapter: [elapsed 32.93215608596802s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:26.568700 [debug] [MainThread]: Glue adapter: [elapsed 34.14101815223694s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:27.756597 [debug] [MainThread]: Glue adapter: [elapsed 35.34517002105713s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:28.958681 [debug] [MainThread]: Glue adapter: [elapsed 36.52805209159851s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:30.140426 [debug] [MainThread]: Glue adapter: [elapsed 37.72360706329346s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:31.341407 [debug] [MainThread]: Glue adapter: [elapsed 38.92128300666809s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:32.610100 [debug] [MainThread]: Glue adapter: [elapsed 40.106369972229004s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:33.847360 [debug] [MainThread]: Glue adapter: [elapsed 41.39283514022827s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:35.025981 [debug] [MainThread]: Glue adapter: [elapsed 42.61221504211426s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:36.227976 [debug] [MainThread]: Glue adapter: [elapsed 43.803839921951294s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:37.460260 [debug] [MainThread]: Glue adapter: [elapsed 45.00429010391235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:38.669741 [debug] [MainThread]: Glue adapter: [elapsed 46.22852611541748s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:39.882518 [debug] [MainThread]: Glue adapter: [elapsed 47.47051000595093s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:41.084046 [debug] [MainThread]: Glue adapter: [elapsed 48.6578311920166s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:42.258626 [debug] [MainThread]: Glue adapter: [elapsed 49.85080003738403s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:43.458890 [debug] [MainThread]: Glue adapter: [elapsed 51.03712010383606s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:44.662902 [debug] [MainThread]: Glue adapter: [elapsed 52.237265825271606s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:45.855500 [debug] [MainThread]: Glue adapter: [elapsed 53.441357135772705s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:47.056256 [debug] [MainThread]: Glue adapter: [elapsed 54.634223222732544s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:48.254582 [debug] [MainThread]: Glue adapter: [elapsed 55.84073495864868s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPING state
[0m15:01:49.471199 [debug] [MainThread]: Glue adapter: [elapsed 57.04345226287842s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-eb38ded4-c0af-4a21-9fae-2f726768c746 in STOPPED state
[0m15:01:50.621184 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:01:50.822962 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in READY state
[0m15:01:52.139341 [debug] [MainThread]: Glue adapter: [elapsed 1.3742172718048096s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:53.332602 [debug] [MainThread]: Glue adapter: [elapsed 2.5843591690063477s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:54.539106 [debug] [MainThread]: Glue adapter: [elapsed 3.7871952056884766s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:55.752987 [debug] [MainThread]: Glue adapter: [elapsed 4.993961334228516s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:56.964490 [debug] [MainThread]: Glue adapter: [elapsed 6.2043211460113525s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:58.172185 [debug] [MainThread]: Glue adapter: [elapsed 7.4134321212768555s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:01:59.369488 [debug] [MainThread]: Glue adapter: [elapsed 8.617652416229248s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:00.601287 [debug] [MainThread]: Glue adapter: [elapsed 9.833025217056274s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:01.832174 [debug] [MainThread]: Glue adapter: [elapsed 11.05796217918396s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:03.064621 [debug] [MainThread]: Glue adapter: [elapsed 12.292465209960938s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:04.278940 [debug] [MainThread]: Glue adapter: [elapsed 13.514922142028809s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:05.665418 [debug] [MainThread]: Glue adapter: [elapsed 14.736867189407349s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:06.863526 [debug] [MainThread]: Glue adapter: [elapsed 16.11176609992981s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:08.192019 [debug] [MainThread]: Glue adapter: [elapsed 17.323684215545654s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:09.415029 [debug] [MainThread]: Glue adapter: [elapsed 18.645946264266968s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:10.627324 [debug] [MainThread]: Glue adapter: [elapsed 19.86768937110901s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:12.363191 [debug] [MainThread]: Glue adapter: [elapsed 21.087263107299805s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:13.576213 [debug] [MainThread]: Glue adapter: [elapsed 22.810145139694214s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:14.806100 [debug] [MainThread]: Glue adapter: [elapsed 24.041117191314697s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:16.021076 [debug] [MainThread]: Glue adapter: [elapsed 25.25578808784485s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:17.234330 [debug] [MainThread]: Glue adapter: [elapsed 26.474443197250366s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:18.480302 [debug] [MainThread]: Glue adapter: [elapsed 27.69655418395996s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:19.708452 [debug] [MainThread]: Glue adapter: [elapsed 28.945261240005493s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:20.939807 [debug] [MainThread]: Glue adapter: [elapsed 30.168092250823975s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:22.140951 [debug] [MainThread]: Glue adapter: [elapsed 31.39315128326416s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:23.362217 [debug] [MainThread]: Glue adapter: [elapsed 32.603063106536865s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:24.584453 [debug] [MainThread]: Glue adapter: [elapsed 33.82225823402405s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:25.805648 [debug] [MainThread]: Glue adapter: [elapsed 35.04701805114746s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:27.015034 [debug] [MainThread]: Glue adapter: [elapsed 36.259300231933594s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:28.226152 [debug] [MainThread]: Glue adapter: [elapsed 37.47277116775513s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:29.433355 [debug] [MainThread]: Glue adapter: [elapsed 38.67307710647583s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-dccb1276-3cd2-441b-bfc1-251d87a5c930 in STOPPING state
[0m15:02:30.610658 [info ] [MainThread]: 
[0m15:02:30.611574 [info ] [MainThread]: Finished running 4 table models in 0 hours 3 minutes and 2.43 seconds (182.43s).
[0m15:02:30.614306 [debug] [MainThread]: Command end result
[0m15:02:30.634840 [info ] [MainThread]: 
[0m15:02:30.635583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:30.636182 [info ] [MainThread]: 
[0m15:02:30.636827 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:02:30.637854 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:30.637676 after 184.42 seconds
[0m15:02:30.638588 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:02:30.639147 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:02:30.712325 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:02:30.787588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa063f90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0672ecc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa067443d00>]}
[0m15:02:30.788385 [debug] [MainThread]: Flushing usage events
[0m15:27:45.672431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa613f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa611ca7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa616b74d00>]}


============================== 15:27:45.679947 | f7d69d73-51f5-4228-b77a-612101df9fb9 ==============================
[0m15:27:45.679947 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:27:45.680913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:46.120564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa611ca7a60>]}
[0m15:27:46.144600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61725df70>]}
[0m15:27:46.146013 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m15:27:46.189482 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m15:27:46.286766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:46.287277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:46.294751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6172c70d0>]}
[0m15:27:46.312614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa617478ca0>]}
[0m15:27:46.313233 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:27:46.313829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa617478ac0>]}
[0m15:27:46.315849 [info ] [MainThread]: 
[0m15:27:46.317380 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m15:27:46.319137 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m15:27:46.319777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:46.320260 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (5726, 123145407938560)
[0m15:27:46.320690 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m15:27:46.321182 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m15:27:46.321709 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m15:27:47.362709 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m15:27:47.363418 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:27:47.365895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m15:27:47.366858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:47.578854 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m15:27:47.579600 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:27:47.581935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61727a3a0>]}
[0m15:27:47.582723 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:27:47.583289 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:27:47.584396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:47.584878 [info ] [MainThread]: 
[0m15:27:47.590083 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:27:47.590944 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m15:27:47.592141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m15:27:47.592829 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:27:47.606361 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:27:47.607872 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 15:27:47.593300 => 15:27:47.607415
[0m15:27:47.608443 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:27:47.629262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:27:47.834771 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : silver_nyctaxi_avg_metrics
                             type : table
                        
[0m15:27:47.849477 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:27:47.850090 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:27:47.850632 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      
[0m15:27:47.989784 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:49.135703 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1449761390686035s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:50.282259 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.2908642292022705s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:51.447146 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4490370750427246s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:52.611984 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.606674909591675s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:53.752346 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.762408018112183s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:54.919788 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.909563064575195s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:56.075146 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.07057785987854s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:57.223296 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.234838008880615s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:58.372849 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.377251148223877s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:27:59.523776 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.52959418296814s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:00.687145 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.680432081222534s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:01.829943 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.830822944641113s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:03.004267 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.993229150772095s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:04.154218 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.158737182617188s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:05.302696 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.309219121932983s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:06.676003 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.459228038787842s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in PROVISIONING state
[0m15:28:07.821119 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.827779054641724s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in READY state
[0m15:28:07.891320 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:28:07.892400 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:28:16.953543 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:28:16.956994 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:28:16.957964 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:28:16.958913 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      ''')
[0m15:28:22.084413 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true\n      \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"key": "spark.sql.legacy.allowNonEmptyLocationInCTAS", "value": "true"}}], "description": [{"name": "key", "type": "StringType()"}, {"name": "value", "type": "StringType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287697358, 'CompletedOn': 1694287701813}, 'ResponseMetadata': {'RequestId': '7b7191f8-14e0-4f81-9f4b-8ef8ebd04254', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:22 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '770', 'connection': 'keep-alive', 'x-amzn-requestid': '7b7191f8-14e0-4f81-9f4b-8ef8ebd04254'}, 'RetryAttempts': 0}}
[0m15:28:22.087183 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:28:22.088169 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:28:22.088801 [debug] [Thread-1  ]: SQL status: OK in 34.0 seconds
[0m15:28:22.334243 [debug] [Thread-1  ]: Glue adapter: table_name : silver_nyctaxi_avg_metrics
[0m15:28:22.335559 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:28:22.337964 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:28:22.338710 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m15:28:22.403423 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:28:22.404227 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:28:24.206659 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:28:24.208991 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:28:24.210083 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:28:24.211214 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m15:28:31.353665 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287704332, 'CompletedOn': 1694287711053}, 'ResponseMetadata': {'RequestId': '8bc9c5db-43fe-44e3-a081-0ea1a8d06740', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:31 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '8bc9c5db-43fe-44e3-a081-0ea1a8d06740'}, 'RetryAttempts': 0}}
[0m15:28:31.354897 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:28:31.355597 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:28:31.356275 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287704332, 'CompletedOn': 1694287711053}, 'ResponseMetadata': {'RequestId': '8bc9c5db-43fe-44e3-a081-0ea1a8d06740', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:31 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '8bc9c5db-43fe-44e3-a081-0ea1a8d06740'}, 'RetryAttempts': 0}}
[0m15:28:31.356846 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:28:31.357356 [debug] [Thread-1  ]: SQL status: OK in 9.0 seconds
[0m15:28:31.396707 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:28:31.398561 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:28:31.399555 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m15:28:31.463043 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:28:31.463964 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:28:33.489193 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:28:33.490160 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:28:33.490963 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:28:33.491881 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m15:28:49.913461 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287713689, 'CompletedOn': 1694287728869}, 'ResponseMetadata': {'RequestId': 'c5c95e83-7835-4460-a397-3a7339e187ff', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': 'c5c95e83-7835-4460-a397-3a7339e187ff'}, 'RetryAttempts': 0}}
[0m15:28:49.916405 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:28:49.917446 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:28:49.918822 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287713689, 'CompletedOn': 1694287728869}, 'ResponseMetadata': {'RequestId': 'c5c95e83-7835-4460-a397-3a7339e187ff', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': 'c5c95e83-7835-4460-a397-3a7339e187ff'}, 'RetryAttempts': 0}}
[0m15:28:49.920076 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:28:49.920909 [debug] [Thread-1  ]: SQL status: OK in 19.0 seconds
[0m15:28:49.999246 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 15:27:47.608774 => 15:28:49.998893
[0m15:28:50.000472 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m15:28:50.001219 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:28:50.006660 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m15:28:50.007560 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:28:50.009803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618d683a0>]}
[0m15:28:50.016734 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 62.42s]
[0m15:28:50.023127 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:28:50.025335 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:28:50.038846 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m15:28:50.040972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m15:28:50.046834 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:28:50.056289 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:28:50.063414 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 15:28:50.047509 => 15:28:50.062623
[0m15:28:50.064853 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:28:50.072976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:28:50.313159 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_cost_metrics
                             type : table
                        
[0m15:28:50.607621 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_cost_metrics
[0m15:28:50.608308 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:28:50.610865 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:28:50.614627 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m15:28:50.692922 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:28:50.694411 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:28:52.333613 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:28:52.334537 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:28:52.335542 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:28:52.336314 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m15:28:56.032824 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287732468, 'CompletedOn': 1694287735007}, 'ResponseMetadata': {'RequestId': '21f15b3b-7147-4300-abb6-93848301c3d8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:56 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '941', 'connection': 'keep-alive', 'x-amzn-requestid': '21f15b3b-7147-4300-abb6-93848301c3d8'}, 'RetryAttempts': 0}}
[0m15:28:56.033674 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:28:56.034217 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:28:56.034850 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287732468, 'CompletedOn': 1694287735007}, 'ResponseMetadata': {'RequestId': '21f15b3b-7147-4300-abb6-93848301c3d8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:28:56 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '941', 'connection': 'keep-alive', 'x-amzn-requestid': '21f15b3b-7147-4300-abb6-93848301c3d8'}, 'RetryAttempts': 0}}
[0m15:28:56.035362 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:28:56.035820 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:28:56.045423 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:28:56.052676 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:28:56.053602 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:28:56.054289 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:28:56.123416 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:28:56.124369 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:28:56.872443 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:28:56.873237 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:28:56.873865 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:28:56.874584 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:29:01.050060 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287737078, 'CompletedOn': 1694287739934}, 'ResponseMetadata': {'RequestId': 'c2a83e38-6b99-4d9f-b51c-196c6b5720b9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:01 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': 'c2a83e38-6b99-4d9f-b51c-196c6b5720b9'}, 'RetryAttempts': 0}}
[0m15:29:01.051256 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:29:01.052059 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:29:01.052951 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287737078, 'CompletedOn': 1694287739934}, 'ResponseMetadata': {'RequestId': 'c2a83e38-6b99-4d9f-b51c-196c6b5720b9', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:01 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': 'c2a83e38-6b99-4d9f-b51c-196c6b5720b9'}, 'RetryAttempts': 0}}
[0m15:29:01.053731 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:29:01.054378 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:29:01.059359 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 15:28:50.065510 => 15:29:01.058953
[0m15:29:01.060138 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m15:29:01.060744 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:29:01.061339 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m15:29:01.062075 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:29:01.063306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618de13d0>]}
[0m15:29:01.064197 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics .... [[32mOK[0m in 11.02s]
[0m15:29:01.065278 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:29:01.065932 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:29:01.066720 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m15:29:01.067718 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m15:29:01.068347 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:29:01.072706 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:29:01.073649 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 15:29:01.068778 => 15:29:01.073394
[0m15:29:01.074127 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:29:01.078834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:29:01.288617 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_distance_metrics
                             type : table
                        
[0m15:29:01.514420 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_distance_metrics
[0m15:29:01.515339 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:29:01.517327 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:29:01.518066 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m15:29:01.592907 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:29:01.593808 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:29:03.346307 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:29:03.347252 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:29:03.348047 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:29:03.348935 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m15:29:07.001490 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287743476, 'CompletedOn': 1694287746419}, 'ResponseMetadata': {'RequestId': '7545f13c-5509-477a-ae61-36c38fdbfe20', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:06 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '957', 'connection': 'keep-alive', 'x-amzn-requestid': '7545f13c-5509-477a-ae61-36c38fdbfe20'}, 'RetryAttempts': 0}}
[0m15:29:07.002525 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:29:07.003408 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:29:07.004457 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287743476, 'CompletedOn': 1694287746419}, 'ResponseMetadata': {'RequestId': '7545f13c-5509-477a-ae61-36c38fdbfe20', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:06 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '957', 'connection': 'keep-alive', 'x-amzn-requestid': '7545f13c-5509-477a-ae61-36c38fdbfe20'}, 'RetryAttempts': 0}}
[0m15:29:07.005215 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:29:07.005854 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:29:07.015979 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:29:07.019309 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:29:07.020067 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:29:07.020655 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:29:07.089301 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:29:07.090245 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:29:07.825075 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:29:07.825692 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:29:07.826161 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:29:07.826703 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:29:11.595260 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287747953, 'CompletedOn': 1694287750443}, 'ResponseMetadata': {'RequestId': '845dcc09-6bed-4afd-87c4-9b2c81fe7388', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:11 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '845dcc09-6bed-4afd-87c4-9b2c81fe7388'}, 'RetryAttempts': 0}}
[0m15:29:11.597155 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:29:11.600237 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:29:11.604809 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287747953, 'CompletedOn': 1694287750443}, 'ResponseMetadata': {'RequestId': '845dcc09-6bed-4afd-87c4-9b2c81fe7388', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:11 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '845dcc09-6bed-4afd-87c4-9b2c81fe7388'}, 'RetryAttempts': 0}}
[0m15:29:11.609014 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:29:11.618885 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:29:11.644635 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 15:29:01.074454 => 15:29:11.644107
[0m15:29:11.657219 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m15:29:11.664827 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:29:11.665976 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m15:29:11.667026 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:29:11.670068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618de1070>]}
[0m15:29:11.672275 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[32mOK[0m in 10.60s]
[0m15:29:11.673863 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:29:11.674882 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:29:11.676937 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m15:29:11.678815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m15:29:11.679938 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:29:11.699174 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:29:11.703341 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 15:29:11.680647 => 15:29:11.701666
[0m15:29:11.705683 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:29:11.762513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:29:12.050303 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_passengers_metrics
                             type : table
                        
[0m15:29:12.314726 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_passengers_metrics
[0m15:29:12.315650 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:29:12.318531 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:29:12.319884 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m15:29:12.397592 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:29:12.398504 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:29:14.158822 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:29:14.170922 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:29:14.171824 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:29:14.172858 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m15:29:17.800334 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287754300, 'CompletedOn': 1694287756962}, 'ResponseMetadata': {'RequestId': '4d30afa1-7448-4c6b-bdcb-f1f9cfe518f7', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:17 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '965', 'connection': 'keep-alive', 'x-amzn-requestid': '4d30afa1-7448-4c6b-bdcb-f1f9cfe518f7'}, 'RetryAttempts': 0}}
[0m15:29:17.803441 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:29:17.804777 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:29:17.806023 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287754300, 'CompletedOn': 1694287756962}, 'ResponseMetadata': {'RequestId': '4d30afa1-7448-4c6b-bdcb-f1f9cfe518f7', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:17 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '965', 'connection': 'keep-alive', 'x-amzn-requestid': '4d30afa1-7448-4c6b-bdcb-f1f9cfe518f7'}, 'RetryAttempts': 0}}
[0m15:29:17.807056 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:29:17.809569 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:29:17.834449 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:29:17.836187 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:29:17.836714 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:29:17.837186 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:29:17.911763 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:29:17.912446 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2
[0m15:29:19.586128 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:29:19.587078 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:29:19.588073 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:29:19.589126 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:29:23.370624 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287759717, 'CompletedOn': 1694287762435}, 'ResponseMetadata': {'RequestId': '19403c73-0597-4f46-aa5e-dcd4a2b16cf8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:23 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '19403c73-0597-4f46-aa5e-dcd4a2b16cf8'}, 'RetryAttempts': 0}}
[0m15:29:23.377320 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:29:23.378346 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:29:23.379213 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694287759717, 'CompletedOn': 1694287762435}, 'ResponseMetadata': {'RequestId': '19403c73-0597-4f46-aa5e-dcd4a2b16cf8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:29:23 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '19403c73-0597-4f46-aa5e-dcd4a2b16cf8'}, 'RetryAttempts': 0}}
[0m15:29:23.382400 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:29:23.383582 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m15:29:23.387763 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 15:29:11.706482 => 15:29:23.387520
[0m15:29:23.389490 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m15:29:23.390397 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:29:23.390996 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m15:29:23.391765 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:29:23.393372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7d69d73-51f5-4228-b77a-612101df9fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618e20a00>]}
[0m15:29:23.394763 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[32mOK[0m in 11.71s]
[0m15:29:23.395871 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:29:23.399207 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:23.399687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:23.400343 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (5726, 140704535110464)
[0m15:29:23.400996 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m15:29:23.401706 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m15:29:23.402387 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m15:29:24.193674 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:29:24.194257 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:29:24.194724 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:29:24.195152 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:24.195560 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:29:24.195953 [debug] [MainThread]: On master: Close
[0m15:29:24.196352 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m15:29:24.197326 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:29:24.197801 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:29:24.331510 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in READY state
[0m15:29:25.646356 [debug] [MainThread]: Glue adapter: [elapsed 1.302419900894165s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:27.132581 [debug] [MainThread]: Glue adapter: [elapsed 2.518486976623535s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:28.368660 [debug] [MainThread]: Glue adapter: [elapsed 4.014768838882446s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:29.584475 [debug] [MainThread]: Glue adapter: [elapsed 5.241714954376221s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:30.835261 [debug] [MainThread]: Glue adapter: [elapsed 6.4584550857543945s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:32.059946 [debug] [MainThread]: Glue adapter: [elapsed 7.70873498916626s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:33.254684 [debug] [MainThread]: Glue adapter: [elapsed 8.922663927078247s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:34.470482 [debug] [MainThread]: Glue adapter: [elapsed 10.13367509841919s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:35.731611 [debug] [MainThread]: Glue adapter: [elapsed 11.390072107315063s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:36.939535 [debug] [MainThread]: Glue adapter: [elapsed 12.598912954330444s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:38.129471 [debug] [MainThread]: Glue adapter: [elapsed 13.797329187393188s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:39.360557 [debug] [MainThread]: Glue adapter: [elapsed 15.002971887588501s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:40.552158 [debug] [MainThread]: Glue adapter: [elapsed 16.2245991230011s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:41.763954 [debug] [MainThread]: Glue adapter: [elapsed 17.42768096923828s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:42.969417 [debug] [MainThread]: Glue adapter: [elapsed 18.63129496574402s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:44.191407 [debug] [MainThread]: Glue adapter: [elapsed 19.84762215614319s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:45.392766 [debug] [MainThread]: Glue adapter: [elapsed 21.070635080337524s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:46.577809 [debug] [MainThread]: Glue adapter: [elapsed 22.253531217575073s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:47.812542 [debug] [MainThread]: Glue adapter: [elapsed 23.459736108779907s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:49.030714 [debug] [MainThread]: Glue adapter: [elapsed 24.688934087753296s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:50.281024 [debug] [MainThread]: Glue adapter: [elapsed 25.897979974746704s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:51.491461 [debug] [MainThread]: Glue adapter: [elapsed 27.14092493057251s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:52.714962 [debug] [MainThread]: Glue adapter: [elapsed 28.369009017944336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:53.907622 [debug] [MainThread]: Glue adapter: [elapsed 29.57481288909912s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:55.118823 [debug] [MainThread]: Glue adapter: [elapsed 30.781759023666382s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:56.332364 [debug] [MainThread]: Glue adapter: [elapsed 32.00126910209656s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:57.552802 [debug] [MainThread]: Glue adapter: [elapsed 33.1854510307312s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:58.777219 [debug] [MainThread]: Glue adapter: [elapsed 34.41122508049011s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:29:59.961299 [debug] [MainThread]: Glue adapter: [elapsed 35.6465699672699s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:01.167095 [debug] [MainThread]: Glue adapter: [elapsed 36.845914125442505s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:02.363586 [debug] [MainThread]: Glue adapter: [elapsed 38.02584409713745s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:03.555005 [debug] [MainThread]: Glue adapter: [elapsed 39.2319769859314s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:04.911969 [debug] [MainThread]: Glue adapter: [elapsed 40.57504606246948s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:06.116386 [debug] [MainThread]: Glue adapter: [elapsed 41.79186296463013s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:07.286117 [debug] [MainThread]: Glue adapter: [elapsed 42.97089886665344s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-b71c8fcf-fe5d-4cae-89b0-ff43518240e2 in STOPPING state
[0m15:30:08.411983 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:30:08.550864 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in READY state
[0m15:30:09.869746 [debug] [MainThread]: Glue adapter: [elapsed 1.320842981338501s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:11.083053 [debug] [MainThread]: Glue adapter: [elapsed 2.531735897064209s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:12.308658 [debug] [MainThread]: Glue adapter: [elapsed 3.761681079864502s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:13.520888 [debug] [MainThread]: Glue adapter: [elapsed 4.968308925628662s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:14.742492 [debug] [MainThread]: Glue adapter: [elapsed 6.163640975952148s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:15.964464 [debug] [MainThread]: Glue adapter: [elapsed 7.399791955947876s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:17.187389 [debug] [MainThread]: Glue adapter: [elapsed 8.632584810256958s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:18.464944 [debug] [MainThread]: Glue adapter: [elapsed 9.916285991668701s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:19.658591 [debug] [MainThread]: Glue adapter: [elapsed 11.106857776641846s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:21.098041 [debug] [MainThread]: Glue adapter: [elapsed 12.304732084274292s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:22.295290 [debug] [MainThread]: Glue adapter: [elapsed 13.757275104522705s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:23.506192 [debug] [MainThread]: Glue adapter: [elapsed 14.958287954330444s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:24.727320 [debug] [MainThread]: Glue adapter: [elapsed 16.174663066864014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:25.964134 [debug] [MainThread]: Glue adapter: [elapsed 17.4048171043396s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:27.164146 [debug] [MainThread]: Glue adapter: [elapsed 18.61447501182556s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:28.364716 [debug] [MainThread]: Glue adapter: [elapsed 19.821351051330566s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:29.583957 [debug] [MainThread]: Glue adapter: [elapsed 21.03913402557373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:30.776224 [debug] [MainThread]: Glue adapter: [elapsed 22.234606981277466s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:31.984613 [debug] [MainThread]: Glue adapter: [elapsed 23.428385972976685s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:33.195120 [debug] [MainThread]: Glue adapter: [elapsed 24.645629167556763s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:34.402941 [debug] [MainThread]: Glue adapter: [elapsed 25.853819131851196s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:35.635026 [debug] [MainThread]: Glue adapter: [elapsed 27.07208800315857s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:36.841913 [debug] [MainThread]: Glue adapter: [elapsed 28.29445195198059s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:38.077552 [debug] [MainThread]: Glue adapter: [elapsed 29.506335973739624s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:39.284129 [debug] [MainThread]: Glue adapter: [elapsed 30.732306003570557s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:40.482572 [debug] [MainThread]: Glue adapter: [elapsed 31.942569971084595s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:42.020299 [debug] [MainThread]: Glue adapter: [elapsed 33.13282299041748s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:43.243735 [debug] [MainThread]: Glue adapter: [elapsed 34.679319858551025s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:44.441368 [debug] [MainThread]: Glue adapter: [elapsed 35.90524196624756s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-21300b18-d9fc-4139-8f5e-7899e87f33c3 in STOPPING state
[0m15:30:45.570653 [info ] [MainThread]: 
[0m15:30:45.571971 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 59.25 seconds (179.25s).
[0m15:30:45.576057 [debug] [MainThread]: Command end result
[0m15:30:45.800318 [info ] [MainThread]: 
[0m15:30:45.801047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:45.801569 [info ] [MainThread]: 
[0m15:30:45.802112 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:30:45.803136 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:45.802894 after 180.16 seconds
[0m15:30:45.803684 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:30:45.804084 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:30:45.852467 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:30:45.928216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa613f94e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618e9ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa618e9b1c0>]}
[0m15:30:45.929405 [debug] [MainThread]: Flushing usage events
[0m15:38:44.101444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c2f90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5b74e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5b74fd0>]}


============================== 15:38:44.108925 | 4da27340-8304-4a4a-92c2-13e3f0d45e66 ==============================
[0m15:38:44.108925 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:38:44.110064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:44.113474 [error] [MainThread]: Encountered an error:
unhashable type: 'list'
[0m15:38:44.117901 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 140, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/config/profile.py", line 390, in from_raw_profiles
    if profile_name not in raw_profiles:
TypeError: unhashable type: 'list'

[0m15:38:44.119851 [debug] [MainThread]: Command `dbt run` failed at 15:38:44.119422 after 0.06 seconds
[0m15:38:44.120772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c2f90340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5ba08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c5ba0700>]}
[0m15:38:44.121797 [debug] [MainThread]: Flushing usage events
[0m15:52:57.241199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9c790280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9f374910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9f374af0>]}


============================== 15:52:57.247531 | 7478aba9-a75c-4b41-82e7-942a3fd9699b ==============================
[0m15:52:57.247531 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:52:57.248658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -t test', 'send_anonymous_usage_stats': 'True'}
[0m15:52:57.254337 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtgluenyctaxidemo'
[0m15:52:57.255275 [debug] [MainThread]: Command `dbt run` failed at 15:52:57.255093 after 0.04 seconds
[0m15:52:57.255729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9c790280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9f374f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce9f399550>]}
[0m15:52:57.256205 [debug] [MainThread]: Flushing usage events
[0m15:53:46.604820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec2790340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec5374970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec5374b50>]}


============================== 15:53:46.612706 | 7e437287-9a4c-482b-af09-4878f99e8776 ==============================
[0m15:53:46.612706 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:53:46.613706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -t test', 'send_anonymous_usage_stats': 'True'}
[0m15:53:46.619370 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtgluenyctaxidemo'
[0m15:53:46.620387 [debug] [MainThread]: Command `dbt run` failed at 15:53:46.620208 after 0.04 seconds
[0m15:53:46.620846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec2790340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec539a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feec539a6a0>]}
[0m15:53:46.621316 [debug] [MainThread]: Flushing usage events
[0m15:55:01.250018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6defd0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1b34970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1b34b50>]}


============================== 15:55:01.256126 | da738d13-0dcb-4b93-83e3-89323131df7b ==============================
[0m15:55:01.256126 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:55:01.256905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -t test', 'send_anonymous_usage_stats': 'True'}
[0m15:55:01.262331 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'test'
[0m15:55:01.263180 [debug] [MainThread]: Command `dbt run` failed at 15:55:01.263000 after 0.04 seconds
[0m15:55:01.263642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6defd0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1b5a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1b5a6a0>]}
[0m15:55:01.264102 [debug] [MainThread]: Flushing usage events
[0m15:55:15.268352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4767900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479274940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479274b20>]}


============================== 15:55:15.274244 | d94d2d35-e620-4722-8e40-a9f169ed0c42 ==============================
[0m15:55:15.274244 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:55:15.275009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/chaitanyavarmamudundi/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -t test', 'send_anonymous_usage_stats': 'True'}
[0m15:55:15.280566 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbtgluenyctaxidemo'
[0m15:55:15.281521 [debug] [MainThread]: Command `dbt run` failed at 15:55:15.281329 after 0.04 seconds
[0m15:55:15.281977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4767900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479274fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47929a580>]}
[0m15:55:15.282441 [debug] [MainThread]: Flushing usage events
[0m15:56:24.361288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa106f900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10558c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa109b74dc0>]}


============================== 15:56:24.368050 | acb2adaf-acd1-4f28-a3c4-cd8be24c140c ==============================
[0m15:56:24.368050 [info ] [MainThread]: Running with dbt=1.6.1
[0m15:56:24.369111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'profile', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir profile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:56:24.808496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10558c700>]}
[0m15:56:24.831422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a261fd0>]}
[0m15:56:24.832711 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m15:56:24.858531 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m15:56:24.876507 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:56:24.877175 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:56:24.877944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a27abe0>]}
[0m15:56:26.294345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.test.gold_metrics
- models.test.silver_metrics
[0m15:56:26.303124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a62ff70>]}
[0m15:56:26.325101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a2ebeb0>]}
[0m15:56:26.325731 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m15:56:26.326273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a5d7730>]}
[0m15:56:26.328923 [info ] [MainThread]: 
[0m15:56:26.330994 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m15:56:26.333047 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m15:56:26.333521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:26.334003 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (6359, 123145589882880)
[0m15:56:26.334427 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m15:56:26.334813 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m15:56:26.335195 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m15:56:27.269229 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m15:56:27.270045 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:56:27.272549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m15:56:27.273312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:27.550978 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m15:56:27.551715 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m15:56:27.554314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10b003490>]}
[0m15:56:27.555134 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:56:27.555713 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:56:27.556793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:27.557365 [info ] [MainThread]: 
[0m15:56:27.566809 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:56:27.567890 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m15:56:27.569056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m15:56:27.569749 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:56:27.583271 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:56:27.584722 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 15:56:27.570235 => 15:56:27.584279
[0m15:56:27.585559 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:56:27.607406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:56:27.807513 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : silver_nyctaxi_avg_metrics
                             type : table
                        
[0m15:56:27.822661 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:56:27.823228 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:56:27.823686 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      
[0m15:56:27.959986 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:29.114004 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.143723964691162s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:30.254050 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.289259910583496s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:31.397411 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4323599338531494s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:32.553617 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.586521863937378s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:33.687771 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.726024866104126s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:34.828801 [debug] [Thread-1  ]: Glue adapter: [elapsed 6.868734836578369s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:35.972642 [debug] [Thread-1  ]: Glue adapter: [elapsed 8.009605884552002s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:37.122811 [debug] [Thread-1  ]: Glue adapter: [elapsed 9.15568208694458s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:38.264317 [debug] [Thread-1  ]: Glue adapter: [elapsed 10.301726818084717s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:39.405280 [debug] [Thread-1  ]: Glue adapter: [elapsed 11.443116903305054s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:40.548378 [debug] [Thread-1  ]: Glue adapter: [elapsed 12.588019847869873s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:41.693682 [debug] [Thread-1  ]: Glue adapter: [elapsed 13.729602098464966s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:42.884075 [debug] [Thread-1  ]: Glue adapter: [elapsed 14.878714799880981s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:44.021140 [debug] [Thread-1  ]: Glue adapter: [elapsed 16.057885885238647s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:45.164089 [debug] [Thread-1  ]: Glue adapter: [elapsed 17.19734501838684s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:46.311798 [debug] [Thread-1  ]: Glue adapter: [elapsed 18.342397928237915s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in PROVISIONING state
[0m15:56:47.465869 [debug] [Thread-1  ]: Glue adapter: [elapsed 19.486929893493652s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in READY state
[0m15:56:47.542739 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:56:47.544174 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:56:57.490623 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:56:57.497967 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:56:57.499023 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:56:57.499923 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      ''')
[0m15:57:04.925909 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 2, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true\n      \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "rowcount": 1, "results": [{"type": "record", "data": {"key": "spark.sql.legacy.allowNonEmptyLocationInCTAS", "value": "true"}}], "description": [{"name": "key", "type": "StringType()"}, {"name": "value", "type": "StringType()"}]}'}, 'ExecutionCount': 2, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289417657, 'CompletedOn': 1694289423859}, 'ResponseMetadata': {'RequestId': 'd7461aa6-cd3b-4fb5-9543-d32c9b289fb5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:04 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '770', 'connection': 'keep-alive', 'x-amzn-requestid': 'd7461aa6-cd3b-4fb5-9543-d32c9b289fb5'}, 'RetryAttempts': 0}}
[0m15:57:04.932485 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:04.933662 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:04.935087 [debug] [Thread-1  ]: SQL status: OK in 37.0 seconds
[0m15:57:05.234288 [debug] [Thread-1  ]: Glue adapter: table_name : silver_nyctaxi_avg_metrics
[0m15:57:05.235178 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:57:05.237124 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:57:05.238048 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics
[0m15:57:05.306100 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:05.307011 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:05.972413 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:05.973353 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:05.974884 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:05.976100 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics''')
[0m15:57:14.385219 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289426206, 'CompletedOn': 1694289433203}, 'ResponseMetadata': {'RequestId': '918b6675-0180-4711-a9c6-f8c2465bb1f8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:14 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '918b6675-0180-4711-a9c6-f8c2465bb1f8'}, 'RetryAttempts': 0}}
[0m15:57:14.386534 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:14.387948 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:14.389365 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 5, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.silver_nyctaxi_avg_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 5, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289426206, 'CompletedOn': 1694289433203}, 'ResponseMetadata': {'RequestId': '918b6675-0180-4711-a9c6-f8c2465bb1f8', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:14 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '943', 'connection': 'keep-alive', 'x-amzn-requestid': '918b6675-0180-4711-a9c6-f8c2465bb1f8'}, 'RetryAttempts': 0}}
[0m15:57:14.390133 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:14.390735 [debug] [Thread-1  ]: SQL status: OK in 9.0 seconds
[0m15:57:14.440252 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:57:14.445411 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m15:57:14.446207 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  
[0m15:57:14.513043 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:14.513863 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:16.201934 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:16.205688 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:16.206681 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:16.207859 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

  
    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/'
	
	as
	

WITH source_avg as (
    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration
    , avg(passenger_count) as avg_passenger_count 
    , avg(trip_distance) as avg_trip_distance 
    , avg(total_amount) as avg_total_amount
    , year(CAST(tpep_dropoff_datetime as timestamp)) as year
    , month(CAST(tpep_dropoff_datetime as timestamp)) as month
    , payment_type as type
    FROM nyctaxi.tripdata
    --WHERE year = "2022"
    WHERE tpep_dropoff_datetime is not null
    GROUP BY 5, 6, 7
    --GROUP BY 5
) 
SELECT *
FROM source_avg
  ''')
[0m15:57:32.351984 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289436328, 'CompletedOn': 1694289451656}, 'ResponseMetadata': {'RequestId': '5b2f3052-3742-48ff-b2b4-045eeb88e3f1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '5b2f3052-3742-48ff-b2b4-045eeb88e3f1'}, 'RetryAttempts': 0}}
[0m15:57:32.354675 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:32.355655 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:32.356652 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 8, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */\n\n  \n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\n\t\n\tas\n\t\n\nWITH source_avg as (\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\n    , avg(passenger_count) as avg_passenger_count \n    , avg(trip_distance) as avg_trip_distance \n    , avg(total_amount) as avg_total_amount\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\n    , payment_type as type\n    FROM nyctaxi.tripdata\n    --WHERE year = "2022"\n    WHERE tpep_dropoff_datetime is not null\n    GROUP BY 5, 6, 7\n    --GROUP BY 5\n) \nSELECT *\nFROM source_avg\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/silver_nyctaxi_avg_metrics/\'\\n\\t\\n\\tas\\n\\t\\n\\nWITH source_avg as (\\n    SELECT avg((CAST(tpep_dropoff_datetime as LONG) - CAST(tpep_pickup_datetime as LONG))/60) as avg_duration\\n    , avg(passenger_count) as avg_passenger_count \\n    , avg(trip_distance) as avg_trip_distance \\n    , avg(total_amount) as avg_total_amount\\n    , year(CAST(tpep_dropoff_datetime as timestamp)) as year\\n    , month(CAST(tpep_dropoff_datetime as timestamp)) as month\\n    , payment_type as type\\n    FROM nyctaxi.tripdata\\n    --WHERE year = \\"2022\\"\\n    WHERE tpep_dropoff_datetime is not null\\n    GROUP BY 5, 6, 7\\n    --GROUP BY 5\\n) \\nSELECT *\\nFROM source_avg\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 8, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289436328, 'CompletedOn': 1694289451656}, 'ResponseMetadata': {'RequestId': '5b2f3052-3742-48ff-b2b4-045eeb88e3f1', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:32 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '2479', 'connection': 'keep-alive', 'x-amzn-requestid': '5b2f3052-3742-48ff-b2b4-045eeb88e3f1'}, 'RetryAttempts': 0}}
[0m15:57:32.358585 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:32.360033 [debug] [Thread-1  ]: SQL status: OK in 18.0 seconds
[0m15:57:32.391123 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (execute): 15:56:27.586116 => 15:57:32.390027
[0m15:57:32.391767 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: ROLLBACK
[0m15:57:32.392247 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:57:32.392688 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: Close
[0m15:57:32.393137 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:57:32.394223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a1d47f0>]}
[0m15:57:32.398816 [info ] [Thread-1  ]: 1 of 4 OK created sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ... [[32mOK[0m in 64.83s]
[0m15:57:32.400884 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m15:57:32.403281 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:57:32.404089 [info ] [Thread-1  ]: 2 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics ......... [RUN]
[0m15:57:32.405375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics)
[0m15:57:32.406958 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:57:32.412532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:57:32.413928 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (compile): 15:57:32.407587 => 15:57:32.413420
[0m15:57:32.415032 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:57:32.417615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:57:32.638144 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_cost_metrics
                             type : table
                        
[0m15:57:32.844236 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_cost_metrics
[0m15:57:32.845185 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:57:32.847499 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:57:32.848240 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics
[0m15:57:32.911861 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:32.912940 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:34.716604 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:34.717427 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:34.718066 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:34.719356 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics''')
[0m15:57:38.378764 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289454885, 'CompletedOn': 1694289457620}, 'ResponseMetadata': {'RequestId': 'd29948da-2b39-4184-80fb-e7451062a5fe', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '941', 'connection': 'keep-alive', 'x-amzn-requestid': 'd29948da-2b39-4184-80fb-e7451062a5fe'}, 'RetryAttempts': 0}}
[0m15:57:38.379839 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:38.380713 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:38.381759 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 11, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_cost_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 11, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289454885, 'CompletedOn': 1694289457620}, 'ResponseMetadata': {'RequestId': 'd29948da-2b39-4184-80fb-e7451062a5fe', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:38 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '941', 'connection': 'keep-alive', 'x-amzn-requestid': 'd29948da-2b39-4184-80fb-e7451062a5fe'}, 'RetryAttempts': 0}}
[0m15:57:38.382477 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:38.383116 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m15:57:38.394753 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:57:38.395775 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:57:38.396284 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"
[0m15:57:38.396747 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:57:38.469804 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:38.470774 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:40.177843 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:40.178804 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:40.179615 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:40.180397 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/'
	
	as
	SELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance
, (avg_total_amount/avg_duration) as avg_cost_per_minute
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:57:43.941048 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289460328, 'CompletedOn': 1694289463335}, 'ResponseMetadata': {'RequestId': '6e13c8fa-ea58-4c0a-b357-0a9622fc1f3e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:43 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '6e13c8fa-ea58-4c0a-b357-0a9622fc1f3e'}, 'RetryAttempts': 0}}
[0m15:57:43.942208 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:43.943117 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:43.943995 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 14, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_cost_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_cost_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_trip_distance) as avg_cost_per_distance\\n, (avg_total_amount/avg_duration) as avg_cost_per_minute\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 14, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289460328, 'CompletedOn': 1694289463335}, 'ResponseMetadata': {'RequestId': '6e13c8fa-ea58-4c0a-b357-0a9622fc1f3e', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:43 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1651', 'connection': 'keep-alive', 'x-amzn-requestid': '6e13c8fa-ea58-4c0a-b357-0a9622fc1f3e'}, 'RetryAttempts': 0}}
[0m15:57:43.944746 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:43.945384 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m15:57:43.950063 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics (execute): 15:57:32.415415 => 15:57:43.949793
[0m15:57:43.950623 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: ROLLBACK
[0m15:57:43.951149 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:57:43.951667 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics: Close
[0m15:57:43.952184 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:57:43.953154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a5d7a60>]}
[0m15:57:43.953944 [info ] [Thread-1  ]: 2 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_cost_metrics .... [[32mOK[0m in 11.55s]
[0m15:57:43.954780 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics
[0m15:57:43.955414 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:57:43.956223 [info ] [Thread-1  ]: 3 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics ..... [RUN]
[0m15:57:43.957425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_cost_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics)
[0m15:57:43.957993 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:57:43.961859 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:57:43.964311 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (compile): 15:57:43.958331 => 15:57:43.963477
[0m15:57:43.964902 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:57:43.968671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:57:44.250242 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_distance_metrics
                             type : table
                        
[0m15:57:44.469907 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_distance_metrics
[0m15:57:44.470713 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:57:44.472753 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:57:44.473471 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics
[0m15:57:44.536136 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:44.537116 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:46.300744 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:46.301836 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:46.302653 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:46.303529 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics''')
[0m15:57:49.909622 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289466445, 'CompletedOn': 1694289469085}, 'ResponseMetadata': {'RequestId': 'c14366c7-4fa8-4109-9d58-6f58b5a61ca3', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '957', 'connection': 'keep-alive', 'x-amzn-requestid': 'c14366c7-4fa8-4109-9d58-6f58b5a61ca3'}, 'RetryAttempts': 0}}
[0m15:57:49.910689 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:49.911732 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:49.912742 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 17, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_distance_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 17, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289466445, 'CompletedOn': 1694289469085}, 'ResponseMetadata': {'RequestId': 'c14366c7-4fa8-4109-9d58-6f58b5a61ca3', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:49 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '957', 'connection': 'keep-alive', 'x-amzn-requestid': 'c14366c7-4fa8-4109-9d58-6f58b5a61ca3'}, 'RetryAttempts': 0}}
[0m15:57:49.913473 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:49.914117 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:57:49.924827 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:57:49.931458 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:57:49.932341 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"
[0m15:57:49.933174 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:57:49.994241 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:49.995185 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:51.729303 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:51.730304 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:51.731114 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:51.731997 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/'
	
	as
	SELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:57:55.506124 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289471959, 'CompletedOn': 1694289474432}, 'ResponseMetadata': {'RequestId': '40036971-ea8d-44be-bb23-6ce6b792dcbb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '40036971-ea8d-44be-bb23-6ce6b792dcbb'}, 'RetryAttempts': 0}}
[0m15:57:55.513238 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:57:55.514098 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:57:55.515101 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 20, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\n\t\n\tas\n\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_distance_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_distance_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_trip_distance/avg_duration) as avg_distance_per_duration\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 20, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289471959, 'CompletedOn': 1694289474432}, 'ResponseMetadata': {'RequestId': '40036971-ea8d-44be-bb23-6ce6b792dcbb', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:57:55 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1558', 'connection': 'keep-alive', 'x-amzn-requestid': '40036971-ea8d-44be-bb23-6ce6b792dcbb'}, 'RetryAttempts': 0}}
[0m15:57:55.515819 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:57:55.517410 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m15:57:55.522022 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics (execute): 15:57:43.965242 => 15:57:55.521744
[0m15:57:55.522642 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: ROLLBACK
[0m15:57:55.523178 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:57:55.523688 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics: Close
[0m15:57:55.524174 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:57:55.525099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a63ffd0>]}
[0m15:57:55.525787 [info ] [Thread-1  ]: 3 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_distance_metrics  [[32mOK[0m in 11.57s]
[0m15:57:55.526522 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics
[0m15:57:55.527084 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:57:55.527697 [info ] [Thread-1  ]: 4 of 4 START sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics ... [RUN]
[0m15:57:55.528565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbtgluenyctaxidemo.gold_nyctaxi_distance_metrics, now model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics)
[0m15:57:55.529100 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:57:55.533472 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:57:55.534535 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (compile): 15:57:55.529582 => 15:57:55.534170
[0m15:57:55.535054 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:57:55.537880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:57:55.727629 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : gold_nyctaxi_passengers_metrics
                             type : table
                        
[0m15:57:55.936578 [debug] [Thread-1  ]: Glue adapter: table_name : gold_nyctaxi_passengers_metrics
[0m15:57:55.937542 [debug] [Thread-1  ]: Glue adapter: table type : table
[0m15:57:55.939565 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:57:55.940258 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
[0m15:57:55.988552 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:57:55.989513 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:57:57.584419 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:57:57.585227 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:57:57.585887 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:57:57.586598 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics''')
[0m15:58:01.189000 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289477733, 'CompletedOn': 1694289480245}, 'ResponseMetadata': {'RequestId': '4b29a0ae-2d11-4e1d-af84-ee4fbed10dda', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:58:01 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '965', 'connection': 'keep-alive', 'x-amzn-requestid': '4b29a0ae-2d11-4e1d-af84-ee4fbed10dda'}, 'RetryAttempts': 0}}
[0m15:58:01.190227 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:58:01.191303 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:58:01.192155 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 23, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n        drop table if exists dbt_nyc_metrics.gold_nyctaxi_passengers_metrics", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 23, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289477733, 'CompletedOn': 1694289480245}, 'ResponseMetadata': {'RequestId': '4b29a0ae-2d11-4e1d-af84-ee4fbed10dda', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:58:01 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '965', 'connection': 'keep-alive', 'x-amzn-requestid': '4b29a0ae-2d11-4e1d-af84-ee4fbed10dda'}, 'RetryAttempts': 0}}
[0m15:58:01.192871 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:58:01.193522 [debug] [Thread-1  ]: SQL status: OK in 5.0 seconds
[0m15:58:01.205773 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:58:01.206849 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m15:58:01.207317 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"
[0m15:58:01.207786 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  
[0m15:58:01.272338 [debug] [Thread-1  ]: Glue adapter: GlueConnection _init_session called
[0m15:58:01.273216 [debug] [Thread-1  ]: Glue adapter: GlueConnection session_id : GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300
[0m15:58:03.952793 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute called
[0m15:58:03.959403 [debug] [Thread-1  ]: Glue adapter: GlueCursor remove_comments_header called
[0m15:58:03.960466 [debug] [Thread-1  ]: Glue adapter: GlueCursor add_end_space_if_single_quote called
[0m15:58:03.961388 [debug] [Thread-1  ]: Glue adapter: client : SqlWrapper2.execute('''/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */

  
    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics
  using PARQUET
	
	
	
	LOCATION 's3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/'
	
	as
	SELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger
, (avg_duration/avg_passenger_count) as avg_duration_per_passenger
, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger
, year
, month 
, type 
FROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics
  ''')
[0m15:58:07.603757 [debug] [Thread-1  ]: Glue adapter: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289484108, 'CompletedOn': 1694289486659}, 'ResponseMetadata': {'RequestId': '2a1db89d-166a-4e77-b572-36c0dafeb394', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:58:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '2a1db89d-166a-4e77-b572-36c0dafeb394'}, 'RetryAttempts': 0}}
[0m15:58:07.604912 [debug] [Thread-1  ]: Glue adapter: status = ok
[0m15:58:07.615470 [debug] [Thread-1  ]: Glue adapter: chunks: ['{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}', '{"type": "results", "rowcount": 0, "results": [], "description": []}']
[0m15:58:07.617602 [debug] [Thread-1  ]: Glue adapter: response: {'Statement': {'Id': 26, 'Code': 'SqlWrapper2.execute(\'\'\'/* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "dev", "node_id": "model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics"} */\n\n  \n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\n  using PARQUET\n\t\n\t\n\t\n\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\n\t\n\tas\n\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\n, year\n, month \n, type \nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\n  \'\'\')', 'State': 'AVAILABLE', 'Output': {'Data': {'TextPlain': '{"type": "results", "sql": "/* {\\"app\\": \\"dbt\\", \\"dbt_version\\": \\"1.6.1\\", \\"profile_name\\": \\"dbtgluenyctaxidemo\\", \\"target_name\\": \\"dev\\", \\"node_id\\": \\"model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics\\"} */\\n\\n  \\n    create table dbt_nyc_metrics.gold_nyctaxi_passengers_metrics\\n  using PARQUET\\n\\t\\n\\t\\n\\t\\n\\tLOCATION \'s3://ikoch-lakeformation-db/nyctaxi-data-out//dbt_nyc_metrics/gold_nyctaxi_passengers_metrics/\'\\n\\t\\n\\tas\\n\\tSELECT (avg_total_amount/avg_passenger_count) as avg_cost_per_passenger\\n, (avg_duration/avg_passenger_count) as avg_duration_per_passenger\\n, (avg_trip_distance/avg_passenger_count) as avg_trip_distance_per_passenger\\n, year\\n, month \\n, type \\nFROM dbt_nyc_metrics.silver_nyctaxi_avg_metrics\\n  ", "schema": null, "results": null}\n{"type": "results", "rowcount": 0, "results": [], "description": []}'}, 'ExecutionCount': 26, 'Status': 'ok'}, 'Progress': 1.0, 'StartedOn': 1694289484108, 'CompletedOn': 1694289486659}, 'ResponseMetadata': {'RequestId': '2a1db89d-166a-4e77-b572-36c0dafeb394', 'HTTPStatusCode': 200, 'HTTPHeaders': {'date': 'Sat, 09 Sep 2023 19:58:07 GMT', 'content-type': 'application/x-amz-json-1.1', 'content-length': '1870', 'connection': 'keep-alive', 'x-amzn-requestid': '2a1db89d-166a-4e77-b572-36c0dafeb394'}, 'RetryAttempts': 0}}
[0m15:58:07.618828 [debug] [Thread-1  ]: Glue adapter: GlueCursor execute successfully
[0m15:58:07.620617 [debug] [Thread-1  ]: SQL status: OK in 6.0 seconds
[0m15:58:07.695309 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics (execute): 15:57:55.535438 => 15:58:07.693419
[0m15:58:07.696343 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: ROLLBACK
[0m15:58:07.697782 [debug] [Thread-1  ]: Glue adapter: NotImplemented: rollback
[0m15:58:07.698815 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics: Close
[0m15:58:07.699657 [debug] [Thread-1  ]: Glue adapter: NotImplemented: close
[0m15:58:07.701641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acb2adaf-acd1-4f28-a3c4-cd8be24c140c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10c7be160>]}
[0m15:58:07.703618 [info ] [Thread-1  ]: 4 of 4 OK created sql table model dbt_nyc_metrics.gold_nyctaxi_passengers_metrics  [[32mOK[0m in 12.17s]
[0m15:58:07.706535 [debug] [Thread-1  ]: Finished running node model.dbtgluenyctaxidemo.gold_nyctaxi_passengers_metrics
[0m15:58:07.717800 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:07.718972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:07.720522 [debug] [MainThread]: Glue adapter: opening a new glue connection for thread : (6359, 140704535110464)
[0m15:58:07.721377 [debug] [MainThread]: Glue adapter: GlueConnection connect called
[0m15:58:07.722142 [debug] [MainThread]: Glue adapter: No session present, starting one
[0m15:58:07.722980 [debug] [MainThread]: Glue adapter: GlueConnection _start_session called
[0m15:58:08.371136 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:58:08.371769 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m15:58:08.372195 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m15:58:08.372616 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:08.373047 [debug] [MainThread]: Glue adapter: NotImplemented: rollback
[0m15:58:08.373448 [debug] [MainThread]: On master: Close
[0m15:58:08.373851 [debug] [MainThread]: Glue adapter: NotImplemented: close
[0m15:58:08.374730 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:58:08.375212 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:58:08.482629 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in READY state
[0m15:58:09.842955 [debug] [MainThread]: Glue adapter: [elapsed 1.3496668338775635s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:11.041856 [debug] [MainThread]: Glue adapter: [elapsed 2.5324208736419678s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:12.254906 [debug] [MainThread]: Glue adapter: [elapsed 3.740987777709961s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:13.492370 [debug] [MainThread]: Glue adapter: [elapsed 4.953236818313599s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:14.744917 [debug] [MainThread]: Glue adapter: [elapsed 6.221062898635864s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:15.948041 [debug] [MainThread]: Glue adapter: [elapsed 7.45173978805542s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:17.120726 [debug] [MainThread]: Glue adapter: [elapsed 8.626442909240723s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:18.315852 [debug] [MainThread]: Glue adapter: [elapsed 9.798930883407593s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:19.502085 [debug] [MainThread]: Glue adapter: [elapsed 11.00489592552185s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:20.700185 [debug] [MainThread]: Glue adapter: [elapsed 12.178294897079468s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:21.891050 [debug] [MainThread]: Glue adapter: [elapsed 13.383584976196289s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:23.087805 [debug] [MainThread]: Glue adapter: [elapsed 14.584182024002075s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:24.290706 [debug] [MainThread]: Glue adapter: [elapsed 15.786776065826416s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:25.484365 [debug] [MainThread]: Glue adapter: [elapsed 16.983311891555786s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:26.695535 [debug] [MainThread]: Glue adapter: [elapsed 18.17394185066223s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:27.899590 [debug] [MainThread]: Glue adapter: [elapsed 19.386648654937744s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:29.142123 [debug] [MainThread]: Glue adapter: [elapsed 20.586830854415894s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:30.321290 [debug] [MainThread]: Glue adapter: [elapsed 21.831621885299683s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:31.524428 [debug] [MainThread]: Glue adapter: [elapsed 23.00513195991516s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:32.729190 [debug] [MainThread]: Glue adapter: [elapsed 24.220894813537598s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:33.928653 [debug] [MainThread]: Glue adapter: [elapsed 25.422865867614746s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:35.293946 [debug] [MainThread]: Glue adapter: [elapsed 26.61790680885315s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:36.477357 [debug] [MainThread]: Glue adapter: [elapsed 27.97266387939453s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:37.695407 [debug] [MainThread]: Glue adapter: [elapsed 29.2022488117218s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:38.893555 [debug] [MainThread]: Glue adapter: [elapsed 30.390528917312622s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:40.111890 [debug] [MainThread]: Glue adapter: [elapsed 31.59062671661377s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:41.296194 [debug] [MainThread]: Glue adapter: [elapsed 32.80573391914368s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:42.480517 [debug] [MainThread]: Glue adapter: [elapsed 33.974318742752075s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:43.649853 [debug] [MainThread]: Glue adapter: [elapsed 35.14939785003662s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:44.837284 [debug] [MainThread]: Glue adapter: [elapsed 36.32094478607178s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:46.066249 [debug] [MainThread]: Glue adapter: [elapsed 37.568846702575684s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:47.261584 [debug] [MainThread]: Glue adapter: [elapsed 38.76683187484741s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-d1df88d2-02bf-4664-a1d2-c92377b3a300 in STOPPING state
[0m15:58:48.392511 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:58:48.530715 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in READY state
[0m15:58:49.875006 [debug] [MainThread]: Glue adapter: [elapsed 1.3686211109161377s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:51.076124 [debug] [MainThread]: Glue adapter: [elapsed 2.536656141281128s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:52.258495 [debug] [MainThread]: Glue adapter: [elapsed 3.751460075378418s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:53.465223 [debug] [MainThread]: Glue adapter: [elapsed 4.940053939819336s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:54.642593 [debug] [MainThread]: Glue adapter: [elapsed 6.133387088775635s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:55.873218 [debug] [MainThread]: Glue adapter: [elapsed 7.322442054748535s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:57.072014 [debug] [MainThread]: Glue adapter: [elapsed 8.553382158279419s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:58.264191 [debug] [MainThread]: Glue adapter: [elapsed 9.736939907073975s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:58:59.476315 [debug] [MainThread]: Glue adapter: [elapsed 10.940773010253906s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:00.677210 [debug] [MainThread]: Glue adapter: [elapsed 12.14652419090271s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:01.902426 [debug] [MainThread]: Glue adapter: [elapsed 13.35014009475708s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:03.114837 [debug] [MainThread]: Glue adapter: [elapsed 14.579180002212524s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:04.351867 [debug] [MainThread]: Glue adapter: [elapsed 15.79285717010498s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:05.571456 [debug] [MainThread]: Glue adapter: [elapsed 17.030620098114014s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:06.797735 [debug] [MainThread]: Glue adapter: [elapsed 18.25575304031372s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:08.010705 [debug] [MainThread]: Glue adapter: [elapsed 19.481971979141235s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:09.210179 [debug] [MainThread]: Glue adapter: [elapsed 20.692821979522705s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:10.423426 [debug] [MainThread]: Glue adapter: [elapsed 21.89308524131775s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:11.644384 [debug] [MainThread]: Glue adapter: [elapsed 23.10027527809143s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:12.849102 [debug] [MainThread]: Glue adapter: [elapsed 24.32332706451416s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:14.043944 [debug] [MainThread]: Glue adapter: [elapsed 25.518805980682373s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:15.279424 [debug] [MainThread]: Glue adapter: [elapsed 26.72768807411194s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:16.501602 [debug] [MainThread]: Glue adapter: [elapsed 27.954794883728027s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:17.726312 [debug] [MainThread]: Glue adapter: [elapsed 29.203221082687378s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:18.937334 [debug] [MainThread]: Glue adapter: [elapsed 30.400700092315674s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:20.183488 [debug] [MainThread]: Glue adapter: [elapsed 31.63065218925476s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:21.401023 [debug] [MainThread]: Glue adapter: [elapsed 32.85964322090149s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:22.620640 [debug] [MainThread]: Glue adapter: [elapsed 34.08438014984131s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:23.830016 [debug] [MainThread]: Glue adapter: [elapsed 35.29402208328247s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:25.055238 [debug] [MainThread]: Glue adapter: [elapsed 36.518877267837524s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:26.274021 [debug] [MainThread]: Glue adapter: [elapsed 37.751327991485596s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:27.502473 [debug] [MainThread]: Glue adapter: [elapsed 38.96672821044922s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPING state
[0m15:59:28.725117 [debug] [MainThread]: Glue adapter: [elapsed 40.187225103378296s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-022dc1e8-226e-4670-88bb-298cc579128e in STOPPED state
[0m15:59:29.866552 [info ] [MainThread]: 
[0m15:59:29.867758 [info ] [MainThread]: Finished running 4 table models in 0 hours 3 minutes and 3.54 seconds (183.54s).
[0m15:59:29.871265 [debug] [MainThread]: Command end result
[0m15:59:29.897852 [info ] [MainThread]: 
[0m15:59:29.899459 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:29.901601 [info ] [MainThread]: 
[0m15:59:29.902513 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:59:29.904288 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:29.904081 after 185.58 seconds
[0m15:59:29.905115 [debug] [MainThread]: Glue adapter: cleanup called
[0m15:59:29.905560 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:59:29.977483 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m15:59:30.054705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa106f900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a541cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa10a2ebc40>]}
[0m15:59:30.055572 [debug] [MainThread]: Flushing usage events
[0m16:47:10.531938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69df901c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69bd8c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a0b73e20>]}


============================== 16:47:10.537609 | 6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db ==============================
[0m16:47:10.537609 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:47:10.538597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'profile', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-taxi-demo/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir profile -t test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:10.959741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69bd8c670>]}
[0m16:47:10.982638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a1264070>]}
[0m16:47:10.984142 [info ] [MainThread]: Registered adapter: glue=1.6.2
[0m16:47:11.019697 [debug] [MainThread]: checksum: 3d5db8b971faf99e51fb77c29e14b7fe138b43cd39adbd8f7b77546f6b762907, vars: {}, profile: , target: test, version: 1.6.1
[0m16:47:11.036512 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:47:11.037275 [debug] [MainThread]: previous checksum: 3d5db8b971faf99e51fb77c29e14b7fe138b43cd39adbd8f7b77546f6b762907, current checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7
[0m16:47:11.037761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a127dac0>]}
[0m16:47:12.462690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.test.gold_metrics
- models.test.silver_metrics
[0m16:47:12.471348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a1524fd0>]}
[0m16:47:12.489262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a134a340>]}
[0m16:47:12.489898 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m16:47:12.490370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a12dba60>]}
[0m16:47:12.493920 [info ] [MainThread]: 
[0m16:47:12.496442 [debug] [MainThread]: Acquiring new glue connection 'master'
[0m16:47:12.498451 [debug] [ThreadPool]: Acquiring new glue connection 'list_dbt_nyc_metrics'
[0m16:47:12.499025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:12.499449 [debug] [ThreadPool]: Glue adapter: opening a new glue connection for thread : (6891, 123145530408960)
[0m16:47:12.499846 [debug] [ThreadPool]: Glue adapter: GlueConnection connect called
[0m16:47:12.500222 [debug] [ThreadPool]: Glue adapter: No session present, starting one
[0m16:47:12.500599 [debug] [ThreadPool]: Glue adapter: GlueConnection _start_session called
[0m16:47:13.584153 [debug] [ThreadPool]: On list_dbt_nyc_metrics: Close
[0m16:47:13.584973 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:47:13.587498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics, now list_dbt_nyc_metrics_dbt_nyc_metrics)
[0m16:47:13.588207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:13.910940 [debug] [ThreadPool]: On list_dbt_nyc_metrics_dbt_nyc_metrics: Close
[0m16:47:13.911720 [debug] [ThreadPool]: Glue adapter: NotImplemented: close
[0m16:47:13.914154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf8ac8d-ae0f-4cce-a674-e77d6f34a4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6a17ea1c0>]}
[0m16:47:13.914922 [debug] [MainThread]: Glue adapter: NotImplemented: add_begin_query
[0m16:47:13.915355 [debug] [MainThread]: Glue adapter: NotImplemented: commit
[0m16:47:13.916257 [info ] [MainThread]: Concurrency: 1 threads (target='test')
[0m16:47:13.916855 [info ] [MainThread]: 
[0m16:47:13.920072 [debug] [Thread-1  ]: Began running node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m16:47:13.920943 [info ] [Thread-1  ]: 1 of 4 START sql table model dbt_nyc_metrics.silver_nyctaxi_avg_metrics ........ [RUN]
[0m16:47:13.921927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_nyc_metrics_dbt_nyc_metrics, now model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics)
[0m16:47:13.922482 [debug] [Thread-1  ]: Began compiling node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m16:47:13.933364 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m16:47:13.934449 [debug] [Thread-1  ]: Timing info for model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics (compile): 16:47:13.923084 => 16:47:13.934128
[0m16:47:13.935029 [debug] [Thread-1  ]: Began executing node model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics
[0m16:47:13.962633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:47:14.218866 [debug] [Thread-1  ]: Glue adapter: schema : dbt_nyc_metrics
                             identifier : silver_nyctaxi_avg_metrics
                             type : table
                        
[0m16:47:14.233384 [debug] [Thread-1  ]: Glue adapter: NotImplemented: add_begin_query
[0m16:47:14.234001 [debug] [Thread-1  ]: Using glue connection "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"
[0m16:47:14.234526 [debug] [Thread-1  ]: On model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbtgluenyctaxidemo", "target_name": "test", "node_id": "model.dbtgluenyctaxidemo.silver_nyctaxi_avg_metrics"} */

        SET spark.sql.legacy.allowNonEmptyLocationInCTAS =true
      
[0m16:47:14.379815 [debug] [Thread-1  ]: Glue adapter: [elapsed 0.0s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:15.520953 [debug] [Thread-1  ]: Glue adapter: [elapsed 1.1461560726165771s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:16.670941 [debug] [Thread-1  ]: Glue adapter: [elapsed 2.291066884994507s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:17.819293 [debug] [Thread-1  ]: Glue adapter: [elapsed 3.4378461837768555s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:18.955417 [debug] [Thread-1  ]: Glue adapter: [elapsed 4.5831098556518555s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:19.900562 [debug] [MainThread]: Glue adapter: GlueConnection cancel called
[0m16:47:19.993897 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:47:19.994609 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m16:47:20.134952 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:20.176652 [debug] [Thread-1  ]: Glue adapter: [elapsed 5.760637998580933s - cursor waiting glue session state to ready for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:20.220753 [debug] [MainThread]: Glue adapter: session is not yet initialised - retrying to close
[0m16:47:20.231435 [error] [MainThread]: Encountered an error:

[0m16:47:20.254088 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 356, in execute_nodes
    self.run_queue(pool)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 269, in run_queue
    node = self.job_queue.get()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "/opt/anaconda3/lib/python3.9/queue.py", line 171, in get
    self.not_empty.wait()
  File "/opt/anaconda3/lib/python3.9/threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 430, in execute_with_hooks
    res = self.execute_nodes()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 381, in execute_nodes
    self._cancel_connections(pool)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 329, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 1109, in cancel_open_connections
    return self.connections.cancel_open()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 55, in cancel
    connection.handle.cancel()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 173, in cancel
    response = self.client.list_statements(SessionId=self.session_id)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/client.py", line 535, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/botocore/client.py", line 980, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidInputException: An error occurred (InvalidInputException) when calling the ListStatements operation: Session is not ready, session_id=GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a, status=PROVISIONING

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/requires.py", line 259, in wrapper
    return func(*args, **kwargs)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/cli/main.py", line 579, in run
    results = task.run()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 469, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/task/runnable.py", line 433, in execute_with_hooks
    adapter.cleanup_connections()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 241, in cleanup_connections
    self.connections.cleanup_all()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/connections.py", line 114, in cleanup_all
    connection.close_session()
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/dbt/adapters/glue/gluedbapi/connection.py", line 217, in close_session
    for elapsed in wait(1):
  File "/Users/chaitanyavarmamudundi/IdeaProjects/mcv_workshop/dbt-env/dbt-env/lib/python3.9/site-packages/waiter/__init__.py", line 106, in __iter__
    time.sleep(min(delay, remaining))
KeyboardInterrupt

[0m16:47:20.290624 [debug] [MainThread]: Command `dbt run` failed at 16:47:20.289572 after 9.79 seconds
[0m16:47:20.291237 [debug] [MainThread]: Glue adapter: cleanup called
[0m16:47:20.291655 [debug] [MainThread]: Glue adapter: GlueConnection close_session called
[0m16:47:20.415058 [debug] [MainThread]: Glue adapter: [elapsed 0.0s - calling stop_session for GlueInteractiveSessionRole-dbt-glue-c5a48c18-7340-4414-9e1c-ff1df5f6f04a in PROVISIONING state
[0m16:47:20.447538 [debug] [MainThread]: Flushing usage events
